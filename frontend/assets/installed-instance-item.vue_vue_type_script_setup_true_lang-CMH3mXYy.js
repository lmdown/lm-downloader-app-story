import{U as e,W as a,X as t,Y as n,d as l,Z as i,L as s,r as o,o as r,n as p,b as c,w as d,c as u,Q as m,g,t as D,m as f,i as h,M as v,a as y,G as I,z as _,I as k,J as S,F as A,$,E as w,a0 as M,V as b,T as x,a1 as C,f as U,s as L,h as N,v as R,A as V}from"./index-D8LzgPVj.js";import{d as P}from"./install-instance-BgUIOhxA.js";class F{static openAppRunningWindow(n,l){let i=t.AppRunning.replace(":id",n);i=e(i,{script:l}),window.ipcRenderer?.invoke(a.OPEN_RUNNING_WINDOW,n,i)}}class T{static getLocaleStr(){return{en:"en-US",zhHans:"zh-CN"}[n.getCurrentLocale()]||"en-US"}static format(e){if(void 0===e)return"";let a;return a="string"==typeof e?new Date(e):e,a.toLocaleString("en-US")}}const W=l({__name:"storage-simple-btn",props:{installedInstance:{}},emits:["deleted"],setup(e,{emit:a}){const t=i("showToastMessage"),{t:n}=s(),l=e,w=a,M=o(!1),b=async()=>{try{await P(l.installedInstance.id),t&&t(n("StorageDialog.DeleteFinished"),"success"),w("deleted"),M.value=!1}catch(e){const a=e;let l="Error";l=a.response?.data?.error,t&&l&&t(n(`Api.${l}`),"error")}},x=()=>{l.installedInstance.appInstallPath?$(l.installedInstance.appInstallPath):M.value=!0};return(e,a)=>(r(),p(A,null,[c(f,{variant:"flat",color:"amber-lighten-5",onClick:x},{prepend:d((()=>[l.installedInstance.appInstallPath?(r(),u(m,{key:1,icon:"mdi-folder-outline"})):(r(),u(m,{key:0,color:"error",icon:"mdi-folder-alert-outline"}))])),default:d((()=>[g(" "+D(e.$t("StorageDialog.installDir")),1)])),_:1}),c(S,{modelValue:_(M),"onUpdate:modelValue":a[1]||(a[1]=e=>k(M)?M.value=e:null),"max-width":"400"},{default:d((()=>[c(h,{"prepend-icon":"mdi-folder-alert-outline",title:e.$t("StorageDialog.MissingFiles")},{actions:d((()=>[c(v),c(f,{onClick:a[0]||(a[0]=e=>M.value=!1)},{default:d((()=>[y("p",null,D(e.$t("StorageDialog.Cancel")),1)])),_:1}),c(f,{color:"error",onClick:b},{default:d((()=>[y("p",null,D(e.$t("StorageDialog.Delete")),1)])),_:1})])),default:d((()=>[c(I,null,{default:d((()=>[y("p",null,D(e.$t("StorageDialog.FilesErrorTip")),1),y("p",null,D(e.$t("StorageDialog.FilesDeleteTip")),1)])),_:1})])),_:1},8,["title"])])),_:1},8,["modelValue"])],64))}}),z=l({__name:"installed-instance-item",props:{appNameVisible:{type:Boolean},iconVisible:{type:Boolean},appIconUrl:{},instanceData:{}},emits:["deleted","refresh"],setup(e,{emit:a}){const{t:t}=s(),n=e,l=a,i=w((()=>{const e={};if(!n.instanceData)return null;return"import"===n.instanceData.installMethod?(e.type="icon",e.value="mdi-application-import",e.installMethodStr=t("InstalledApps.Imported")):(e.type="img",e.value="./images/icons/lmd-logo.png",e.installMethodStr=t("InstalledApps.InstalledByLMD")),e})),o=()=>{console.log("gotoDetailPage",n.instanceData.appId);R.currentRoute.value.name!==V.AppDetail&&R.push({name:V.AppDetail,params:{id:n.instanceData.appId}})},p=()=>{l("deleted")};return(e,a)=>e.instanceData?(r(),u(h,{key:0,rounded:"lg",class:"common-instance-card rounded-lg mx-auto"},M({title:d((()=>[e.appNameVisible?(r(),u(U,{key:0,onClick:o},{default:d((()=>[g(D(e.instanceData.name),1)])),_:1})):L("",!0),c(N,null,{default:d((()=>[g(D(e.$t("LMAppDetail.version"))+" "+D(e.instanceData.version)+" Â  ",1),c(x,{text:e.$t("LMAppDetail.installedAt"),location:"top"},{activator:d((({props:e})=>[c(m,C({color:"secondary"},e,{icon:"mdi-clock-time-ten-outline"}),null,16)])),_:1},8,["text"]),g(" "+D(_(T).format(e.instanceData.createTime)),1)])),_:1})])),actions:d((()=>[c(v),c(W,{onDeleted:p,"installed-instance":e.instanceData},null,8,["installed-instance"]),e.instanceData.appInstallPath?L("",!0):(r(),u(f,{key:0,variant:"flat",color:"light-green-lighten-5","prepend-icon":"mdi-folder-refresh-outline",onClick:a[0]||(a[0]=e=>{l("refresh")})},{default:d((()=>[g(D(e.$t("StorageDialog.Refresh")),1)])),_:1})),c(f,{variant:"flat",color:"light-green-lighten-5","prepend-icon":"mdi-application-brackets-outline",onClick:a[1]||(a[1]=a=>{return t=e.instanceData.id,void F.openAppRunningWindow(t,"start");var t})},{default:d((()=>[g(D(e.$t("LMAppDetail.RunApp")),1)])),_:1})])),_:2},[e.iconVisible&&e.appIconUrl?{name:"prepend",fn:d((()=>[c(b,{width:"68",height:"68",cover:"",style:{"border-radius":"8px",cursor:"pointer"},onClick:o,alt:e.instanceData.name,src:e.appIconUrl},null,8,["alt","src"])])),key:"0"}:void 0,_(i)?{name:"append",fn:d((()=>[c(x,{text:_(i).installMethodStr,location:"top"},{activator:d((({props:a})=>["icon"===_(i).type?(r(),u(m,{key:0,size:"30",color:"primary",icon:_(i).value},null,8,["icon"])):(r(),u(b,C({key:1,width:"30"},a,{style:{"border-radius":"8px"},alt:e.instanceData.name,src:_(i)?.value}),null,16,["alt","src"]))])),_:1},8,["text"])])),key:"1"}:void 0]),1024)):L("",!0)}});export{F as A,z as _};
