import{U,W as L,X as T,Y as B,d as M,Z as F,L as b,r as E,o as d,n as W,b as n,w as t,c as g,Q as V,g as D,t as r,m as I,i as R,M as w,a as y,G as z,z as m,I as O,J as j,F as G,$ as H,E as Q,a0 as J,V as S,T as A,a1 as C,f as X,s as P,h as Y,v as N,A as $}from"./index.js";import{d as Z}from"./install-instance.js";class q{static openAppRunningWindow(o,l){let s=T.AppRunning.replace(":id",o);s=U(s,{script:l}),window.ipcRenderer?.invoke(L.OPEN_RUNNING_WINDOW,o,s)}}class K{static getLocaleStr(){const o=B.getCurrentLocale();return{en:"en-US",zhHans:"zh-CN"}[o]||"en-US"}static format(o){if(o===void 0)return"";let l;return typeof o=="string"?l=new Date(o):l=o,l.toLocaleString("en-US")}}const _=M({__name:"storage-simple-btn",props:{installedInstance:{}},emits:["deleted"],setup(h,{emit:o}){const l=F("showToastMessage"),{t:c}=b(),s=h,u=o,p=E(!1),k=async()=>{try{await Z(s.installedInstance.id),l&&l(c("StorageDialog.DeleteFinished"),"success"),u("deleted"),p.value=!1}catch(i){const e=i;let a="Error";a=e.response?.data?.error,l&&a&&l(c(`Api.${a}`),"error")}},v=()=>{s.installedInstance.appInstallPath?H(s.installedInstance.appInstallPath):p.value=!0};return(i,e)=>(d(),W(G,null,[n(I,{variant:"flat",color:"amber-lighten-5",onClick:v},{prepend:t(()=>[s.installedInstance.appInstallPath?(d(),g(V,{key:1,icon:"mdi-folder-outline"})):(d(),g(V,{key:0,color:"error",icon:"mdi-folder-alert-outline"}))]),default:t(()=>[D(" "+r(i.$t("StorageDialog.installDir")),1)]),_:1}),n(j,{modelValue:m(p),"onUpdate:modelValue":e[1]||(e[1]=a=>O(p)?p.value=a:null),"max-width":"400"},{default:t(()=>[n(R,{"prepend-icon":"mdi-folder-alert-outline",title:i.$t("StorageDialog.MissingFiles")},{actions:t(()=>[n(w),n(I,{onClick:e[0]||(e[0]=a=>p.value=!1)},{default:t(()=>[y("p",null,r(i.$t("StorageDialog.Cancel")),1)]),_:1}),n(I,{color:"error",onClick:k},{default:t(()=>[y("p",null,r(i.$t("StorageDialog.Delete")),1)]),_:1})]),default:t(()=>[n(z,null,{default:t(()=>[y("p",null,r(i.$t("StorageDialog.FilesErrorTip")),1),y("p",null,r(i.$t("StorageDialog.FilesDeleteTip")),1)]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])],64))}}),ae=M({__name:"installed-instance-item",props:{appNameVisible:{type:Boolean},iconVisible:{type:Boolean},appIconUrl:{},instanceData:{}},emits:["deleted","refresh"],setup(h,{emit:o}){const{t:l}=b(),c=h,s=o,u=Q(()=>{const e="./images/icons/lmd-logo.png",a={};return c.instanceData?(c.instanceData.installMethod==="import"?(a.type="icon",a.value="mdi-application-import",a.installMethodStr=l("InstalledApps.Imported")):(a.type="img",a.value=e,a.installMethodStr=l("InstalledApps.InstalledByLMD")),a):null}),p=()=>{console.log("gotoDetailPage",c.instanceData.appId),N.currentRoute.value.name!==$.AppDetail&&N.push({name:$.AppDetail,params:{id:c.instanceData.appId}})},k=e=>{q.openAppRunningWindow(e,"start")},v=()=>{s("deleted")},i=()=>{s("refresh")};return(e,a)=>e.instanceData?(d(),g(R,{key:0,rounded:"lg",class:"common-instance-card rounded-lg mx-auto"},J({title:t(()=>[e.appNameVisible?(d(),g(X,{key:0,onClick:p},{default:t(()=>[D(r(e.instanceData.name),1)]),_:1})):P("",!0),n(Y,null,{default:t(()=>[D(r(e.$t("LMAppDetail.version"))+" "+r(e.instanceData.version)+" Â  ",1),n(A,{text:e.$t("LMAppDetail.installedAt"),location:"top"},{activator:t(({props:f})=>[n(V,C({color:"secondary"},f,{icon:"mdi-clock-time-ten-outline"}),null,16)]),_:1},8,["text"]),D(" "+r(m(K).format(e.instanceData.createTime)),1)]),_:1})]),actions:t(()=>[n(w),n(_,{onDeleted:v,"installed-instance":e.instanceData},null,8,["installed-instance"]),e.instanceData.appInstallPath?P("",!0):(d(),g(I,{key:0,variant:"flat",color:"light-green-lighten-5","prepend-icon":"mdi-folder-refresh-outline",onClick:a[0]||(a[0]=f=>i())},{default:t(()=>[D(r(e.$t("StorageDialog.Refresh")),1)]),_:1})),n(I,{variant:"flat",color:"light-green-lighten-5","prepend-icon":"mdi-application-brackets-outline",onClick:a[1]||(a[1]=f=>k(e.instanceData.id))},{default:t(()=>[D(r(e.$t("LMAppDetail.RunApp")),1)]),_:1})]),_:2},[e.iconVisible&&e.appIconUrl?{name:"prepend",fn:t(()=>[n(S,{width:"68",height:"68",cover:"",style:{"border-radius":"8px",cursor:"pointer"},onClick:p,alt:e.instanceData.name,src:e.appIconUrl},null,8,["alt","src"])]),key:"0"}:void 0,m(u)?{name:"append",fn:t(()=>[n(A,{text:m(u).installMethodStr,location:"top"},{activator:t(({props:f})=>[m(u).type==="icon"?(d(),g(V,{key:0,size:"30",color:"primary",icon:m(u).value},null,8,["icon"])):(d(),g(S,C({key:1,width:"30"},f,{style:{"border-radius":"8px"},alt:e.instanceData.name,src:m(u)?.value}),null,16,["alt","src"]))]),_:1},8,["text"])]),key:"1"}:void 0]),1024)):P("",!0)}});export{q as A,ae as _};
