import{e as a,c as e,a6 as s,a3 as t,U as o,a2 as n,a8 as l,a5 as r,u as i,a4 as c,j as p,Q as u,V as d,b as m,G as v,R as f,F as g,a7 as h,aa as y}from"./vue.js";import{u as b,L as _,d as k,r as w,A as D}from"./index.js";import{a as x}from"./app-info.js";import{c as A}from"./lmd-system.js";import{A as C}from"./AppRunningUtil.js";import{d as j,b as L,t as U,q as I,r as R}from"./vuetify.js";const S=axios.create({baseURL:"https://d-1314735556.cos.ap-shanghai.myqcloud.com/up/",timeout:6e3});S.interceptors.request.use((a=>{const e=b().token;if(e&&(a.headers.Authorization=`Bearer ${e}`),a.url){const e=_.getCurrentLocale();a.url=k(a.url,{locale:e})}return a}),(a=>(console.error("Request Error:",a),Promise.reject(a)))),S.interceptors.response.use((a=>(a.data&&"string"==typeof a.data&&(a.data=JSON.parse(a.data)),a)),(a=>{if(console.error("Response Error:",a),a.response)switch(a.response.status){case 401:console.warn("Unauthorized access. Redirecting to login...");break;case 403:console.warn("Forbidden access.");break;case 404:console.warn("Resource not found.");break;case 500:console.error("Server internal error.");break;default:console.error("Unexpected error occurred.")}return Promise.reject(a)}));const z=async()=>(await S.get("uapp-data/cats.json")).data;class E{static getLocaleName(a){return _.localeIsEn()?a.name_en:a.name_zh}}const O=["Chatbox AI","Ollama","Silly Tavern","F5-TTS","KoboldCpp","LM Studio","ComfyUI"];class q{static getLocaleDesc(a){return _.localeIsEn()?a.desc_en:a.desc_zh}static checkIsDownloadable(a){return O.includes(a.name)}}const N={style:{width:"40px",height:"40px",display:"block"}},$={class:"app-title-container"},F={class:"app-title"},H={key:0,class:"app-short-desc"},T=a({__name:"single-app-item",props:{appData:{}},setup(a){const m=a,v=e((()=>q.getLocaleDesc(m.appData))),f=e((()=>q.checkIsDownloadable(m.appData))),g=async()=>{const{refLinks:a,url:e}=m.appData;let s;if(m.appData.alias)return void h();if(a){s=JSON.parse(a)[0].homepage}else e&&(s=e);const t=await A();console.log("isSupportWebview",t),t?y(s):b(s)},h=async()=>{const a=(await x(m.appData.alias)).id;w.push({name:D.AppDetail,params:{id:a}})},y=a=>{const e=Object.assign({},m.appData);e.url=a,C.openUniversalAppRunningWindow(e)},b=a=>{const e=document.createElement("a");e.href=a,e.target="_blank",document.body.appendChild(e),e.click(),document.body.removeChild(e)};return(a,e)=>(t(),s("div",{class:"app-item",onClick:o(g,["prevent"])},[i(f)?(t(),n(L,{key:0,class:"downloadable-icon",width:"36",height:"36",src:"./images/icons/downloadable.png"},{default:c((()=>[p(j,{activator:"parent",location:"top",transition:"false"},{default:c((()=>[u(d(a.$t("UniversalApps.Downloadable")),1)])),_:1})])),_:1})):l("",!0),r("div",N,[p(L,{width:"40",height:"40",src:a.appData.icon},null,8,["src"])]),r("div",$,[r("div",F,[u(d(a.appData.name)+" ",1),p(j,{"open-delay":"1200",activator:"parent",location:"top",transition:"false"},{default:c((()=>[u(d(a.appData.name),1)])),_:1})]),i(v)?(t(),s("div",H,[u(d(i(v))+" ",1),p(j,{"open-delay":"1000",activator:"parent",location:"bottom",transition:"false"},{default:c((()=>[u(d(i(v)),1)])),_:1})])):l("",!0)])]))}}),B={class:"cat-title mb-4"},J={class:"main-title"},M=["onClick"],P={style:{height:"72px","padding-left":"32px",display:"flex","align-items":"center","justify-content":"start"}},W=a({__name:"app-list-of-cat",props:{catetory:{},isAppListHomepage:{type:Boolean}},setup(a){const e=a,u=m(!1),b=m(null),_=m(null),k=m(0),x=m([]);v((()=>{const a=e.catetory;_.value=a?.subCats,_.value&&_.value.length>0?b.value=_.value[0]:b.value=e.catetory,j()})),f((()=>{C&&C.value?.disconnect()}));const A=m(null),C=m(null),j=()=>{A.value&&(C.value=new IntersectionObserver((a=>{a.forEach((a=>{a.isIntersecting&&(L(),C.value?.unobserve(a.target))}))})),C.value.observe(A.value))},L=async()=>{if(b.value&&b.value.id){u.value=!0;const a=b.value.id;x.value=await(async a=>(await S.get(`uapp-data/${a}.json`)).data)(a);let s=x.value;e.isAppListHomepage&&(s=x.value.slice(0,15)),b.value.apps=s,u.value=!1}},z=a=>E.getLocaleName(a),O=a=>{b.value=a};return(a,e)=>(t(),s("div",{class:"cat-item-container",ref_key:"catItemContainerRef",ref:A,style:{"scroll-margin-top":"80px"}},[r("div",B,[r("div",J,d(z(a.catetory)),1),i(_)?(t(),n(U,{key:0,"show-arrows":"",class:"sub-cats"},{default:c((()=>[(t(!0),s(g,null,h(i(_),((a,e)=>{return t(),s("div",{key:e+a.name_en,class:y(["sub-cats-item",(o=e,k.value===o?"active":"")]),onClick:s=>((a,e)=>{k.value=e,O(a),L()})(a,e)},d(z(a)),11,M);var o})),128))])),_:1})):l("",!0)]),p(I,{class:"app-list gap-2 mb-2"},{default:c((()=>[(t(!0),s(g,null,h(i(b)?.apps,((a,e)=>(t(),n(R,{key:a.name,cols:"12",xs:"12",sm:"6",md:"4",lg:"3",xl:"2"},{default:c((()=>[p(T,{"app-data":a},null,8,["app-data"])])),_:2},1024)))),128)),i(x).length>15&&a.isAppListHomepage?(t(),n(R,{key:0,cols:"12",xs:"12",sm:"6",md:"4",lg:"3",xl:"2"},{default:c((()=>[r("div",P,[r("a",{style:{color:"rgb(var(--v-theme-primary))"},href:"#",onClick:e[0]||(e[0]=o((a=>(()=>{if(b.value?.id){const{name_en:a,name_zh:e}=b.value;w.push({name:D.UniversalAppCat,params:{id:b.value?.id,name_en:a,name_zh:e}})}})()),["prevent"]))},d(a.$t("UniversalApps.MoreApps"))+" > ",1)])])),_:1})):l("",!0)])),_:1})],512))}});export{E as C,W as _,z as g};
