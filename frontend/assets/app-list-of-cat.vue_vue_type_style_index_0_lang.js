import{e as a,c as e,a6 as s,a3 as t,U as o,a2 as n,a8 as l,a5 as r,u as i,a4 as c,j as p,Q as u,V as d,b as m,G as v,R as f,F as g,a7 as h,aa as y}from"./vue.js";import{u as b,L as w,d as _,r as k,A as D}from"./index.js";import{a as A}from"./app-info.js";import{c as x,a as j}from"./lmd-system.js";import{A as C}from"./AppRunningUtil.js";import{d as L,b as U,t as I,q as R,r as S}from"./vuetify.js";const z=axios.create({baseURL:"https://d-1314735556.cos.ap-shanghai.myqcloud.com/up/",timeout:6e3});z.interceptors.request.use((a=>{const e=b().token;if(e&&(a.headers.Authorization=`Bearer ${e}`),a.url){const e=w.getCurrentLocale();a.url=_(a.url,{locale:e})}return a}),(a=>(console.error("Request Error:",a),Promise.reject(a)))),z.interceptors.response.use((a=>(a.data&&"string"==typeof a.data&&(a.data=JSON.parse(a.data)),a)),(a=>{if(console.error("Response Error:",a),a.response)switch(a.response.status){case 401:console.warn("Unauthorized access. Redirecting to login...");break;case 403:console.warn("Forbidden access.");break;case 404:console.warn("Resource not found.");break;case 500:console.error("Server internal error.");break;default:console.error("Unexpected error occurred.")}return Promise.reject(a)}));const E=async()=>(await z.get("uapp-data/cats.json")).data;class O{static getLocaleName(a){return w.localeIsEn()?a.name_en:a.name_zh}}const q=["Chatbox AI","Ollama","Silly Tavern","F5-TTS","KoboldCpp","LM Studio","ComfyUI"];class N{static getLocaleDesc(a){return w.localeIsEn()?a.desc_en:a.desc_zh}static checkIsDownloadable(a){return q.includes(a.name)}}const W={style:{width:"40px",height:"40px",display:"block"}},$={class:"app-title-container"},F={class:"app-title"},H={key:0,class:"app-short-desc"},T=a({__name:"single-app-item",props:{appData:{}},setup(a){const m=a,v=e((()=>N.getLocaleDesc(m.appData))),f=e((()=>N.checkIsDownloadable(m.appData))),g=async()=>{const{refLinks:a,url:e}=m.appData;let s;if(m.appData.alias)return void h();if(a){s=JSON.parse(a)[0].homepage}else e&&(s=e);const t=await x(),o=await j();console.log("isSupportWebview",t),console.log("isSupportUAppWin",t),o?b(s):t?y(s):w(s)},h=async()=>{const a=(await A(m.appData.alias)).id;k.push({name:D.AppDetail,params:{id:a}})},y=a=>{const e=Object.assign({},m.appData);e.url=a,C.openUniversalAppWebview(e)},b=a=>{const e=Object.assign({},m.appData);e.url=a,C.openUAppLiteWindow(e)},w=a=>{const e=document.createElement("a");e.href=a,e.target="_blank",document.body.appendChild(e),e.click(),document.body.removeChild(e)};return(a,e)=>(t(),s("div",{class:"app-item",onClick:o(g,["prevent"])},[i(f)?(t(),n(U,{key:0,class:"downloadable-icon",width:"36",height:"36",src:"./images/icons/downloadable.png"},{default:c((()=>[p(L,{activator:"parent",location:"top",transition:"false"},{default:c((()=>[u(d(a.$t("UniversalApps.Downloadable")),1)])),_:1})])),_:1})):l("",!0),r("div",W,[p(U,{width:"40",height:"40",src:a.appData.icon},null,8,["src"])]),r("div",$,[r("div",F,[u(d(a.appData.name)+" ",1),p(L,{"open-delay":"1200",activator:"parent",location:"top",transition:"false"},{default:c((()=>[u(d(a.appData.name),1)])),_:1})]),i(v)?(t(),s("div",H,[u(d(i(v))+" ",1),p(L,{"open-delay":"1000",activator:"parent",location:"bottom",transition:"false"},{default:c((()=>[u(d(i(v)),1)])),_:1})])):l("",!0)])]))}}),B={class:"cat-title mb-4"},J={class:"main-title"},M=["onClick"],P={style:{height:"72px","padding-left":"32px",display:"flex","align-items":"center","justify-content":"start"}},G=a({__name:"app-list-of-cat",props:{catetory:{},isAppListHomepage:{type:Boolean}},setup(a){const e=a,u=m(!1),b=m(null),w=m(null),_=m(0),A=m([]);v((()=>{const a=e.catetory;w.value=a?.subCats,w.value&&w.value.length>0?b.value=w.value[0]:b.value=e.catetory,C()})),f((()=>{j&&j.value?.disconnect()}));const x=m(null),j=m(null),C=()=>{x.value&&(j.value=new IntersectionObserver((a=>{a.forEach((a=>{a.isIntersecting&&(L(),j.value?.unobserve(a.target))}))})),j.value.observe(x.value))},L=async()=>{if(b.value&&b.value.id){u.value=!0;const a=b.value.id;A.value=await(async a=>(await z.get(`uapp-data/${a}.json`)).data)(a);let s=A.value;e.isAppListHomepage&&(s=A.value.slice(0,15)),b.value.apps=s,u.value=!1}},U=a=>O.getLocaleName(a),E=a=>{b.value=a};return(a,e)=>(t(),s("div",{class:"cat-item-container",ref_key:"catItemContainerRef",ref:x,style:{"scroll-margin-top":"80px"}},[r("div",B,[r("div",J,d(U(a.catetory)),1),i(w)?(t(),n(I,{key:0,"show-arrows":"",class:"sub-cats"},{default:c((()=>[(t(!0),s(g,null,h(i(w),((a,e)=>{return t(),s("div",{key:e+a.name_en,class:y(["sub-cats-item",(o=e,_.value===o?"active":"")]),onClick:s=>((a,e)=>{_.value=e,E(a),L()})(a,e)},d(U(a)),11,M);var o})),128))])),_:1})):l("",!0)]),p(R,{class:"app-list gap-2 mb-2"},{default:c((()=>[(t(!0),s(g,null,h(i(b)?.apps,((a,e)=>(t(),n(S,{key:a.name,cols:"12",xs:"12",sm:"6",md:"4",lg:"3",xl:"2"},{default:c((()=>[p(T,{"app-data":a},null,8,["app-data"])])),_:2},1024)))),128)),i(A).length>15&&a.isAppListHomepage?(t(),n(S,{key:0,cols:"12",xs:"12",sm:"6",md:"4",lg:"3",xl:"2"},{default:c((()=>[r("div",P,[r("a",{style:{color:"rgb(var(--v-theme-primary))"},href:"#",onClick:e[0]||(e[0]=o((a=>(()=>{if(b.value?.id){const{name_en:a,name_zh:e}=b.value;k.push({name:D.UniversalAppCat,params:{id:b.value?.id,name_en:a,name_zh:e}})}})()),["prevent"]))},d(a.$t("UniversalApps.MoreApps"))+" > ",1)])])),_:1})):l("",!0)])),_:1})],512))}});export{O as C,G as _,E as g};
