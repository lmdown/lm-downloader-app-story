import{e as a,c as e,a6 as s,a3 as t,U as l,a2 as o,a8 as n,a5 as r,u as c,a4 as i,j as p,Q as u,V as d,b as m,G as v,R as f,F as h,a7 as g,aa as y}from"./vue.js";import{u as b,L as _,c as k,r as w,A as x}from"./index.js";import{a as D}from"./app-info.js";import{d as C,b as L,t as A,q as j,r as I}from"./vuetify.js";const U=axios.create({baseURL:"https://d-1314735556.cos.ap-shanghai.myqcloud.com/up/",timeout:6e3});U.interceptors.request.use((a=>{const e=b().token;if(e&&(a.headers.Authorization=`Bearer ${e}`),a.url){const e=_.getCurrentLocale();a.url=k(a.url,{locale:e})}return a}),(a=>(console.error("Request Error:",a),Promise.reject(a)))),U.interceptors.response.use((a=>(a.data&&"string"==typeof a.data&&(a.data=JSON.parse(a.data)),a)),(a=>{if(console.error("Response Error:",a),a.response)switch(a.response.status){case 401:console.warn("Unauthorized access. Redirecting to login...");break;case 403:console.warn("Forbidden access.");break;case 404:console.warn("Resource not found.");break;case 500:console.error("Server internal error.");break;default:console.error("Unexpected error occurred.")}return Promise.reject(a)}));const R=async()=>(await U.get("uapp-data/cats.json")).data;class z{static getLocaleName(a){return _.localeIsEn()?a.name_en:a.name_zh}}const E=["Chatbox AI","Ollama","Silly Tavern","F5-TTS","KoboldCpp","LM Studio","ComfyUI"];class S{static getLocaleDesc(a){return _.localeIsEn()?a.desc_en:a.desc_zh}static checkIsDownloadable(a){return E.includes(a.name)}}const q={style:{width:"40px",height:"40px",display:"block"}},N={class:"app-title-container"},O={class:"app-title"},$={key:0,class:"app-short-desc"},F=a({__name:"single-app-item",props:{appData:{}},setup(a){const m=a,v=e((()=>S.getLocaleDesc(m.appData))),f=e((()=>S.checkIsDownloadable(m.appData))),h=()=>{const{refLinks:a,url:e}=m.appData;let s;if(m.appData.alias)g();else if(a){s=JSON.parse(a)[0].homepage}else e&&(s=e);y(s)},g=async()=>{const a=(await D(m.appData.alias)).id;w.push({name:x.AppDetail,params:{id:a}})},y=a=>{const e=document.createElement("a");e.href=a,e.target="_blank",document.body.appendChild(e),e.click(),document.body.removeChild(e)};return(a,e)=>(t(),s("div",{class:"app-item",onClick:l(h,["prevent"])},[c(f)?(t(),o(L,{key:0,class:"downloadable-icon",width:"36",height:"36",src:"./images/icons/downloadable.png"},{default:i((()=>[p(C,{activator:"parent",location:"top",transition:"false"},{default:i((()=>[u(d(a.$t("UniversalApps.Downloadable")),1)])),_:1})])),_:1})):n("",!0),r("div",q,[p(L,{width:"40",height:"40",src:a.appData.icon},null,8,["src"])]),r("div",N,[r("div",O,[u(d(a.appData.name)+" ",1),p(C,{"open-delay":"1200",activator:"parent",location:"top",transition:"false"},{default:i((()=>[u(d(a.appData.name),1)])),_:1})]),c(v)?(t(),s("div",$,[u(d(c(v))+" ",1),p(C,{"open-delay":"1000",activator:"parent",location:"bottom",transition:"false"},{default:i((()=>[u(d(c(v)),1)])),_:1})])):n("",!0)])]))}}),H={class:"cat-title mb-4"},T={class:"main-title"},B=["onClick"],J={style:{height:"72px","padding-left":"32px",display:"flex","align-items":"center","justify-content":"start"}},M=a({__name:"app-list-of-cat",props:{catetory:{},isAppListHomepage:{type:Boolean}},setup(a){const e=a,u=m(!1),b=m(null),_=m(null),k=m(0),D=m([]);v((()=>{const a=e.catetory;_.value=a?.subCats,_.value&&_.value.length>0?b.value=_.value[0]:b.value=e.catetory,R()})),f((()=>{L&&L.value?.disconnect()}));const C=m(null),L=m(null),R=()=>{C.value&&(L.value=new IntersectionObserver((a=>{a.forEach((a=>{a.isIntersecting&&(E(),L.value?.unobserve(a.target))}))})),L.value.observe(C.value))},E=async()=>{if(b.value&&b.value.id){u.value=!0;const a=b.value.id;D.value=await(async a=>(await U.get(`uapp-data/${a}.json`)).data)(a);let s=D.value;e.isAppListHomepage&&(s=D.value.slice(0,15)),b.value.apps=s,u.value=!1}},S=a=>z.getLocaleName(a),q=a=>{b.value=a};return(a,e)=>(t(),s("div",{class:"cat-item-container",ref_key:"catItemContainerRef",ref:C,style:{"scroll-margin-top":"80px"}},[r("div",H,[r("div",T,d(S(a.catetory)),1),c(_)?(t(),o(A,{key:0,"show-arrows":"",class:"sub-cats"},{default:i((()=>[(t(!0),s(h,null,g(c(_),((a,e)=>{return t(),s("div",{key:e+a.name_en,class:y(["sub-cats-item",(l=e,k.value===l?"active":"")]),onClick:s=>((a,e)=>{k.value=e,q(a),E()})(a,e)},d(S(a)),11,B);var l})),128))])),_:1})):n("",!0)]),p(j,{class:"app-list gap-2 mb-2"},{default:i((()=>[(t(!0),s(h,null,g(c(b)?.apps,((a,e)=>(t(),o(I,{key:a.name,cols:"12",xs:"12",sm:"6",md:"4",lg:"3",xl:"2"},{default:i((()=>[p(F,{"app-data":a},null,8,["app-data"])])),_:2},1024)))),128)),c(D).length>15&&a.isAppListHomepage?(t(),o(I,{key:0,cols:"12",xs:"12",sm:"6",md:"4",lg:"3",xl:"2"},{default:i((()=>[r("div",J,[r("a",{style:{color:"rgb(var(--v-theme-primary))"},href:"#",onClick:e[0]||(e[0]=l((a=>(()=>{if(b.value?.id){const{name_en:a,name_zh:e}=b.value;w.push({name:x.UniversalAppCat,params:{id:b.value?.id,name_en:a,name_zh:e}})}})()),["prevent"]))},d(a.$t("UniversalApps.MoreApps"))+" > ",1)])])),_:1})):n("",!0)])),_:1})],512))}});export{z as C,M as _,R as g};
