function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var t,s={exports:{}};function r(){return t?s.exports:(t=1,self,s.exports=(e=r={},Object.defineProperty(e,"__esModule",{value:!0}),e.FitAddon=void 0,e.FitAddon=class{activate(e){this._terminal=e}dispose(){}fit(){const e=this.proposeDimensions();if(!e||!this._terminal||isNaN(e.cols)||isNaN(e.rows))return;const t=this._terminal._core;this._terminal.rows===e.rows&&this._terminal.cols===e.cols||(t._renderService.clear(),this._terminal.resize(e.cols,e.rows))}proposeDimensions(){if(!this._terminal)return;if(!this._terminal.element||!this._terminal.element.parentElement)return;const e=this._terminal._core,t=e._renderService.dimensions;if(0===t.css.cell.width||0===t.css.cell.height)return;const s=0===this._terminal.options.scrollback?0:e.viewport.scrollBarWidth,r=window.getComputedStyle(this._terminal.element.parentElement),o=parseInt(r.getPropertyValue("height")),i=Math.max(0,parseInt(r.getPropertyValue("width"))),n=window.getComputedStyle(this._terminal.element),a=o-(parseInt(n.getPropertyValue("padding-top"))+parseInt(n.getPropertyValue("padding-bottom"))),c=i-(parseInt(n.getPropertyValue("padding-right"))+parseInt(n.getPropertyValue("padding-left")))-s;return{cols:Math.max(2,Math.floor(c/t.css.cell.width)),rows:Math.max(1,Math.floor(a/t.css.cell.height))}}},r));var e,r}var o,i={exports:{}};function n(){return o?i.exports:(o=1,self,i.exports=(e={},(()=>{var t=e;function s(e,t,s){return e.addEventListener(t,s),{dispose:()=>{s&&e.removeEventListener(t,s)}}}Object.defineProperty(t,"__esModule",{value:!0}),t.AttachAddon=void 0,t.AttachAddon=class{constructor(e,t){this._disposables=[],this._socket=e,this._socket.binaryType="arraybuffer",this._bidirectional=!(t&&!1===t.bidirectional)}activate(e){this._disposables.push(s(this._socket,"message",(t=>{const s=t.data;e.write("string"==typeof s?s:new Uint8Array(s))}))),this._bidirectional&&(this._disposables.push(e.onData((e=>this._sendData(e)))),this._disposables.push(e.onBinary((e=>this._sendBinary(e))))),this._disposables.push(s(this._socket,"close",(()=>this.dispose()))),this._disposables.push(s(this._socket,"error",(()=>this.dispose())))}dispose(){for(const e of this._disposables)e.dispose()}_sendData(e){this._checkOpenSocket()&&this._socket.send(e)}_sendBinary(e){if(!this._checkOpenSocket())return;const t=new Uint8Array(e.length);for(let s=0;s<e.length;++s)t[s]=255&e.charCodeAt(s);this._socket.send(t)}_checkOpenSocket(){switch(this._socket.readyState){case WebSocket.OPEN:return!0;case WebSocket.CONNECTING:throw new Error("Attach addon was loaded before socket was open");case WebSocket.CLOSING:return console.warn("Attach addon socket is closing"),!1;case WebSocket.CLOSED:throw new Error("Attach addon socket is closed");default:throw new Error("Unexpected socket state")}}}})(),e));var e}var a,c={exports:{}};function l(){return a?c.exports:(a=1,self,c.exports=(()=>{var e={6:(e,t)=>{function s(e){try{const t=new URL(e),s=t.password&&t.username?`${t.protocol}//${t.username}:${t.password}@${t.host}`:t.username?`${t.protocol}//${t.username}@${t.host}`:`${t.protocol}//${t.host}`;return e.toLocaleLowerCase().startsWith(s.toLocaleLowerCase())}catch(t){return!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.LinkComputer=t.WebLinkProvider=void 0,t.WebLinkProvider=class{constructor(e,t,s,r={}){this._terminal=e,this._regex=t,this._handler=s,this._options=r}provideLinks(e,t){const s=r.computeLink(e,this._regex,this._terminal,this._handler);t(this._addCallbacks(s))}_addCallbacks(e){return e.map((e=>(e.leave=this._options.leave,e.hover=(t,s)=>{if(this._options.hover){const{range:r}=e;this._options.hover(t,s,r)}},e)))}};class r{static computeLink(e,t,o,i){const n=new RegExp(t.source,(t.flags||"")+"g"),[a,c]=r._getWindowedLineStrings(e-1,o),l=a.join("");let d;const h=[];for(;d=n.exec(l);){const e=d[0];if(!s(e))continue;const[t,n]=r._mapStrIdx(o,c,0,d.index),[a,l]=r._mapStrIdx(o,t,n,e.length);if(-1===t||-1===n||-1===a||-1===l)continue;const p={start:{x:n+1,y:t+1},end:{x:l,y:a+1}};h.push({range:p,text:e,activate:i})}return h}static _getWindowedLineStrings(e,t){let s,r=e,o=e,i=0,n="";const a=[];if(s=t.buffer.active.getLine(e)){const e=s.translateToString(!0);if(s.isWrapped&&" "!==e[0]){for(i=0;(s=t.buffer.active.getLine(--r))&&i<2048&&(n=s.translateToString(!0),i+=n.length,a.push(n),s.isWrapped&&-1===n.indexOf(" ")););a.reverse()}for(a.push(e),i=0;(s=t.buffer.active.getLine(++o))&&s.isWrapped&&i<2048&&(n=s.translateToString(!0),i+=n.length,a.push(n),-1===n.indexOf(" ")););}return[a,r]}static _mapStrIdx(e,t,s,r){const o=e.buffer.active,i=o.getNullCell();let n=s;for(;r;){const e=o.getLine(t);if(!e)return[-1,-1];for(let s=n;s<e.length;++s){e.getCell(s,i);const n=i.getChars();if(i.getWidth()&&(r-=n.length||1,s===e.length-1&&""===n)){const e=o.getLine(t+1);e&&e.isWrapped&&(e.getCell(0,i),2===i.getWidth()&&(r+=1))}if(r<0)return[t,s]}t++,n=0}return[t,n]}}t.LinkComputer=r}},t={};function s(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,s),i.exports}var r={};return(()=>{var e=r;Object.defineProperty(e,"__esModule",{value:!0}),e.WebLinksAddon=void 0;const t=s(6),o=/(https?|HTTPS?):[/]{2}[^\s"'!*(){}|\\\^<>`]*[^\s"':,.!?{}|\\\^~\[\]`()<>]/;function i(e,t){const s=window.open();if(s){try{s.opener=null}catch{}s.location.href=t}else console.warn("Opening link blocked as opener could not be cleared")}e.WebLinksAddon=class{constructor(e=i,t={}){this._handler=e,this._options=t}activate(e){this._terminal=e;const s=this._options,r=s.urlRegex||o;this._linkProvider=this._terminal.registerLinkProvider(new t.WebLinkProvider(this._terminal,r,this._handler,s))}dispose(){this._linkProvider?.dispose()}}})(),r})())}export{n as a,l as b,e as g,r};
