import{C as e,k as a,d as l,r as t,l as s,D as n,E as p,o as i,n as o,b as r,w as c,x as m,f as u,g as d,t as f,G as A,F as D,p as _,s as y,z as g,y as v,a as h,c as x,H as k,i as L,m as I,I as w,J as M,K as F,_ as b,L as T,B as $,M as j,N as C,O,P as R,j as z,Q as S,V as H}from"./index-BuM7Vul5.js";import"./index-CX5Ot8TN.js";import{c as V}from"./install-instance-BXHQ-I8j.js";import{A as B}from"./AppScriptType-tEOJIb0R.js";import{A as N,_ as P}from"./installed-instance-item.vue_vue_type_script_setup_true_lang-CqpXYZml.js";import{u as G}from"./lmapp-BnuOWh9y.js";import{_ as E}from"./top-right-controls.vue_vue_type_style_index_0_lang-CGCtm50i.js";import"./IPCChannelName-ChmutG-C.js";const J=e("installedInstance",{state:()=>({instancesForApp:[],instanceForRunning:{}}),actions:{async getInstalledInstanceForApp(e){try{const l=await a.get(`/self-manage/installed-instance/app/${e}`);this.instancesForApp=l.data}catch(l){console.error("Failed to fetch app:",l)}},async getInstalledInstanceForRunning(e){try{const l=await a.get(`/self-manage/installed-instance/${e}`);this.instanceForRunning=l.data}catch(l){console.error("Failed to fetch app:",l)}}}}),K={key:0,class:"d-flex justify-end ga-3"},Q={key:1,class:"d-flex justify-end ga-3"},U={class:"fullDescBlock overflow-y-hidden"},W=["innerHTML"],q=["innerHTML"],X=b(l({__name:"basic-info-and-tags",props:{lmAppData:{}},setup(e){const a=e,l=t(null),b=t(!1),T=t(!1);let $;s((()=>{$=new ResizeObserver((e=>{for(let a of e)a.target===l.value&&(b.value=a.contentRect.height>=200)})),l.value&&$.observe(l.value),l.value&&(b.value=l.value.scrollHeight>=200)})),n((()=>{$&&$.unobserve(l.value)}));const j=p((()=>{if(!a.lmAppData.installLimit)return[];return[...a.lmAppData.installLimit.os,...a.lmAppData.installLimit.hardware]}));return(e,a)=>(i(),o(D,null,[r(v,null,{default:c((()=>[r(m,{cols:"12",md:"6",sm:"6"},{default:c((()=>[r(u,null,{default:c((()=>[d(f(e.lmAppData.name),1)])),_:1}),r(A,null,{default:c((()=>[d(f(e.lmAppData.shortDesc),1)])),_:1})])),_:1}),r(m,{cols:"12",md:"6",sm:"6",class:"d-flex flex-column ga-2 pt-4"},{default:c((()=>[e.lmAppData.tags?(i(),o("div",K,[(i(!0),o(D,null,_(e.lmAppData.tags,((e,a)=>(i(),x(F,{variant:"tonal",size:"x-small",key:a},{default:c((()=>[d(f(e),1)])),_:2},1024)))),128))])):y("",!0),e.lmAppData.tags?(i(),o("div",Q,[(i(!0),o(D,null,_(g(j),((e,a)=>(i(),x(F,{variant:"tonal",size:"x-small",key:a},{default:c((()=>[d(f(e?.trim()),1)])),_:2},1024)))),128))])):y("",!0)])),_:1})])),_:1}),r(v,null,{default:c((()=>[h("div",U,[h("p",{ref_key:"visibleText",ref:l,innerHTML:e.lmAppData.desc},null,8,W)]),g(b)?(i(),x(k,{key:0,active:!0,class:"me-4",onClick:a[0]||(a[0]=e=>T.value=!0),"prepend-icon":"mdi-unfold-more-horizontal",location:"bottom right",extended:"",absolute:"",offset:"",text:"More"})):y("",!0)])),_:1}),r(M,{modelValue:g(T),"onUpdate:modelValue":a[2]||(a[2]=e=>w(T)?T.value=e:null),width:"auto"},{default:c((()=>[r(L,{"prepend-icon":"mdi-text-box-outline",title:e.lmAppData.name},{actions:c((()=>[r(I,{class:"ms-auto",text:"Ok",onClick:a[1]||(a[1]=e=>T.value=!1)})])),default:c((()=>[r(A,{class:"mx-6 my-2"},{default:c((()=>[h("p",{innerHTML:e.lmAppData.desc},null,8,q)])),_:1})])),_:1},8,["title"])])),_:1},8,["modelValue"])],64))}}),[["__scopeId","data-v-a2dcc400"]]),Y={class:"text-medium-emphasis mr-2"},Z=["href"],ee={key:1},ae={class:"text-medium-emphasis mr-2"},le={key:2},te={class:"text-medium-emphasis mr-2"},se={key:3},ne={class:"text-medium-emphasis mr-2"},pe={key:4},ie={class:"text-medium-emphasis mr-2"},oe={key:5},re={class:"text-medium-emphasis mr-2"},ce={key:6},me={class:"text-medium-emphasis mr-2"},ue={key:7},de={class:"text-medium-emphasis mr-2"},fe=l({__name:"extra-info",props:{lmAppData:{}},setup(e){const{t:a}=T(),l=e=>{let l=a("LMAppDetail.refLinkOther");return"homepage"===e.type?l=a("LMAppDetail.refLinkHomePage"):"github"===e.type&&(l=a("LMAppDetail.refLinkGithub")),l};return(e,a)=>(i(),x($,{class:"mx-10"},{default:c((()=>[r(v,null,{default:c((()=>[r(m,null,{default:c((()=>[e.lmAppData.refLinks&&e.lmAppData.refLinks.length>0?(i(!0),o(D,{key:0},_(e.lmAppData.refLinks,((e,a)=>(i(),o("p",{key:a},[h("span",Y,f(l(e)),1),h("a",{href:e.url,target:"_blank"},f(e.url),9,Z)])))),128)):y("",!0),e.lmAppData?.newVersion?(i(),o("p",ee,[h("span",ae,f(e.$t("LMAppDetail.newVersion")),1),d(" "+f(e.lmAppData.newVersion),1)])):y("",!0),e.lmAppData?.releaseTime?(i(),o("p",le,[h("span",te,f(e.$t("LMAppDetail.releaseTime")),1),d(" "+f(e.lmAppData.releaseTime),1)])):y("",!0),e.lmAppData?.licenseInfo?.licenseType?(i(),o("p",se,[h("span",ne,f(e.$t("LMAppDetail.licenseType")),1),d(" "+f(e.lmAppData?.licenseInfo?.licenseType),1)])):y("",!0),e.lmAppData?.licenseInfo?.isOpenSource?(i(),o("p",pe,[h("span",ie,f(e.$t("LMAppDetail.isOpenSource")),1),d(" "+f(e.lmAppData?.licenseInfo?.isOpenSource),1)])):y("",!0),e.lmAppData?.licenseInfo?.isFullOpenSource?(i(),o("p",oe,[h("span",re,f(e.$t("LMAppDetail.isFullOpenSource")),1),d(" "+f(e.lmAppData?.licenseInfo?.isFullOpenSource),1)])):y("",!0),e.lmAppData?.licenseInfo?.isFree?(i(),o("p",ce,[h("span",me,f(e.$t("LMAppDetail.isFree")),1),d(" "+f(e.lmAppData?.licenseInfo?.isFree),1)])):y("",!0),e.lmAppData?.licenseInfo?.sourceCodeRepo?(i(),o("p",ue,[h("span",de,f(e.$t("LMAppDetail.sourceCodeRepo")),1),d(" "+f(e.lmAppData?.licenseInfo?.sourceCodeRepo),1)])):y("",!0)])),_:1})])),_:1})])),_:1}))}}),Ae=l({__name:"installed-info-list",props:{lmAppData:{}},setup(e){const a=J(),l=t(),n=e;s((async()=>{p()}));const p=async()=>{await a.getInstalledInstanceForApp(n.lmAppData?.id),l.value=a.instancesForApp},A=async()=>{try{if(await V(n.lmAppData),await p(),l.value){const e=l.value[0];if(e){const a=e.id;N.openAppRunningWindow(a,B.INSTALL)}else console.error("data err firstInstallInstance",e)}}catch(e){console.error("install app err ",e)}},y=async()=>{p()};return(e,a)=>g(l)&&g(l).length>0?(i(),x($,{key:0,class:"mx-10 d-flex flex-column ga-2",style:{width:"100%"}},{default:c((()=>[r(v,null,{default:c((()=>[(i(!0),o(D,null,_(g(l),((e,a)=>(i(),x(m,{key:a,cols:"6"},{default:c((()=>[r(P,{"instance-data":e,onDeleted:y,"app-name-visible":!0,"icon-visible":!1},null,8,["instance-data"])])),_:2},1024)))),128))])),_:1})])),_:1})):(i(),x($,{key:1,class:"mx-10 d-flex flex-column ga-2"},{default:c((()=>[r(v,null,{default:c((()=>[r(m,{cols:"6"},{default:c((()=>[r(L,{class:"common-instance-card rounded-lg"},{actions:c((()=>[r(j),r(I,{color:"primary",variant:"outlined",onClick:A},{default:c((()=>[d(f(e.$t("LMAppDetail.install")),1)])),_:1})])),default:c((()=>[r(u,null,{default:c((()=>[d(f(e.$t("LMAppDetail.notInstalled")),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}))}}),De={style:{"font-size":"20px"}},_e=l({__name:"AppDetail",setup(e){const a=C(),l=G(),n=t({}),p=O();R((()=>a.params.id),((e,a)=>{console.log("app detail ",e,a)})),s((async()=>{const e=a.params.id;await l.fetchApp(e),n.value=l.currentLmApp}));const u=()=>{p.go(-1)};return(e,a)=>(i(),o(D,null,[r(z,{elevation:"0",class:"window-drag pt-4"},{prepend:c((()=>[r(I,{class:"window-no-drag",onClick:u,variant:"plain"},{default:c((()=>[r(S,{class:"lmd-back-icon mr-3",style:{"font-size":"1.4rem"},size:"36",icon:"mdi-chevron-left",color:"#FB6C00"}),h("span",De,f(e.$t("LMAppDetail.goBack")),1)])),_:1})])),append:c((()=>[r(E)])),_:1}),r($,{class:"mt-4"},{default:c((()=>[r(v,null,{default:c((()=>[r(m,{cols:"12",lg:"1",md:"2",sm:"3"},{default:c((()=>[r(H,{src:g(n).icon,cover:"",style:{"border-radius":"8px"}},null,8,["src"])])),_:1}),r(m,{cols:"12",lg:"11",md:"10",sm:"9"},{default:c((()=>[r(X,{lmAppData:g(n)},null,8,["lmAppData"])])),_:1})])),_:1}),r(v,null,{default:c((()=>[g(n).id?(i(),x(Ae,{key:0,lmAppData:g(n)},null,8,["lmAppData"])):y("",!0),r(fe,{lmAppData:g(n)},null,8,["lmAppData"])])),_:1})])),_:1})],64))}});export{_e as default};
