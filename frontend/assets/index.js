const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./UniversalAppHome.js","./app-list-of-cat.vue_vue_type_style_index_0_lang.js","./vue.js","./app-info.js","./lmd-system.js","./AppRunningUtil.js","./AppScriptType.js","./vuetify.js","./app-list-of-cat.css","./top-app-bar.vue_vue_type_style_index_0_lang.js","./top-right-controls.vue_vue_type_style_index_0_lang.js","./vuei18n.js","./common-util.js","./top-right-controls.css","./top-app-bar.css","./pinia.js","./lmd-locales.js","./UniversalAppHome.css","./Home.js","./index2.js","./app-list.vue_vue_type_style_index_0_lang.js","./app-list.css","./lmapp.js","./Home.css","./AppDetail.js","./vue-easy-lightbox.js","./install-instance.js","./single-installed-instance.vue_vue_type_style_index_0_lang.js","./xterm.js","./dayjs.js","./single-installed-instance.css","./AppDetail.css","./StoryPostDetail.js","./StoryPostDetail.css","./InstalledApps.js","./MyResource.js","./AppRunningWindow.js","./debounce.js","./pretty-bytes.js","./AppRunningWindow.css","./UniversalAppCat.js","./UniversalAppCat.css","./UniversalAppRunningWindow.js"])))=>i.map(i=>d[i]);
import{a0 as e,a1 as t,e as a,b as n,G as r,a2 as o,a3 as s,a4 as i,a5 as l,j as c,a6 as p,a7 as u,V as d,u as m,F as g,k as _,Q as f,x as h,a8 as A,Y as v,c as w,J as y,p as E,a9 as S}from"./vue.js";import{V as R,a as L,b as I,c as b,d as O,e as N,f as D,g as C,h as T,v as k,i as P,j as U,k as F,l as M,m as V}from"./vuetify.js";import{d as G,c as x}from"./pinia.js";import{c as j,u as B}from"./vuei18n.js";import{z as H,e as q}from"./lmd-locales.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const $={Home:"/",FastDownload:"/fast-download",UniversalAppCat:"/universal-app-cat/:id/:name_en/:name_zh",UniversalAppRunning:"/universal-app-running/:name/:icon/:url",InstalledApps:"/installed",AppRunning:"/app/running/:id",StoryPostDetail:"/app/story-post/:id",MyResource:"/my-resources"},W={Home:"home",FastDownload:"fast-download",UniversalAppCat:"universal-app-cat",UniversalAppRunning:"universal-app-running",AppDetail:"app-detail",InstalledApps:"installed-apps",AppRunning:"app-running",StoryPostDetail:"story-post-detail",MyResource:"my-resources"},z=[{name:"AppMenu.UniversalApps",icon:"./images/nav/fast-download.png",iconActive:"./images/nav/fast-download-active.png",path:$.Home,routerName:W.Home},{name:"AppMenu.FastDownloadHome",subtitle:"AppMenu.MyComputerResourcesSubtitle",icon:"./images/nav/fast-download.png",iconActive:"./images/nav/fast-download-active.png",path:$.FastDownload,routerName:W.FastDownload},{name:"AppMenu.MyInstalledApps",subtitle:"AppMenu.MyInstalledAppsSubtitle",icon:"./images/nav/my-ai.png",iconActive:"./images/nav/my-ai-active.png",path:$.InstalledApps,routerName:W.InstalledApps}],J={},K=function(e,t,a){let n=Promise.resolve();if(t&&t.length>0){const e=document.getElementsByTagName("link"),r=document.querySelector("meta[property=csp-nonce]"),o=r?.nonce||r?.getAttribute("nonce");n=Promise.allSettled(t.map((t=>{if(t=function(e,t){return new URL(e,t).href}(t,a),t in J)return;J[t]=!0;const n=t.endsWith(".css"),r=n?'[rel="stylesheet"]':"";if(!!a)for(let a=e.length-1;a>=0;a--){const r=e[a];if(r.href===t&&(!n||"stylesheet"===r.rel))return}else if(document.querySelector(`link[href="${t}"]${r}`))return;const s=document.createElement("link");return s.rel=n?"stylesheet":"modulepreload",n||(s.as="script"),s.crossOrigin="",s.href=t,o&&s.setAttribute("nonce",o),document.head.appendChild(s),n?new Promise(((e,a)=>{s.addEventListener("load",e),s.addEventListener("error",(()=>a(new Error(`Unable to preload CSS for ${t}`))))})):void 0})))}function r(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return n.then((t=>{for(const e of t||[])"rejected"===e.status&&r(e.reason);return e().catch(r)}))},Q=[{path:$.Home,name:W.Home,component:()=>K((()=>import("./UniversalAppHome.js")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]),import.meta.url),meta:{requiresSidebar:!0}},{path:$.FastDownload,name:W.FastDownload,component:()=>K((()=>import("./Home.js")),__vite__mapDeps([18,9,10,11,2,12,7,13,14,19,15,20,21,22,16,23]),import.meta.url),meta:{requiresSidebar:!0}},{path:"/app/:id",name:W.AppDetail,component:()=>K((()=>import("./AppDetail.js")),__vite__mapDeps([24,25,2,7,6,19,15,5,26,27,28,29,30,22,10,11,12,13,16,31]),import.meta.url),meta:{requiresSidebar:!0}},{path:$.StoryPostDetail,name:W.StoryPostDetail,component:()=>K((()=>import("./StoryPostDetail.js")),__vite__mapDeps([32,3,20,7,2,21,10,11,12,13,15,16,33]),import.meta.url),meta:{requiresSidebar:!0}},{path:$.InstalledApps,name:W.InstalledApps,component:()=>K((()=>import("./InstalledApps.js")),__vite__mapDeps([34,26,27,2,28,29,5,6,7,30,9,10,11,12,13,14,15,16]),import.meta.url),meta:{requiresSidebar:!0}},{path:$.MyResource,name:W.MyResource,component:()=>K((()=>import("./MyResource.js")),__vite__mapDeps([35,10,11,2,12,7,13,15,16]),import.meta.url),meta:{requiresSidebar:!0}},{path:$.AppRunning,name:W.AppRunning,component:()=>K((()=>import("./AppRunningWindow.js")),__vite__mapDeps([36,2,22,15,28,37,12,26,6,7,4,38,11,16,39]),import.meta.url),meta:{requiresSidebar:!1}},{path:$.UniversalAppCat,name:W.UniversalAppCat,component:()=>K((()=>import("./UniversalAppCat.js")),__vite__mapDeps([40,10,11,2,12,7,13,1,3,4,5,6,8,15,16,41]),import.meta.url),meta:{requiresSidebar:!0}},{path:$.UniversalAppRunning,name:W.UniversalAppRunning,component:()=>K((()=>import("./UniversalAppRunningWindow.js")),__vite__mapDeps([42,2,7]),import.meta.url),meta:{requiresSidebar:!1}}],X=e({history:t(),routes:Q}),Y={OPEN_RUNNING_WINDOW:"open-running-window",OPEN_RUNNING_WINDOW_AND_INSTALL:"open-running-window-and-install",RUNNING_STATUS_CHANGE:"running-status-change",GET_BASE_CONFIG:"get-base-config",GET_DEFAULT_CONFIG:"get-default-config",GET_DEFAULT_ROOT_DIR:"get-default-root-dir",GET_DEFAULT_CONFIG_AND_ROOT_DIR:"get-default-config-and-root-dir",SAVE_BASE_CONFIG:"save-base-config",GET_ENV_VARIABLES:"get-env-variables",SAVE_ENV_VARIABLES:"save-env-variables",SHOW_ABOUT:"show-about",OPEN_PATH:"open-path",SELECT_DIR:"select-dir",GET_PROCESS_ENV:"get-process-env",RESTART_APP:"restart-app",EXIT_APP:"exit-app",RUN_COMMAND:"run-command",KILL_PROCESSES:"kill-processes",SUPPORT_WEBVIEW_TAG:"support-webview-tag"};class Z{static info(){window.ipcRenderer?.invoke(Y.SHOW_ABOUT)}}class ee{static getCurrentIndex(e){let t=z.findIndex((t=>t.routerName===e));if(-1===t)switch(e){case W.UniversalAppCat:t=0;break;case W.AppDetail:case W.StoryPostDetail:t=1}return t}}const te={class:"pa-4 text-center mx-auto"},ae={style:{width:"192px"}},ne={class:"lmd-left-bottom-link"},re={class:"lmd-left-bottom-link"},oe=(e,t)=>{const a=e.__vccOpts||e;for(const[n,r]of t)a[n]=r;return a},se=oe(a({__name:"left-nav-drawer",setup(e){const t=n([0]);r((()=>{const e=X.currentRoute.value.name;if(e){const a=ee.getCurrentIndex(e.toString());t.value=[a]}}));const a=(e,t)=>{let a;return a=t?e.iconActive:e.icon,a},h=e=>{e.preventDefault(),Z.info()},A=e=>{e.preventDefault()};return X.afterEach(((e,a)=>{const n=e.name;if(n){const e=ee.getCurrentIndex(String(n));t.value=[e]}})),(e,n)=>(s(),o(R,{app:"",width:"240",class:"lmd-bg-gray lmd-left-nav window-drag",permanent:""},{prepend:i((()=>n[1]||(n[1]=[l("div",{class:"pt-10"},null,-1)]))),append:i((()=>[c(b,{class:"mb-2 window-no-drag"},{default:i((()=>[c(L,null,{prepend:i((()=>[c(I,{src:"./images/icons/about.png",width:"24",height:"24"})])),default:i((()=>[l("div",ne,[l("a",{href:"#",onClick:h},d(e.$t("App.about")),1)])])),_:1}),c(L,null,{prepend:i((()=>[c(I,{src:"./images/icons/help.png",width:"24",height:"24"})])),default:i((()=>[l("div",re,[l("a",{href:"#",onClick:A},[f(d(e.$t("App.help"))+" ",1),c(O,{activator:"parent",location:"right"},{default:i((()=>[f(d(e.$t("App.UnderConstruction")),1)])),_:1})])])])),_:1})])),_:1})])),default:i((()=>[l("div",te,[c(b,{nav:"",style:{padding:"0px"},class:"d-flex flex-column ga-6",selected:m(t),"onUpdate:selected":n[0]||(n[0]=e=>_(t)?t.value=e:null),color:"#FA6400","base-color":"#424254"},{default:i((()=>[(s(!0),p(g,null,u(m(z),((t,n)=>(s(),o(L,{key:n,"active-class":"nav-item-active",class:"nav-item window-no-drag",draggable:"false",variant:"plain",rounded:"lg",style:{height:"118px","background-color":"#fff"},onClick:e=>(e=>{X.push({name:e.routerName})})(t),value:n},{default:i((n=>[c(I,{class:"mx-auto nav-item-icon",draggable:"false",src:a(t,n.isActive),width:"60",height:"60"},null,8,["src"]),l("div",ae,d(e.$t(t.name)),1)])),_:2},1032,["onClick","value"])))),128))])),_:1},8,["selected"])])])),_:1}))}}),[["__scopeId","data-v-daaf0dda"]]),ie=axios.create({baseURL:"https://jsonplaceholder.typicode.com"}),le=G("user",{state:()=>({users:[],token:""}),actions:{async fetchUsers(){try{const e=await ie.get("/users");this.users=e.data}catch(e){console.error("Failed to fetch users:",e)}},setToken(e){this.token=e}}});function ce(e,t){const[a,n]=e.split("?",2),r=new URLSearchParams(n);for(const[s,i]of Object.entries(t))null!=i&&(Array.isArray(i)?i.forEach((e=>r.append(s,e.toString()))):r.append(s,i.toString()));const o=r.toString();return o?`${a}?${o}`:a}function pe(e){const t=window.location.search,a={};if(!t)return null;const n=new URLSearchParams(t);for(const[r,o]of n.entries())a.hasOwnProperty(r)?(Array.isArray(a[r])||(a[r]=[a[r]]),a[r].push(o)):a[r]=o;return a[e]}class ue{static LMD_BASE_CONFIG="lmd_base_config"}const de=async()=>window.ipcRenderer?await(window.ipcRenderer?.invoke(Y.GET_BASE_CONFIG)):JSON.parse(localStorage.getItem(ue.LMD_BASE_CONFIG)||"{}"),me=async()=>{let e=null;if(window.ipcRenderer)try{e=await(window.ipcRenderer?.invoke(Y.GET_DEFAULT_CONFIG_AND_ROOT_DIR))||null}catch(t){return console.log(t),null}return e},ge=async()=>await(window.ipcRenderer?.invoke(Y.GET_ENV_VARIABLES)),_e=async e=>{const t=JSON.stringify(e);if(localStorage.setItem(ue.LMD_BASE_CONFIG,JSON.stringify(e)),window.ipcRenderer)return window.ipcRenderer?.invoke(Y.SAVE_BASE_CONFIG,t)},fe=async e=>{const t=JSON.stringify(e);return window.ipcRenderer?.invoke(Y.SAVE_ENV_VARIABLES,t)},he=async e=>await(window.ipcRenderer?.invoke(Y.OPEN_PATH,e));class Ae{static getSystemLocale(){return navigator.language}static getDefaultLocale(){let e="en";try{const t=this.getSystemLocale();switch(t.split("-")[0]){case"en":default:e="en";break;case"zh":e="zhHans"}}catch(t){console.log("get system locale error, use default en.",t)}return e}static getLocaleIcon(e){let t="";switch(e){case"en":default:t="./images/icons/locale-en.png";break;case"zhHans":t="./images/icons/locale-zhHans.png"}return t}static saveLocaleToStorage=(e,t)=>{t.LMD_LOCALE=e,_e(t)};static getCurrentLocale(){let e="en";try{e=JSON.parse(localStorage.getItem(ue.LMD_BASE_CONFIG)||"").LMD_LOCALE}catch(t){console.error("getCurrentLocale error: ",t)}return e}static localeIsEn(){return"en"===this.getCurrentLocale()}}const ve=axios.create({baseURL:"http://localhost:19312/api",timeout:6e3});async function we(e,t={},a=100){return async function n(r){try{console.log(`Attempt ${r}: Calling API...`);return await ve(e,t)}catch(s){if(r<a)return console.error(`Attempt ${r} failed. Retrying in 1000ms...`),await(o=1e3,new Promise((e=>setTimeout(e,o)))),n(r+1);throw console.error("All attempts failed. Throwing error..."),new Error("Failed to call API after 100 attempts")}var o}(1)}ve.interceptors.request.use((e=>{const t=le().token;if(t&&(e.headers.Authorization=`Bearer ${t}`),e.url){const t=Ae.getCurrentLocale();e.url=ce(e.url,{locale:t})}return e}),(e=>(console.error("Request Error:",e),Promise.reject(e)))),ve.interceptors.response.use((e=>(e.data&&"string"==typeof e.data&&(e.data=JSON.parse(e.data)),e)),(e=>{if(console.error("Response Error:",e),e.response)switch(e.response.status){case 401:console.warn("Unauthorized access. Redirecting to login...");break;case 403:console.warn("Forbidden access.");break;case 404:console.warn("Resource not found.");break;case 500:console.error("Server internal error.");break;default:console.error("Unexpected error occurred.")}return Promise.reject(e)}));const ye=async()=>{let e;try{e=(await we("/health-check")).data}catch(t){return console.log("health check err",t),e}},Ee=a({__name:"AppDefaultLayout",setup(e){const t=n(!1);return r((()=>{ye().then((()=>{t.value=!0,postMessage({payload:"removeLoading"},"*")}));document.querySelector("html").setAttribute("main-window","")})),h((()=>{const e=document.querySelector("html");e&&e.removeAttribute("main-window")})),(e,a)=>{const n=v("router-view");return m(t)?(s(),o(N,{key:0,class:"lmd-application",style:{overflow:"hidden"}},{default:i((()=>[c(se),c(D,{class:"d-flex justify-center",style:{"min-height":"300px"}},{default:i((()=>[c(n)])),_:1})])),_:1})):A("",!0)}}}),Se=a({__name:"AppNoSidebarLayout",setup:e=>(r((()=>{document.querySelector("html").setAttribute("running-window",""),ye().then((()=>{postMessage({payload:"removeLoading"},"*")}))})),h((()=>{const e=document.querySelector("html");e&&e.removeAttribute("running-window")})),(e,t)=>{const a=v("router-view");return s(),o(N,null,{default:i((()=>[c(D,{class:"d-flex justify-center",style:{"min-height":"300px"}},{default:i((()=>[c(a)])),_:1})])),_:1})})}),Re=a({__name:"toast-message",props:{color:{},variant:{},message:{},showCloseBtn:{type:Boolean}},setup(e,{expose:t}){const a=n(),r=()=>{a.value=!1};return t({show:()=>{a.value=!0},hide:r}),(e,t)=>(s(),o(C,{timeout:3e3,color:e.color,variant:e.variant,modelValue:m(a),"onUpdate:modelValue":t[0]||(t[0]=e=>_(a)?a.value=e:null)},{actions:i((()=>[e.showCloseBtn?(s(),o(T,{key:0,color:"white",variant:"text",onClick:r},{default:i((()=>[f(d(e.$t("Common.close")),1)])),_:1})):A("",!0)])),default:i((()=>[f(d(e.message)+" ",1)])),_:1},8,["color","variant","modelValue"]))}}),Le=a({__name:"App",setup(e){const t=n(""),a=n(),r=n("primary"),i=w((()=>{const e=X.currentRoute.value?.meta?.requiresSidebar;return!0===e?Ee:!1===e?Se:null}));return E("showToastMessage",((e,n)=>{t.value=e,r.value=n,a.value?.show()})),(e,n)=>(s(),p(g,null,[m(i)?(s(),o(y(m(i)),{key:0})):A("",!0),c(Re,{message:m(t),ref_key:"toastMsg",ref:a,color:m(r),variant:"flat",showCloseBtn:!1},null,8,["message","color"])],64))}}),Ie={en:{...q,$vuetify:{...k}},zhHans:{...H,$vuetify:{...P}}};window.ipcRenderer?.on("main-process-message",((e,...t)=>{console.log("[Receive Main-process message]:",...t)}));const be=x(),Oe=e=>{const t=e.LMD_LOCALE||Ae.getDefaultLocale();Ae.saveLocaleToStorage(t,e);const a=(e=>j({legacy:!1,locale:e,fallbackLocale:"en",messages:Ie}))(e.LMD_LOCALE),n=U({defaults:{global:{ripple:!1}},components:V,directives:M,locale:{adapter:F({i18n:a,useI18n:B})},theme:{defaultTheme:"light",themes:{light:{dark:!1,colors:{primary:"#FA6400"}},dark:{dark:!0,colors:{primary:"#FA6400"}}}}}),r=S(Le);r.config.errorHandler=(e,t,a)=>{console.error("Global Error Handler:",e,a)},r.use(n).use(a).use(X).use(be).mount("#app")};de().then((e=>{Oe(e)}));export{W as A,Y as I,Ae as L,oe as _,ve as a,pe as b,ge as c,ce as d,$ as e,me as f,de as g,_e as h,he as o,X as r,fe as s,le as u};
