import{j as n,k as e,I as a}from"./index.js";import{u as t,a as o,q as s}from"./lmd-system.js";const i={INSTALL:"install",START:"start",UPDATE:"update",REMOVE:"remove",DOWNLOAD_MODEL:"download_model"};class c{static getRunningWindowPath(a,t,o,s=void 0){let i=n.AppRunningV2.replace(":id",a);return i=e(i,{script:t,module:s}),i}static openRunningWinV2(n,e,o=void 0){const{id:s,installName:i}=n,c=this.getRunningWindowPath(s,e,i,o);console.log("openRunningWinV2 appModule",o),console.log("openRunningWinV2 runningPagePath",c),setTimeout((async()=>{try{await t()}catch(n){console.log("updateGlobalEnv err",n)}}),0),window.ipcRenderer?.invoke(a.OPEN_RUNNING_WINDOW,s,c,!1)}static openAppRunningWindow(n,e,t=""){const o=this.getRunningWindowPath(n,e,t);let s=!1;e===i.REMOVE&&(s=!0),console.log("openAppRunningWindow",n,e,s),window.ipcRenderer?.invoke(a.OPEN_RUNNING_WINDOW,n,o,s)}static goToRunningPage(n,e,a){const t=this.getRunningWindowPath(n,e,a);location.href=location.pathname+"#"+t}static openUniversalAppWebview(e){let t=n.UniversalAppRunning.replace(":name",encodeURIComponent(e.name));e.url&&(t=t.replace(":url",encodeURIComponent(e.url))),e.icon&&(t=t.replace(":icon",encodeURIComponent(e.icon))),window.ipcRenderer?.invoke(a.OPEN_RUNNING_WINDOW,e.name,t)}static openUAppLiteWindow(e){let t=n.UniversalAppTitle.replace(":name",encodeURIComponent(e.name));e.url&&(t=t.replace(":url",encodeURIComponent(e.url))),e.icon&&(t=t.replace(":icon",encodeURIComponent(e.icon))),window.ipcRenderer?.invoke(a.OPEN_UAPP_RUNNING_WINDOW,e.name,t,e)}}const l=async(n,e)=>{let a=`/self-manage/installed-instance/app/${n.id}`;e&&(a+=`/type/${e}`);return(await o.post(a,n)).data},r=async n=>(await o.get(`/self-manage/installed-instance/${n}`)).data,p=async()=>(await o.get("/self-manage/installed-instance")).data,d=async n=>(await o.delete(`/self-manage/installed-instance/${n}`)).data,g=async n=>new Promise((async e=>{const a=async()=>{try{const t=`${s}/self-manage/installed-instance/${n}`,o=await axios.get(t),i=2e3;200===o.status?(console.log("Received 200, continue"),setTimeout(a,i)):404===o.status?(console.log("Received 404, stop"),e()):(console.log(`Received unexpected status code: ${o.status}`),e())}catch(t){const n=t;404===n.response?.status?(console.log("Received 404, stop"),e()):(console.error("Error",n.message),e())}};await a()})),u={DEFAULT:"default",DOCKER:"docker"};class m{static isWindows(){const n=navigator.userAgentData;return n&&n.platform?"Windows"===n.platform:!!navigator.userAgent&&/Win(dows )?NT/.test(navigator.userAgent)}static isMacOS(){const n=navigator.userAgentData;return n&&n.platform?"macOS"===n.platform||"MacOS"===n.platform:!!navigator.userAgent&&/Macintosh|Mac OS X/i.test(navigator.userAgent)}}export{c as A,u as I,m as O,i as a,g as b,l as c,d,r as e,p as g};
