import{N as e}from"./vue-easy-lightbox.js";import{s as l,z as a,A as t,b as s,B as n,C as i,o,l as p,p as r,D as u,E as c,F as d,q as m,G as f,H as g,I as A,J as D,n as y,d as v,w as h,x as _,y as L,K as b,r as x}from"./vuetify.js";import{e as k,b as M,l as w,a3 as I,F as T,k as V,a1 as C,a4 as $,u as F,a0 as R,$ as O,S,K as j,a2 as B,a5 as U,aa as E,H,j as N,c as z,a9 as G,m as P,y as W,ab as q,ac as K}from"./vue.js";import{g as Y,c as J,A as Q,O as X}from"./OSUtil.js";import"./index2.js";import{A as Z,I as ee}from"./InstallType.js";import{i as le,c as ae,a as te,_ as se}from"./lmd-system.js";import{b as ne,c as ie,g as oe,T as pe,L as re}from"./index.js";import{a as ue,C as ce,u as de,_ as me}from"./top-right-controls.vue_vue_type_style_index_0_lang.js";import{d as fe}from"./pinia.js";import{_ as ge}from"./single-installed-instance.vue_vue_type_style_index_0_lang.js";import{u as Ae}from"./lmapp.js";import{A as De}from"./AppInfoUtil.js";import"./xterm.js";import"./debounce.js";import"./vuei18n.js";import"./lmd-locales.js";import"./DateTimeUtil.js";import"./dayjs.js";const ye=fe("installedInstance",{state:()=>({installCurrentApp:!1,instancesForApp:[],instancesForAppLoading:!1,instanceForRunning:{}}),actions:{async getInstalledInstanceForApp(e){try{this.instancesForAppLoading=!0;const l=await ne.get(`/self-manage/installed-instance/app/${e}`);this.instancesForApp=l.data,this.instancesForAppLoading=!1}catch(l){console.error("Failed to fetch app:",l)}},async getInstalledInstanceForRunning(e){try{const l=await ne.get(`/self-manage/installed-instance/${e}`);this.instanceForRunning=l.data}catch(l){console.error("Failed to fetch app:",l)}},installAppTrigger(){this.installCurrentApp=!0,setTimeout((()=>{this.installCurrentApp=!1}),100)}}}),ve=k({__name:"app-snapshot-slide",props:{snapshots:{}},setup(o){const p=M(!1),r=M(!1),u=M(""),c=M(0),d=o;w(c,(e=>{void 0===e&&(e=0);const l=d.snapshots[e];m(l)}));const m=e=>{null!==e&&(r.value=!0,u.value=e)};return(o,d)=>(R(),I(T,null,[V(l,{"show-arrows":"",class:"pa-0",style:{"margin-left":"0rem","margin-right":"0"},"selected-class":"bg-success",modelValue:c.value,"onUpdate:modelValue":d[0]||(d[0]=e=>c.value=e)},{default:C((()=>[(R(!0),I(T,null,$(o.snapshots,((e,l)=>(R(),O(i,{key:l},{default:C((({isSelected:l,toggle:a,selectedClass:n})=>[V(t,{class:"my-3 ma-4",width:"265",height:"160",onClick:a},{default:C((()=>[V(s,{cover:"",width:"100%",height:"100%",src:e},null,8,["src"])])),_:2},1032,["onClick"])])),_:2},1024)))),128))])),_:1},8,["modelValue"]),V(a,{class:"mx-10 my-16",modelValue:p.value,"onUpdate:modelValue":d[2]||(d[2]=e=>p.value=e),width:"auto","min-width":"1200px","max-width":"1800px"},{default:C((()=>[V(t,null,{default:C((()=>[V(s,{src:u.value},null,8,["src"])])),_:1}),V(n,{icon:"mdi-close",location:"bottom center",absolute:"",elevation:"6",offset:"",onClick:d[1]||(d[1]=e=>p.value=!1)})])),_:1},8,["modelValue"]),V(F(e),{class:"window-no-drag",visible:r.value,imgs:o.snapshots,index:c.value,onHide:d[3]||(d[3]=e=>r.value=!1)},null,8,["visible","imgs","index"])],64))}}),he=["innerHTML"],_e=k({__name:"common-msg-dialog",props:{modelValue:{type:Boolean,required:!0},title:{type:String,default:""},title2:{type:String,default:""},message:{type:String,default:""},closeBtnLabel:{type:String,default:""}},emits:["update:modelValue","confirm","close"],setup(e,{emit:l}){const n=e,i=l,f=M(n.modelValue);w((()=>n.modelValue),(e=>{f.value=e})),w(f,(e=>{i("update:modelValue",e)}));const g=()=>{f.value=!1,i("close")};return(l,n)=>(R(),O(a,{modelValue:f.value,"onUpdate:modelValue":n[0]||(n[0]=e=>f.value=e),"max-width":"680","min-width":"400"},{default:C((()=>[V(t,{class:"px-0"},{default:C((()=>[V(o,{class:"dialog-title"},{default:C((()=>[S(j(e.title),1)])),_:1}),V(p,{class:"d-flex flex-row px-10",style:{"padding-bottom":"64px","padding-top":"64px"}},{default:C((()=>[B("div",null,[V(s,{src:"./images/app/task.svg",width:"164",height:"120"})]),V(p,{style:{flex:"1"}},{default:C((()=>[V(r,{class:"dialog-title2"},{default:C((()=>[S(j(e.title2),1)])),_:1}),V(u,null,{default:C((()=>[e.message?(R(),I("div",{key:0,innerHTML:e.message},null,8,he)):U("",!0),E(l.$slots,"default")])),_:3})])),_:3})])),_:3}),V(c,{class:"confirm-actions"},{default:C((()=>[V(d),V(m,{variant:"outlined",onClick:g},{default:C((()=>[S(j(e.closeBtnLabel),1)])),_:1}),V(d)])),_:1})])),_:3})])),_:3},8,["modelValue"]))}}),Le=k({__name:"install-confirm-dialog",props:{modelValue:{type:Boolean,required:!0},title:{type:String,default:""},title2:{type:String,default:""},message:{type:String,default:""},cancelBtnLabel:{type:String,default:""},confirmBtnLabel:{type:String,default:""}},emits:["update:modelValue","confirm","cancel"],setup(e,{emit:l}){const{addToast:n}=ie(),{t:i}=f(),g=e,A=l,D=M(g.modelValue),y=M(!1);w((()=>g.modelValue),(e=>{D.value=e})),w(D,(e=>{A("update:modelValue",e)}));const v=()=>{D.value=!1,A("cancel")},h=async()=>{y.value=!0;const e=await le();if(!e)return n(i("LMAppDetail.InstallToolDialogErrorMsg"),"error"),void(y.value=!1);console.log("installResult",e),D.value=!1,y.value=!1,A("confirm")};return(l,n)=>(R(),O(a,{modelValue:D.value,"onUpdate:modelValue":n[0]||(n[0]=e=>D.value=e),"max-width":"680","min-width":"400",persistent:y.value},{default:C((()=>[V(t,{class:"px-0"},{default:C((()=>[V(o,{class:"dialog-title"},{default:C((()=>[S(j(e.title),1)])),_:1}),V(p,{class:"d-flex flex-row px-10",style:{"padding-bottom":"64px","padding-top":"64px"}},{default:C((()=>[B("div",null,[V(s,{src:"./images/app/task.svg",width:"164",height:"120"})]),V(p,{style:{flex:"1"}},{default:C((()=>[V(r,{class:"dialog-title2"},{default:C((()=>[S(j(e.title2),1)])),_:1}),V(u,null,{default:C((()=>[S(j(e.message),1)])),_:1})])),_:1})])),_:1}),V(c,{class:"confirm-actions"},{default:C((()=>[V(d),y.value?U("",!0):(R(),O(m,{key:0,variant:"outlined",onClick:v},{default:C((()=>[S(j(e.cancelBtnLabel),1)])),_:1})),V(m,{variant:"flat",color:"primary",onClick:h,disabled:y.value,loading:y.value},{default:C((()=>[S(j(e.confirmBtnLabel),1)])),_:1},8,["disabled","loading"]),V(d)])),_:1})])),_:1})])),_:1},8,["modelValue","persistent"]))}}),be=k({__name:"global-setting-confirm-dialog",props:{modelValue:{type:Boolean}},emits:["update:modelValue","confirm","cancel"],setup(e,{emit:l}){const s=ue(),n=e,i=l,p=M(!1),r=M("");H((async()=>{const e=await oe();r.value=e.LMD_DATA_ROOT})),w((()=>p.value),(e=>{i("update:modelValue",e)})),w((()=>n.modelValue),(e=>{p.value=e})),w((()=>s.showDialog),(e=>{e&&(p.value=!0)}));const d=()=>{i("cancel"),p.value=!1},f=async()=>{p.value=!1,i("confirm")};return(e,l)=>(R(),O(a,{modelValue:F(p),"onUpdate:modelValue":l[0]||(l[0]=e=>N(p)?p.value=e:null),"max-width":"400"},{default:C((()=>[V(t,null,{default:C((()=>[V(o,{class:"headline"},{default:C((()=>[S(j(e.$t("LMAppDetail.ChangeStorageDirTitle")),1)])),_:1}),V(u,null,{default:C((()=>[S(j(e.$t("LMAppDetail.ChangeStorageDirMsg"))+" ",1),l[1]||(l[1]=B("br",null,null,-1)),S(" "+j(F(r)),1)])),_:1}),V(c,{class:"justify-center mb-2"},{default:C((()=>[V(m,{variant:"outlined",onClick:d},{default:C((()=>[S(j(e.$t("LMAppDetail.UseThisDir")),1)])),_:1}),V(m,{variant:"flat",color:"primary",onClick:f},{default:C((()=>[S(j(e.$t("LMAppDetail.ChangeStorageDirBtn")),1)])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"]))}}),xe=["href"],ke=k({__name:"simple-install-btn",props:{lmAppData:{},installType:{}},setup(e){const l=ye(),a=M(!1),t=M(!1),s=M(!1),n=M(!1),i=M(""),o=ue(),{t:p}=f(),{addToast:r}=ie(),u=e,c=()=>{a.value=!1},d=()=>{c()},A=()=>{c(),setTimeout((()=>{D()}),500)},D=()=>{t.value?b():$()},y=async e=>{await v()&&(t.value=e,await _()||L())},v=async()=>{const e=await ae();return e?.installed?(console.log("docker installed"),!!e?.running||(console.log("docker is not running"),r(p("LMAppDetail.DockerNotRunning"),"error"),n.value=!0,i.value=p("LMAppDetail.DockerNotRunning"),!1)):(r(p("LMAppDetail.DockerNotInstalled"),"error"),i.value=p("LMAppDetail.DockerNotInstalled"),n.value=!0,!1)},h=()=>{o.showDialogTrigger()},_=async()=>{const e=await Y();return!(e&&e.length>0)&&(s.value=!0,!0)},L=async()=>{await te()?D():a.value=!0},b=async()=>{await J(u.lmAppData,u.installType),x()},x=async()=>{await l.getInstalledInstanceForApp(u.lmAppData?.id),k()},k=()=>{if(console.log("openRunningWindow currentTypeInstallInstance",H.value),H.value)if(H.value){const e=H.value.id;Z.openAppRunningWindow(e,Q.INSTALL,H.value.installName)}else console.error("data err firstInstallInstance",H)},$=()=>{H.value&&Z.openAppRunningWindow(H.value.id,Q.INSTALL,H.value.installName)};w((()=>l.installCurrentApp),(e=>{e&&b()}));const E=()=>{L()},H=z((()=>{if(l.instancesForApp?.length>0){return l.instancesForApp.find((e=>e.installMethod===u.installType))}}));return(e,t)=>{const o=_e;return R(),I(T,null,[B("div",null,[F(l).instancesForAppLoading?(R(),O(g,{key:0,color:"primary",indeterminate:""})):(R(),I(T,{key:1},[F(H)?(R(),O(m,{key:0,variant:"flat",color:"primary",style:{"min-width":"80px"},onClick:t[0]||(t[0]=e=>y(!1))},{default:C((()=>[S(j(e.$t("LMAppDetail.Reinstall")),1)])),_:1})):U("",!0),F(H)?U("",!0):(R(),O(m,{key:1,variant:"flat",color:"primary",style:{"min-width":"80px"},onClick:t[1]||(t[1]=e=>y(!0))},{default:C((()=>[S(j(e.$t("LMAppDetail.install")),1)])),_:1}))],64))]),V(Le,{modelValue:F(a),"onUpdate:modelValue":t[2]||(t[2]=e=>N(a)?a.value=e:null),title:e.$t("LMAppDetail.InstallToolDialogTitle"),title2:e.$t("LMAppDetail.InstallToolDialogTitle2"),message:e.$t("LMAppDetail.InstallToolDialogMsg"),"cancel-btn-label":e.$t("LMAppDetail.Cancel"),"confirm-btn-label":e.$t("LMAppDetail.InstallGitBtnLabel"),onConfirm:A,onCancel:d},null,8,["modelValue","title","title2","message","cancel-btn-label","confirm-btn-label"]),V(be,{modelValue:F(s),"onUpdate:modelValue":t[3]||(t[3]=e=>N(s)?s.value=e:null),onConfirm:h,onCancel:E},null,8,["modelValue"]),V(o,{title:F(p)("LMAppDetail.DockerMode"),title2:F(i),"close-btn-label":e.$t("LMAppDetail.Close"),modelValue:F(n),"onUpdate:modelValue":t[4]||(t[4]=e=>N(n)?n.value=e:null)},{default:C((()=>[S(j(e.$t("LMAppDetail.DockerInstallTip"))+" ",1),B("a",{href:e.$t("LMAppDetail.DockerInstallLink"),target:"_blank",style:G({color:F(pe).PRIMARY_COLOR})},j(e.$t("LMAppDetail.DockerInstallTitle")),13,xe)])),_:1},8,["title","title2","close-btn-label","modelValue"])],64)}}}),Me=["href"],we=k({__name:"install-btn-group",props:{lmAppData:{}},setup(e){const l=e,a=ye(),t=M("default"),s=M(!0),n=e=>{if(a.instancesForApp?.length>0){return a.instancesForApp.find((l=>l.installMethod===e))}};w((()=>a.instancesForAppLoading),(()=>{i()})),H((()=>{i()}));const i=()=>{console.log("updateOptins installedInstanceStore.instancesForAppLoading",a.instancesForAppLoading),console.log("appHasDefaultMode",o.value),!1===a.instancesForAppLoading&&(o.value?(t.value=ee.DEFAULT,s.value=!0):(t.value=ee.DOCKER,s.value=!1))},o=z((()=>{const e=l.lmAppData.downloadInfo;if(e?.length>0){const l=e[0];if(l?.downloadType?.includes(ee.DEFAULT))return!0}return!1}));return(e,l)=>{const i=ke;return R(),O(u,{class:"d-flex flex-row",style:{"padding-top":"0rem"}},{default:C((()=>[V(i,{"install-type":F(t),"lm-app-data":e.lmAppData},null,8,["install-type","lm-app-data"]),F(a).instancesForAppLoading?U("",!0):(R(),O(A,{key:0,modelValue:F(t),"onUpdate:modelValue":l[0]||(l[0]=e=>N(t)?t.value=e:null),class:"install-btn-group ml-4"},{default:C((()=>[F(s)?(R(),O(D,{key:0,value:F(ee).DEFAULT,color:F(pe).PRIMARY_COLOR},{label:C((()=>[S(j(e.$t("LMAppDetail.DefaultMode"))+" ",1),n(F(ee).DEFAULT)?(R(),I(T,{key:0},[S(" ("+j(e.$t("LMAppDetail.AppInstalled"))+") ",1)],64)):U("",!0)])),_:1},8,["value","color"])):U("",!0),V(D,{value:F(ee).DOCKER,color:F(pe).PRIMARY_COLOR},{label:C((()=>[S(j(e.$t("LMAppDetail.DockerMode"))+" ",1),n(F(ee).DOCKER)?(R(),I(T,{key:0},[S(" ("+j(e.$t("LMAppDetail.AppInstalled"))+") ",1)],64)):U("",!0),V(y,{interactive:"",location:"top"},{activator:C((({props:e})=>[V(v,P(e,{class:"ml-1",style:{opacity:"1"},color:F(pe).PRIMARY_COLOR,icon:"mdi-information"}),null,16,["color"])])),default:C((()=>[S(" "+j(e.$t("LMAppDetail.DockerInstallTip"))+" ",1),B("a",{href:e.$t("LMAppDetail.DockerInstallLink"),target:"_blank",style:G({color:F(pe).PRIMARY_COLOR})},j(e.$t("LMAppDetail.DockerInstallTitle")),13,Me)])),_:1})])),_:1},8,["value","color"])])),_:1},8,["modelValue"]))])),_:1})}}}),Ie={class:"mr-2"},Te={style:{flex:"1"}},Ve={key:0,class:"d-flex ga-3 mx-4"},Ce=se(k({__name:"basic-info-and-tags",props:{lmAppData:{}},setup(e){const l=e,a=M(!0);ye(),H((async()=>{const e=await oe();a.value=ce.checkDirCharsIsValid(e.LMD_DATA_ROOT)}));const t=z((()=>{let e="";e=X.isWindows()?"docker_win":"docker_mac";const a=l.lmAppData.downloadInfo;if(a?.length>0){const l=a[0];if(l?.downloadType?.includes(e))return!0}return!1}));return(e,l)=>{const n=we;return R(),I(T,null,[V(h,{class:"mt-1 mx-1"},{default:C((()=>[B("div",Ie,[V(s,{src:e.lmAppData.icon,width:"7.5rem",height:"7.5rem",style:{"border-radius":"8px"}},null,8,["src"])]),B("div",Te,[V(o,{class:"",style:{"font-size":"1.375rem","font-weight":"bold","padding-bottom":"0.2rem","padding-top":"0.0rem"}},{default:C((()=>[S(j(e.lmAppData.name),1)])),_:1}),V(r,{class:"",style:{"font-size":"1rem",color:"#111",opacity:"1","white-space":"break-spaces"}},{default:C((()=>[S(j(e.lmAppData.shortDesc),1)])),_:1}),V(d,{class:"pt-4"}),F(t)?U("",!0):(R(),O(ke,{key:0,"install-type":"default","lm-app-data":e.lmAppData},null,8,["lm-app-data"])),F(t)?(R(),O(n,{key:1,"lm-app-data":e.lmAppData},null,8,["lm-app-data"])):U("",!0),F(a)?U("",!0):(R(),O(u,{key:2,class:"py-0 d-flex",style:{color:"red","justify-items":"center"}},{default:C((()=>[V(v,{style:{opacity:"1"},color:"#F00",icon:"mdi-information-slab-circle-outline"}),S(" "+j(e.$t("ConfigDialog.DirCharsNotValidTip")),1)])),_:1}))])])),_:1}),V(h,null,{default:C((()=>[V(_,null,{default:C((()=>[V(L,{class:"mt-0 mb-3 mx-4",style:{opacity:"1"},color:"#EBEBF7"}),V(o,{"primary-title":"",style:{"font-weight":"bold"}},{default:C((()=>[S(j(e.$t("LMAppDetail.AppFeatures")),1)])),_:1}),e.lmAppData.tags?(R(),I("div",Ve,[(R(!0),I(T,null,$(e.lmAppData.tags,((e,l)=>(R(),I("div",{class:"app-feature-tag px-4",key:l},j(e),1)))),128))])):U("",!0),V(L,{class:"mt-6 mb-2 mx-4",style:{opacity:"1"},color:"#EBEBF7"})])),_:1})])),_:1})],64)}}}),[["__scopeId","data-v-c2d355aa"]]),$e={class:"text-medium-emphasis mr-3"},Fe=["href"],Re={key:1},Oe={class:"text-medium-emphasis mr-2"},Se={key:2},je={class:"text-medium-emphasis mr-2"},Be={key:3},Ue={class:"text-medium-emphasis mr-2"},Ee={key:4},He={class:"text-medium-emphasis mr-2"},Ne={key:5},ze={class:"text-medium-emphasis mr-2"},Ge={key:6},Pe={class:"text-medium-emphasis mr-2"},We={key:7},qe={class:"text-medium-emphasis mr-2"},Ke=k({__name:"extra-info",props:{lmAppData:{}},setup(e){const{t:l}=f(),a=e=>{let a=l("LMAppDetail.refLinkOther");return"homepage"===e.type?a=l("LMAppDetail.refLinkHomePage"):"github"===e.type?a=l("LMAppDetail.refLinkGithub"):"demo"===e.type&&(a=l("LMAppDetail.refLinkDemo")),a};return(e,l)=>(R(),O(p,{class:"mx-3 extra-info mt-3 mb-2"},{default:C((()=>[e.lmAppData.refLinks&&e.lmAppData.refLinks.length>0?(R(!0),I(T,{key:0},$(e.lmAppData.refLinks,((e,l)=>(R(),I("p",{key:l},[B("span",$e,j(a(e)),1),B("a",{class:"ref-link",href:e.url,target:"_blank"},j(e.url),9,Fe)])))),128)):U("",!0),e.lmAppData?.newVersion?(R(),I("p",Re,[B("span",Oe,j(e.$t("LMAppDetail.newVersion")),1),S(" "+j(e.lmAppData.newVersion),1)])):U("",!0),e.lmAppData?.releaseTime?(R(),I("p",Se,[B("span",je,j(e.$t("LMAppDetail.releaseTime")),1),S(" "+j(e.lmAppData.releaseTime),1)])):U("",!0),e.lmAppData?.licenseInfo?.licenseType?(R(),I("p",Be,[B("span",Ue,j(e.$t("LMAppDetail.licenseType")),1),S(" "+j(e.lmAppData?.licenseInfo?.licenseType),1)])):U("",!0),e.lmAppData?.licenseInfo?.isOpenSource?(R(),I("p",Ee,[B("span",He,j(e.$t("LMAppDetail.isOpenSource")),1),S(" "+j(e.lmAppData?.licenseInfo?.isOpenSource),1)])):U("",!0),e.lmAppData?.licenseInfo?.isFullOpenSource?(R(),I("p",Ne,[B("span",ze,j(e.$t("LMAppDetail.isFullOpenSource")),1),S(" "+j(e.lmAppData?.licenseInfo?.isFullOpenSource),1)])):U("",!0),e.lmAppData?.licenseInfo?.isFree?(R(),I("p",Ge,[B("span",Pe,j(e.$t("LMAppDetail.isFree")),1),S(" "+j(e.lmAppData?.licenseInfo?.isFree),1)])):U("",!0),e.lmAppData?.licenseInfo?.sourceCodeRepo?(R(),I("p",We,[B("span",qe,j(e.$t("LMAppDetail.sourceCodeRepo")),1),S(" "+j(e.lmAppData?.licenseInfo?.sourceCodeRepo),1)])):U("",!0)])),_:1}))}}),Ye={style:{"font-size":"14px",color:"#7D7D7D"},class:"text-center"},Je=k({__name:"installed-info-list",props:{lmAppData:{}},setup(e){const l=ye(),a=M(),t=de(),n=e;H((async()=>{i()}));const i=async()=>{await l.getInstalledInstanceForApp(n.lmAppData?.id)};w((()=>l.instancesForApp),(async e=>{a.value=e})),w((()=>t.currentLocale),i);const o=async()=>{i()},r=async()=>{i()};return(e,l)=>(R(),I(T,null,[V(d,{class:"my-2"}),F(a)&&F(a).length>0?(R(),O(p,{key:0,class:"d-flex flex-column ga-2",style:{width:"100%"}},{default:C((()=>[V(h,null,{default:C((()=>[(R(!0),I(T,null,$(F(a),((e,l)=>(R(),O(_,{key:l},{default:C((()=>[V(ge,{"app-version-visible":!0,"instance-data":e,onDeleted:o,onRefresh:r,"app-name-visible":!0,"icon-visible":!1},null,8,["instance-data"])])),_:2},1024)))),128))])),_:1})])),_:1})):U("",!0),F(a)&&0===F(a).length?(R(),O(p,{key:1,class:"d-flex flex-column ga-2 text-center justify-center"},{default:C((()=>[V(s,{width:"100%",height:"160",src:"./images/app/no-data.svg"}),B("div",Ye,j(e.$t("LMAppDetail.notInstalled")),1)])),_:1})):U("",!0)],64))}});class Qe{static getCUDAGuideLink(){return re.localeIsEn()?"https://daiyl.com/install-cuda.html":"https://seemts.com/zh/install-cuda.html"}}const Xe={class:"fullDescBlock overflow-y-hidden mx-6 mt-1 mb-4",style:{"max-height":"220px"}},Ze=["innerHTML"],el={class:"fullDescBlock overflow-y-hidden mx-6 mt-1 mb-4",style:{"max-height":"250px"}},ll=["innerHTML"],al={class:"text-right justify-end mr-2",style:{width:"100%","margin-top":"-1rem",overflow:"visible",height:"1rem"}},tl=["innerHTML"],sl=k({__name:"full-desc-text",props:{lmAppData:{}},setup(e){const l=M(!1),s=M(null),n=M(!1),{t:i}=f();let p;const r=e;H((()=>{p=new ResizeObserver((e=>{for(const l of e)l.target===s.value&&(n.value=l.contentRect.height>=200)})),s.value&&p.observe(s.value),s.value&&(n.value=s.value.scrollHeight>=200)})),W((()=>{p&&p.unobserve(s.value)}));const c=z((()=>{let e=r.lmAppData?.systemRequirements;if(e&&e.includes("driver-notice-label")){e+=`<a href="${Qe.getCUDAGuideLink()}" target="_blank" class="install-guide-link">${i("LMAppDetail.InstallationGuide")}</a>`}return e}));return(e,i)=>(R(),I(T,null,[V(h,null,{default:C((()=>[V(_,{class:"px-0 py-0"},{default:C((()=>[V(o,{class:"mb-0 mx-2",style:{"font-weight":"bold"}},{default:C((()=>[S(j(e.$t("LMAppDetail.SysReq")),1)])),_:1}),B("div",Xe,[B("p",{style:{"white-space":"pre-wrap"},innerHTML:F(c)},null,8,Ze)]),V(L,{class:"mt-4 mb-2 mx-4",style:{opacity:"1"},color:"#EBEBF7"}),V(o,{class:"mb-0 mx-2",style:{"font-weight":"bold"}},{default:C((()=>[S(j(e.$t("LMAppDetail.AboutTheApp")),1)])),_:1}),B("div",el,[B("p",{ref_key:"visibleText",ref:s,innerHTML:e.lmAppData.desc},null,8,ll)]),B("div",al,[F(n)?(R(),O(m,{key:0,class:"mr-4",variant:"text",size:"small",active:!0,onClick:i[0]||(i[0]=e=>l.value=!0),"prepend-icon":"mdi-unfold-more-horizontal",text:e.$t("LMAppDetail.More")},null,8,["text"])):U("",!0)])])),_:1})])),_:1}),V(a,{"min-width":"1000px","max-width":"1300px","max-height":"80%",modelValue:F(l),"onUpdate:modelValue":i[2]||(i[2]=e=>N(l)?l.value=e:null),width:"auto"},{default:C((()=>[V(t,{"prepend-icon":"mdi-text-box-outline",title:e.lmAppData.name},{actions:C((()=>[V(m,{class:"ms-auto",text:e.$t("LMAppDetail.Close"),onClick:i[1]||(i[1]=e=>l.value=!1)},null,8,["text"])])),default:C((()=>[V(u,{class:"mx-6 my-2 fullDescBlock"},{default:C((()=>[B("p",{innerHTML:e.lmAppData.desc},null,8,tl)])),_:1})])),_:1},8,["title"])])),_:1},8,["modelValue"])],64))}}),nl=k({__name:"model-download-btn",props:{lmAppData:{}},setup(e){const l=M(""),a=M(!1),t=M(!1),s=ye(),n=e;H((()=>{De.appIsOllama(n.lmAppData.installName)&&(a.value=!0,l.value=n.lmAppData.name)}));const i=()=>{const e=s.instancesForApp;e&&e.length>0?g():u()},u=()=>{t.value=!0},c=()=>{t.value=!1},d=()=>{c()},m=()=>{c(),setTimeout((()=>{f()}),500)},f=()=>{s.installAppTrigger()},g=()=>{const e=s.instancesForApp;e&&e.length>0&&Z.openAppRunningWindow(e[0].id,Q.DOWNLOAD_MODEL,n.lmAppData.installName)};return(e,s)=>{const n=Le;return R(),I(T,null,[F(a)?(R(),O(p,{key:0,class:"model-download-btn mt-10",onClick:i},{default:C((()=>[V(o,null,{default:C((()=>[S(j(e.$t("LMAppDetail.ModelDownloadTitle")),1)])),_:1}),V(r,null,{default:C((()=>[S(j(e.$t("LMAppDetail.ModelDownloadSubtitle",{appName:F(l)}))+" > ",1)])),_:1})])),_:1})):U("",!0),V(n,{modelValue:F(t),"onUpdate:modelValue":s[0]||(s[0]=e=>N(t)?t.value=e:null),title:e.$t("LMAppDetail.InstallAppDialogTitle"),title2:e.$t("LMAppDetail.InstallAppDialogTitle2"),message:e.$t("LMAppDetail.InstallAppDialogMsg",{appName:F(l)}),"cancel-btn-label":e.$t("LMAppDetail.Cancel"),"confirm-btn-label":e.$t("LMAppDetail.install"),onConfirm:m,onCancel:d},null,8,["modelValue","title","title2","message","cancel-btn-label","confirm-btn-label"])],64)}}}),il={style:{"font-size":"20px"}},ol={class:"mt-4"},pl={style:{"font-size":"1.25rem","font-weight":"bold"}},rl=k({__name:"AppDetail",setup(e){const l=q(),a=Ae(),t=M({}),s=K(),n=de();H((async()=>{i()}));const i=async()=>{const e=l.params.id;await a.fetchApp(e),t.value=a.currentLmApp};w((()=>n.currentLocale),i);const o=()=>{s.go(-1)};return(e,l)=>(R(),I(T,null,[V(b,{elevation:"0",class:"window-drag",height:"80"},{prepend:C((()=>[V(m,{class:"window-no-drag mt-4",onClick:o,variant:"plain"},{default:C((()=>[V(v,{class:"lmd-back-icon mr-3",style:{"font-size":"1.4rem"},size:"36",icon:"mdi-chevron-left",color:"#FB6C00"}),B("span",il,j(e.$t("LMAppDetail.goBack")),1)])),_:1})])),append:C((()=>[B("div",ol,[V(me)])])),_:1}),V(x,{class:"px-0 py-0",style:{"max-width":"none"}},{default:C((()=>[V(h,{class:"app-detail mt-0 mb-4 mx-6"},{default:C((()=>[V(_,{cols:"12",md:"8",lg:"9"},{default:C((()=>[V(Ce,{lmAppData:F(t)},null,8,["lmAppData"]),F(t).snapshots?(R(),O(ve,{key:0,snapshots:F(t).snapshots},null,8,["snapshots"])):U("",!0),V(d,{class:"mb-1"}),V(sl,{"lm-app-data":F(t)},null,8,["lm-app-data"]),V(Ke,{lmAppData:F(t)},null,8,["lmAppData"])])),_:1}),V(_,{class:"app-detail-container-sidebar px-4",cols:"12",md:"4",lg:"3"},{default:C((()=>[B("div",pl,j(e.$t("LMAppDetail.InstallRecord")),1),F(t).id?(R(),O(Je,{key:0,lmAppData:F(t)},null,8,["lmAppData"])):U("",!0),F(t).id?(R(),O(nl,{key:1,lmAppData:F(t)},null,8,["lmAppData"])):U("",!0)])),_:1})])),_:1})])),_:1})],64))}});export{rl as default};
