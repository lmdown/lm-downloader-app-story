import{v as U,a as B,d as v,r as g,x as O,e as r,F as y,g as t,y as G,w as l,f as w,z as H,B as V,k,i as n,c as D,C as P,b as f,u as m,t as p,D as E,E as j,m as I,p as d,G as M,H as A,I as q,n as b,q as R,_ as J,J as K,K as F,o as C,L as x,V as S,M as Q,N as W,O as X,P as Y,Q as Z,R as ee,s as te,S as se}from"./index.js";import"./index2.js";import{c as ae}from"./_commonjsHelpers.js";import{A as le}from"./AppScriptType.js";import{A as ne,_ as oe}from"./single-installed-instance.vue_vue_type_style_index_0_lang.js";import{u as pe}from"./lmapp.js";import{_ as ie}from"./top-right-controls.vue_vue_type_style_index_0_lang.js";import"./IPCChannelName.js";const N=U("installedInstance",{state:()=>({instancesForApp:[],instanceForRunning:{}}),actions:{async getInstalledInstanceForApp(h){try{const s=await B.get(`/self-manage/installed-instance/app/${h}`);this.instancesForApp=s.data}catch(s){console.error("Failed to fetch app:",s)}},async getInstalledInstanceForRunning(h){try{const s=await B.get(`/self-manage/installed-instance/${h}`);this.instanceForRunning=s.data}catch(s){console.error("Failed to fetch app:",s)}}}}),re=v({__name:"app-snapshot-slide",props:{snapshots:{}},setup(h){const s=g(!1),a=g(""),e=g(0),c=h;O(e,o=>{o===void 0&&(o=0);const i=c.snapshots[o];_(i)});const _=o=>{o!==null&&(s.value=!0,a.value=o)};return(o,i)=>(n(),r(y,null,[t(G,{"show-arrows":"",class:"pa-0 snapshots-slider-group",style:{"margin-left":"0rem","margin-right":"0"},"selected-class":"bg-success",modelValue:e.value,"onUpdate:modelValue":i[0]||(i[0]=u=>e.value=u)},{default:l(()=>[(n(!0),r(y,null,w(o.snapshots,(u,L)=>(n(),D(P,{key:L},{default:l(({isSelected:T,toggle:$,selectedClass:Ue})=>[t(V,{class:"my-3 ma-4",width:"265",height:"160",onClick:$},{default:l(()=>[t(k,{cover:"",width:"100%",height:"100%",src:u},null,8,["src"])]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1},8,["modelValue"]),t(H,{class:"mx-10 my-16",modelValue:s.value,"onUpdate:modelValue":i[1]||(i[1]=u=>s.value=u),width:"auto","min-width":"1200px","max-width":"1800px"},{default:l(()=>[t(V,null,{default:l(()=>[t(k,{src:a.value},null,8,["src"])]),_:1})]),_:1},8,["modelValue"])],64))}}),ce={key:0,class:""},ue={key:1,class:""},me=v({__name:"simple-install-btn",setup(h){const s=N();return(a,e)=>(n(),D(E,null,{default:l(()=>[m(s).instancesForApp&&m(s).instancesForApp.length>0?(n(),r("span",ce,p(a.$t("LMAppDetail.AppInstalled")),1)):f("",!0),m(s).instancesForApp&&m(s).instancesForApp.length==0?(n(),r("span",ue,p(a.$t("LMAppDetail.notInstalled")),1)):f("",!0)]),_:1}))}}),de={style:{flex:"1"}},fe={key:0,class:"d-flex ga-3 mx-4"},he=v({__name:"basic-info-and-tags",props:{lmAppData:{}},setup(h){const s=h;return j(()=>{if(!s.lmAppData.installLimit)return[];const a=s.lmAppData.installLimit.os,e=s.lmAppData.installLimit.hardware;return[...a,...e]}),(a,e)=>(n(),r(y,null,[t(I,{class:"mt-1 mx-1"},{default:l(()=>[d("div",null,[t(k,{src:a.lmAppData.icon,width:"7.5rem",height:"7.5rem",style:{"border-radius":"8px"}},null,8,["src"])]),d("div",de,[t(M,{class:"",style:{"font-size":"1.375rem","font-weight":"bold"}},{default:l(()=>[A(p(a.lmAppData.name),1)]),_:1}),t(q,{class:"",style:{"font-size":"1rem",color:"#111",opacity:"1"}},{default:l(()=>[A(p(a.lmAppData.shortDesc),1)]),_:1}),t(me)])]),_:1}),t(I,null,{default:l(()=>[t(b,null,{default:l(()=>[t(R,{class:"mt-2 mb-3 mx-4",style:{opacity:"1"},color:"#EBEBF7"}),t(M,{"primary-title":"",style:{"font-weight":"bold"}},{default:l(()=>[A(p(a.$t("LMAppDetail.AppFeatures")),1)]),_:1}),a.lmAppData.tags?(n(),r("div",fe,[(n(!0),r(y,null,w(a.lmAppData.tags,(c,_)=>(n(),r("div",{class:"app-feature-tag px-4",key:_},p(c),1))),128))])):f("",!0),t(R,{class:"mt-6 mb-2 mx-4",style:{opacity:"1"},color:"#EBEBF7"})]),_:1})]),_:1})],64))}}),_e=J(he,[["__scopeId","data-v-14c8ebc5"]]),Ae={class:"text-medium-emphasis mr-2"},De=["href"],ye={key:1},ge={class:"text-medium-emphasis mr-2"},ve={key:2},Ie={class:"text-medium-emphasis mr-2"},Le={key:3},ke={class:"text-medium-emphasis mr-2"},be={key:4},we={class:"text-medium-emphasis mr-2"},$e={key:5},Ve={class:"text-medium-emphasis mr-2"},Me={key:6},Fe={class:"text-medium-emphasis mr-2"},xe={key:7},Ce={class:"text-medium-emphasis mr-2"},Se=v({__name:"extra-info",props:{lmAppData:{}},setup(h){const{t:s}=K(),a=e=>{let c=s("LMAppDetail.refLinkOther");return e.type==="homepage"?c=s("LMAppDetail.refLinkHomePage"):e.type==="github"&&(c=s("LMAppDetail.refLinkGithub")),c};return(e,c)=>(n(),D(F,{class:"mx-3 extra-info mt-3 mb-2"},{default:l(()=>[e.lmAppData.refLinks&&e.lmAppData.refLinks.length>0?(n(!0),r(y,{key:0},w(e.lmAppData.refLinks,(_,o)=>(n(),r("p",{key:o},[d("span",Ae,p(a(_)),1),d("a",{href:_.url,target:"_blank"},p(_.url),9,De)]))),128)):f("",!0),e.lmAppData?.newVersion?(n(),r("p",ye,[d("span",ge,p(e.$t("LMAppDetail.newVersion")),1),A(" "+p(e.lmAppData.newVersion),1)])):f("",!0),e.lmAppData?.releaseTime?(n(),r("p",ve,[d("span",Ie,p(e.$t("LMAppDetail.releaseTime")),1),A(" "+p(e.lmAppData.releaseTime),1)])):f("",!0),e.lmAppData?.licenseInfo?.licenseType?(n(),r("p",Le,[d("span",ke,p(e.$t("LMAppDetail.licenseType")),1),A(" "+p(e.lmAppData?.licenseInfo?.licenseType),1)])):f("",!0),e.lmAppData?.licenseInfo?.isOpenSource?(n(),r("p",be,[d("span",we,p(e.$t("LMAppDetail.isOpenSource")),1),A(" "+p(e.lmAppData?.licenseInfo?.isOpenSource),1)])):f("",!0),e.lmAppData?.licenseInfo?.isFullOpenSource?(n(),r("p",$e,[d("span",Ve,p(e.$t("LMAppDetail.isFullOpenSource")),1),A(" "+p(e.lmAppData?.licenseInfo?.isFullOpenSource),1)])):f("",!0),e.lmAppData?.licenseInfo?.isFree?(n(),r("p",Me,[d("span",Fe,p(e.$t("LMAppDetail.isFree")),1),A(" "+p(e.lmAppData?.licenseInfo?.isFree),1)])):f("",!0),e.lmAppData?.licenseInfo?.sourceCodeRepo?(n(),r("p",xe,[d("span",Ce,p(e.$t("LMAppDetail.sourceCodeRepo")),1),A(" "+p(e.lmAppData?.licenseInfo?.sourceCodeRepo),1)])):f("",!0)]),_:1}))}}),Te={style:{"font-size":"14px",color:"#7D7D7D"},class:"text-center"},Be=v({__name:"installed-info-list",props:{lmAppData:{}},setup(h){const s=N(),a=g(),e=h;C(async()=>{c()});const c=async()=>{await s.getInstalledInstanceForApp(e.lmAppData?.id),a.value=s.instancesForApp},_=async()=>{try{if(await ae(e.lmAppData),await c(),a.value){const u=a.value[0];if(u){const L=u.id;ne.openAppRunningWindow(L,le.INSTALL)}else console.error("data err firstInstallInstance",u)}}catch(u){console.error("install app err ",u)}},o=async()=>{c()},i=async()=>{c()};return(u,L)=>(n(),r(y,null,[t(x,{class:"my-2"}),m(a)&&m(a).length>0?(n(),D(F,{key:0,class:"d-flex flex-column ga-2",style:{width:"100%"}},{default:l(()=>[t(I,null,{default:l(()=>[(n(!0),r(y,null,w(m(a),(T,$)=>(n(),D(b,{key:$},{default:l(()=>[t(oe,{"app-version-visible":!0,"instance-data":T,onDeleted:o,onRefresh:i,"app-name-visible":!0,"icon-visible":!1},null,8,["instance-data"])]),_:2},1024))),128))]),_:1})]),_:1})):f("",!0),m(a)&&m(a).length===0?(n(),D(F,{key:1,class:"d-flex flex-column ga-2 text-center justify-center"},{default:l(()=>[t(k,{width:"100%",height:"171",src:"./images/app/no-data.png"}),d("div",Te,p(u.$t("LMAppDetail.notInstalled")),1),t(x),t(S,{color:"primary",variant:"flat",onClick:_},{default:l(()=>[A(p(u.$t("LMAppDetail.install")),1)]),_:1})]),_:1})):f("",!0)],64))}}),Re={class:"fullDescBlock overflow-y-hidden mx-6 mt-1 mb-4"},ze=["innerHTML"],Oe=["innerHTML"],z=200,He=v({__name:"full-desc-text",props:{lmAppData:{}},setup(h){const s=g(!1),a=g(null),e=g(!1);let c;C(()=>{c=new ResizeObserver(o=>{for(const i of o)i.target===a.value&&(e.value=i.contentRect.height>=z)}),a.value&&c.observe(a.value),_()}),Q(()=>{c&&c.unobserve(a.value)});function _(){a.value&&(e.value=a.value.scrollHeight>=z)}return(o,i)=>(n(),r(y,null,[t(I,null,{default:l(()=>[t(M,{class:"mb-0 mx-2",style:{"font-weight":"bold"}},{default:l(()=>[A(p(o.$t("LMAppDetail.AboutTheApp")),1)]),_:1}),d("div",Re,[d("p",{ref_key:"visibleText",ref:a,innerHTML:o.lmAppData.desc},null,8,ze)]),m(e)?(n(),D(W,{key:0,class:"mr-4",active:!0,onClick:i[0]||(i[0]=u=>s.value=!0),"prepend-icon":"mdi-unfold-more-horizontal",location:"bottom end",extended:"",absolute:"",offset:"",text:o.$t("LMAppDetail.More")},null,8,["text"])):f("",!0)]),_:1}),t(H,{"min-width":"1000px","max-width":"1300px",modelValue:m(s),"onUpdate:modelValue":i[2]||(i[2]=u=>X(s)?s.value=u:null),width:"auto"},{default:l(()=>[t(V,{"prepend-icon":"mdi-text-box-outline",title:o.lmAppData.name},{actions:l(()=>[t(S,{class:"ms-auto",text:o.$t("LMAppDetail.Close"),onClick:i[1]||(i[1]=u=>s.value=!1)},null,8,["text"])]),default:l(()=>[t(E,{class:"mx-6 my-2"},{default:l(()=>[d("p",{innerHTML:o.lmAppData.desc},null,8,Oe)]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])],64))}}),Ee={style:{"font-size":"20px"}},Ne={style:{"font-size":"1.25rem","font-weight":"bold"}},Xe=v({__name:"AppDetail",setup(h){const s=Y(),a=pe(),e=g({}),c=se();O(()=>s.params.id,(o,i)=>{console.log("app detail ",o,i)}),C(async()=>{const o=s.params.id;await a.fetchApp(o),e.value=a.currentLmApp});const _=()=>{c.go(-1)};return(o,i)=>(n(),r(y,null,[t(ee,{elevation:"0",class:"window-drag pt-4"},{prepend:l(()=>[t(S,{class:"window-no-drag",onClick:_,variant:"plain"},{default:l(()=>[t(Z,{class:"lmd-back-icon mr-3",style:{"font-size":"1.4rem"},size:"36",icon:"mdi-chevron-left",color:"#FB6C00"}),d("span",Ee,p(o.$t("LMAppDetail.goBack")),1)]),_:1})]),append:l(()=>[t(ie)]),_:1}),t(te,{class:"px-0 py-0",style:{"max-width":"none"}},{default:l(()=>[t(I,{class:"app-detail my-4 mx-6"},{default:l(()=>[t(b,{cols:"9"},{default:l(()=>[t(_e,{lmAppData:m(e)},null,8,["lmAppData"]),m(e).snapshots?(n(),D(re,{key:0,snapshots:m(e).snapshots},null,8,["snapshots"])):f("",!0),t(x,{class:"mb-4"}),t(He,{"lm-app-data":m(e)},null,8,["lm-app-data"]),t(Se,{lmAppData:m(e)},null,8,["lmAppData"])]),_:1}),t(b,{class:"app-detail-container-sidebar px-4",cols:"3"},{default:l(()=>[d("div",Ne,p(o.$t("LMAppDetail.InstallRecord")),1),m(e).id?(n(),D(Be,{key:0,lmAppData:m(e)},null,8,["lmAppData"])):f("",!0)]),_:1})]),_:1})]),_:1})],64))}});export{Xe as default};
