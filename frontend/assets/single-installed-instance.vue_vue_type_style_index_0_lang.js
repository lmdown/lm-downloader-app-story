import{_ as a}from"./delete-confirm-dialog-with-loading.js";import{e,b as t,c as l,a4 as s,a1 as n,F as i,a0 as o,a6 as r,k as p,a2 as c,S as d,K as m,a3 as u,m as D,V as v,u as f,H as g,a9 as y,a5 as h,j as A}from"./vue.js";import{O as _,d as R,A as M,a as x,b,I as k}from"./OSUtil.js";import{G as C,L as w,q as T,b as V,l as L,d as I,D as S,o as O,n as j,M as U,p as z,J as P,I as $,F as G}from"./vuetify.js";import{_ as H}from"./lmd-system.js";import{D as N}from"./DateTimeUtil.js";import{T as B,r as E,A as K,o as W}from"./index.js";class F{static SCRIPT="script";static DRAG_TO_TRASH="drag_to_trash"}const q=H(e({__name:"app-more-controls",props:{instanceData:{}},emits:["deleted"],setup(e,{emit:g}){const{t:y}=C(),h=t(!1),A=e,k=g,S=t(!1),O=()=>{console.log("onMoreClick")},j=()=>{S.value=!0},U=()=>{const a=A.instanceData.appRemoveMethod;let e="";return e=_.isWindows()?a.windows:a.mac,e},z=l((()=>{let a=y("LocalApps.Delete");return U()===F.DRAG_TO_TRASH&&(a=y("LocalApps.RemoveRecord")),a})),P=l((()=>{let a=y("LocalApps.RemoveTip");A.instanceData?.instancesCountOfApp>1&&(a=y("LocalApps.RemoveTipKeepModel"));let e=a;return U()===F.DRAG_TO_TRASH&&(e=y("LocalApps.ManualRemoveTip")+a),e})),$=async()=>{try{h.value=!0,U()===F.DRAG_TO_TRASH?await R(A.instanceData.id):(M.openAppRunningWindow(A.instanceData.id,x.REMOVE,A.instanceData.installName),await b(A.instanceData.id))}catch(a){console.log(a)}finally{h.value=!1,S.value=!1}k("deleted")};return(e,t)=>{const l=a;return n(),s(i,null,[e.instanceData?.id&&e.instanceData.appRemoveMethod?(n(),o(w,{key:0,location:"bottom",transition:"slide-y-transition"},{activator:c((({props:a})=>[u("div",D({onClick:v(O,["stop"])},a,{class:"more-controls-icon"}),[p(I,{icon:"mdi-dots-horizontal"})],16)])),default:c((()=>[p(L,{style:{"border-radius":"8px"},elevation:"2"},{default:c((()=>[p(T,{onClick:j,size:"large",class:"pr-7",transition:""},{default:c((()=>[p(V,{src:"./images/my-ai/del.svg",width:"32",height:"32","max-width":"32","max-height":"32"}),d(" "+m(e.$t("StorageDialog.Delete")),1)])),_:1})])),_:1})])),_:1})):r("",!0),p(l,{"waiting-delete-result":!0,"in-progress":f(h),"model-value":f(S),"onUpdate:modelValue":t[0]||(t[0]=a=>S.value=a),"extra-tip":f(P),"remvoe-btn-label":f(z),itemName:e.instanceData.name,onConfirm:$},null,8,["in-progress","model-value","extra-tip","remvoe-btn-label","itemName"])],64)}}}),[["__scopeId","data-v-eb809fdb"]]),J={style:{flex:"1",overflow:"hidden"}},Y={class:"small-title-for-version"},Q={class:"app-info-item align-center"},X={class:"mx-1"},Z={style:{flex:"1"},class:"text-left mx-1"},aa={class:"app-info-item align-center"},ea={class:"mx-1"},ta={key:3,class:"app-info-item flex-column"},la=e({__name:"single-installed-instance",props:{appNameVisible:{type:Boolean},iconVisible:{type:Boolean},appVersionVisible:{type:Boolean},appIconUrl:{},cardColorStyleClass:{},instanceData:{},showMoreControls:{type:Boolean},lmAppData:{}},emits:["deleted"],setup(a,{emit:e}){const{t:_}=C(),R=a,b=t(""),w=t(void 0),T=e,I=()=>{"instance-card-gray"===R.cardColorStyleClass&&(b.value="instance-card-gray-hover")},H=()=>{b.value=""};g((()=>{const a=R.lmAppData?.modules;a&&a.length>0&&(w.value=a[0].module)}));const F=()=>{console.log("gotoDetailPage",R.instanceData.appId);E.currentRoute.value.name!==K.AppDetail&&E.push({name:K.AppDetail,params:{id:R.instanceData.appId}})},la=()=>{T("deleted")},sa=()=>{R.instanceData.appInstallPath&&W(R.instanceData.appInstallPath)},na=l((()=>"docker"===R.instanceData.installMethod?_("LMAppDetail.DockerMode"):_("LMAppDetail.DefaultMode"))),ia=l((()=>"docker"===R.instanceData.installMethod?"Docker":"")),oa=()=>{let a=R.cardColorStyleClass||"instance-card-default";return R.instanceData?.installMethod===k.DOCKER?a+=" install-docker":a+=" install-default",a};return(a,e)=>{const t=q;return a.instanceData?(n(),o(L,{key:0,class:y(["single-instance-card","rounded-lg",oa(),f(b)])},{default:c((()=>[a.showMoreControls?(n(),o(t,{key:0,"instance-data":a.instanceData,onDeleted:la},null,8,["instance-data"])):r("",!0),a.iconVisible&&a.appIconUrl?(n(),o(S,{key:1,style:{display:"flex"}},{default:c((()=>[u("div",null,[p(V,{width:"68",height:"68",cover:"",style:{"border-radius":"8px",cursor:"pointer"},onClick:F,alt:a.instanceData.name,src:a.appIconUrl},null,8,["alt","src"])]),u("div",J,[a.appNameVisible?(n(),o(O,{key:0,onClick:F,style:{"font-size":"1.125rem","font-weight":"bold",color:"rgba(0,0,0,0.75)","padding-right":"0px"}},{default:c((()=>[d(m(a.instanceData.name)+" ",1),p(j,{"open-delay":"900",activator:"parent",location:"bottom",transition:"false"},{default:c((()=>[d(m(a.instanceData.name),1)])),_:1})])),_:1})):r("",!0),p(z,{class:"pr-0",style:{opacity:"0.70"}},{default:c((()=>[d(m(a.$t("LMAppDetail.version"))+" "+m(a.instanceData.version)+" Â  ",1),f(ia)?(n(),o(U,{key:0,density:"compact",variant:"flat",size:"small",color:"#086dd7",class:"pa-1"},{default:c((()=>[d(m(f(ia)),1)])),_:1})):r("",!0)])),_:1})])])),_:1})):r("",!0),a.appVersionVisible?(n(),s(i,{key:2},[e[2]||(e[2]=u("div",{style:{height:"8px"},class:"mt-1"},null,-1)),u("div",Y,m(f(na)),1)],64)):r("",!0),u("div",Q,[p(j,{text:a.$t("LMAppDetail.installedAt"),location:"top"},{activator:c((({props:a})=>[u("div",X,[p(V,D({width:"1.8rem",height:"1.8rem"},a,{src:"./images/app/install-time-gray.svg"}),null,16)])])),_:1},8,["text"]),u("div",Z,m(f(N).format(a.instanceData.createTime)),1)]),u("div",aa,[u("div",ea,[p(V,{width:"1.8rem",height:"1.8rem",src:"./images/app/model-dir-gray.svg"})]),u("a",{href:"#",style:{flex:"1"},class:"text-left mx-1",onClick:v(sa,["prevent"])},[d(m(a.$t("LMAppDetail.appDirectory"))+" > ",1),p(j,{activator:"parent",location:"top"},{default:c((()=>[d(m(a.instanceData.appInstallPath),1)])),_:1})])]),a.lmAppData&&a.lmAppData?.modules?.length>0?(n(),s("div",ta,[p(O,{style:{"font-size":"16px"},class:"mt-2"},{default:c((()=>[d(m(a.$t("LMAppDetail.SelectModule")),1)])),_:1}),p($,{modelValue:f(w),"onUpdate:modelValue":e[0]||(e[0]=a=>A(w)?w.value=a:null),class:"ml-1",style:{"font-size":"14px"},"hide-details":""},{default:c((()=>[(n(!0),s(i,null,h(a.lmAppData?.modules,(a=>(n(),o(P,{key:a.module,value:a.module,color:f(B).PRIMARY_COLOR},{label:c((()=>[d(m(a.label),1)])),_:2},1032,["value","color"])))),128))])),_:1},8,["modelValue"])])):r("",!0),p(G,{class:"mt-6"}),u("a",{href:"#",variant:"flat",class:y(["control-btn",R.instanceData?.installMethod===k.DOCKER?"install-docker":"install-default"]),onClick:e[1]||(e[1]=v((e=>{return t=a.instanceData,void M.openRunningWinV2(t,x.START,w.value);var t}),["prevent"])),onMouseenter:I,onMouseleave:H},m(a.$t("LMAppDetail.RunApp")),35)])),_:1},8,["class"])):r("",!0)}}});export{la as _};
