import{z as a,A as e,o as t,l,b as s,D as n,E as o,q as i,G as p,L as r,d,n as c,M as m,p as u,J as f,I as v,F as D}from"./vuetify.js";import{e as g,b as y,l as h,$ as _,a0 as A,u as x,j as R,a1 as b,k,S as C,K as M,a2 as w,a3 as T,a5 as V,c as L,F as I,m as S,Y as O,H as B,a8 as $,a4 as j}from"./vue.js";import{_ as z}from"./lmd-system.js";import{O as P,d as U,A as E,a as F}from"./OSUtil.js";import{A as N,I as G}from"./InstallType.js";import{D as H}from"./DateTimeUtil.js";import{T as W,r as K,A as Y,o as q}from"./index.js";const J={style:{"font-size":"20px","font-weight":"bold",color:"#F2313F"}},Q={key:0,style:{"font-size":"16px"},class:"mt-2"},X=z(g({__name:"delete-confirm-dialog-with-loading",props:{modelValue:{type:Boolean},itemName:{},extraTip:{},waitingDeleteResult:{type:Boolean},inProgress:{type:Boolean},remvoeBtnLabel:{}},emits:["update:modelValue","confirm"],setup(p,{emit:r}){const d=p,c=r,m=y(!1);h((()=>m.value),(a=>{c("update:modelValue",a)})),h((()=>d.modelValue),(a=>{m.value=a}));const u=()=>{m.value=!1},f=async()=>{c("confirm"),d.waitingDeleteResult||u()};return(p,r)=>(A(),_(a,{modelValue:x(m),"onUpdate:modelValue":r[0]||(r[0]=a=>R(m)?m.value=a:null),"max-width":"660"},{default:b((()=>[k(e,null,{default:b((()=>[k(t,{class:"headline"},{default:b((()=>[C(M(p.$t("AppRunningWindow.ConfirmDelete")),1)])),_:1}),k(l,{class:"d-flex flex-row px-10",style:{"padding-bottom":"60px","padding-top":"60px"}},{default:b((()=>[w("div",null,[k(s,{src:"./images/my-ai/del-tip.svg",width:"164",height:"120"})]),k(l,{style:{flex:"1"}},{default:b((()=>[k(n,null,{default:b((()=>[w("div",J,M(p.itemName)+" "+M(p.$t("LocalApps.ConfirmDeleteTip")),1),p.extraTip?(A(),T("div",Q,M(p.extraTip),1)):V("",!0)])),_:1})])),_:1})])),_:1}),k(o,{class:"justify-center mb-2 pt-3",style:{"border-top":"1px solid #EBEBF7"}},{default:b((()=>[k(i,{variant:"outlined",onClick:u},{default:b((()=>[C(M(p.$t("AppRunningWindow.Cancel")),1)])),_:1}),k(i,{variant:"flat",color:"#F2313F",onClick:f,loading:p.inProgress},{default:b((()=>[C(M(p.remvoeBtnLabel||p.$t("LocalApps.Delete")),1)])),_:1},8,["loading"])])),_:1})])),_:1})])),_:1},8,["modelValue"]))}}),[["__scopeId","data-v-a5960fb1"]]);class Z{static SCRIPT="script";static DRAG_TO_TRASH="drag_to_trash"}const aa=z(g({__name:"app-more-controls",props:{instanceData:{}},emits:["deleted"],setup(a,{emit:e}){const{t:t}=p(),n=y(!1),o=a,c=e,m=y(!1),u=()=>{console.log("onMoreClick")},f=()=>{m.value=!0},v=()=>{const a=o.instanceData.appRemoveMethod;let e="";return e=P.isWindows()?a.windows:a.mac,e},D=L((()=>{let a=t("LocalApps.Delete");return v()===Z.DRAG_TO_TRASH&&(a=t("LocalApps.RemoveRecord")),a})),g=L((()=>{let a=t("LocalApps.RemoveTip");o.instanceData?.instancesCountOfApp>1&&(a=t("LocalApps.RemoveTipKeepModel"));let e=a;return v()===Z.DRAG_TO_TRASH&&(e=t("LocalApps.ManualRemoveTip")+a),e})),h=async()=>{try{n.value=!0,v()===Z.DRAG_TO_TRASH?await U(o.instanceData.id):(N.openAppRunningWindow(o.instanceData.id,E.REMOVE,o.instanceData.installName),await F(o.instanceData.id))}catch(a){console.log(a)}finally{n.value=!1,m.value=!1}c("deleted")};return(a,e)=>{const t=X;return A(),T(I,null,[a.instanceData?.id&&a.instanceData.appRemoveMethod?(A(),_(r,{key:0,location:"bottom",transition:"slide-y-transition"},{activator:b((({props:a})=>[w("div",S({onClick:O(u,["stop"])},a,{class:"more-controls-icon"}),[k(d,{icon:"mdi-dots-horizontal"})],16)])),default:b((()=>[k(l,{style:{"border-radius":"8px"},elevation:"2"},{default:b((()=>[k(i,{onClick:f,size:"large",class:"pr-7",transition:""},{default:b((()=>[k(s,{src:"./images/my-ai/del.svg",width:"32",height:"32","max-width":"32","max-height":"32"}),C(" "+M(a.$t("StorageDialog.Delete")),1)])),_:1})])),_:1})])),_:1})):V("",!0),k(t,{"waiting-delete-result":!0,"in-progress":x(n),"model-value":x(m),"onUpdate:modelValue":e[0]||(e[0]=a=>m.value=a),"extra-tip":x(g),"remvoe-btn-label":x(D),itemName:a.instanceData.name,onConfirm:h},null,8,["in-progress","model-value","extra-tip","remvoe-btn-label","itemName"])],64)}}}),[["__scopeId","data-v-eb809fdb"]]),ea={style:{flex:"1",overflow:"hidden"}},ta={class:"small-title-for-version"},la={class:"app-info-item align-center"},sa={class:"mx-1"},na={style:{flex:"1"},class:"text-left mx-1"},oa={class:"app-info-item align-center"},ia={class:"mx-1"},pa={key:3,class:"app-info-item flex-column"},ra=g({__name:"single-installed-instance",props:{appNameVisible:{type:Boolean},iconVisible:{type:Boolean},appVersionVisible:{type:Boolean},appIconUrl:{},cardColorStyleClass:{},instanceData:{},showMoreControls:{type:Boolean},lmAppData:{}},emits:["deleted"],setup(a,{emit:e}){const{t:o}=p(),i=a,r=y(""),d=y(void 0),g=e,h=()=>{"instance-card-gray"===i.cardColorStyleClass&&(r.value="instance-card-gray-hover")},z=()=>{r.value=""};B((()=>{const a=i.lmAppData?.modules;a&&a.length>0&&(d.value=a[0].module)}));const P=()=>{console.log("gotoDetailPage",i.instanceData.appId);K.currentRoute.value.name!==Y.AppDetail&&K.push({name:Y.AppDetail,params:{id:i.instanceData.appId}})},U=()=>{g("deleted")},F=()=>{i.instanceData.appInstallPath&&q(i.instanceData.appInstallPath)},J=L((()=>"docker"===i.instanceData.installMethod?o("LMAppDetail.DockerMode"):o("LMAppDetail.DefaultMode"))),Q=L((()=>"docker"===i.instanceData.installMethod?"Docker":"")),X=()=>{let a=i.cardColorStyleClass||"instance-card-default";return i.instanceData?.installMethod===G.DOCKER?a+=" install-docker":a+=" install-default",a};return(a,e)=>{const o=aa;return a.instanceData?(A(),_(l,{key:0,class:$(["single-instance-card","rounded-lg",X(),x(r)])},{default:b((()=>[a.showMoreControls?(A(),_(o,{key:0,"instance-data":a.instanceData,onDeleted:U},null,8,["instance-data"])):V("",!0),a.iconVisible&&a.appIconUrl?(A(),_(n,{key:1,style:{display:"flex"}},{default:b((()=>[w("div",null,[k(s,{width:"68",height:"68",cover:"",style:{"border-radius":"8px",cursor:"pointer"},onClick:P,alt:a.instanceData.name,src:a.appIconUrl},null,8,["alt","src"])]),w("div",ea,[a.appNameVisible?(A(),_(t,{key:0,onClick:P,style:{"font-size":"1.125rem","font-weight":"bold",color:"rgba(0,0,0,0.75)","padding-right":"0px"}},{default:b((()=>[C(M(a.instanceData.name)+" ",1),k(c,{"open-delay":"900",activator:"parent",location:"bottom",transition:"false"},{default:b((()=>[C(M(a.instanceData.name),1)])),_:1})])),_:1})):V("",!0),k(u,{class:"pr-0",style:{opacity:"0.70"}},{default:b((()=>[C(M(a.$t("LMAppDetail.version"))+" "+M(a.instanceData.version)+" Â  ",1),x(Q)?(A(),_(m,{key:0,density:"compact",variant:"flat",size:"small",color:"#086dd7",class:"pa-1"},{default:b((()=>[C(M(x(Q)),1)])),_:1})):V("",!0)])),_:1})])])),_:1})):V("",!0),a.appVersionVisible?(A(),T(I,{key:2},[e[2]||(e[2]=w("div",{style:{height:"8px"},class:"mt-1"},null,-1)),w("div",ta,M(x(J)),1)],64)):V("",!0),w("div",la,[k(c,{text:a.$t("LMAppDetail.installedAt"),location:"top"},{activator:b((({props:a})=>[w("div",sa,[k(s,S({width:"1.8rem",height:"1.8rem"},a,{src:"./images/app/install-time-gray.svg"}),null,16)])])),_:1},8,["text"]),w("div",na,M(x(H).format(a.instanceData.createTime)),1)]),w("div",oa,[w("div",ia,[k(s,{width:"1.8rem",height:"1.8rem",src:"./images/app/model-dir-gray.svg"})]),w("a",{href:"#",style:{flex:"1"},class:"text-left mx-1",onClick:O(F,["prevent"])},[C(M(a.$t("LMAppDetail.appDirectory"))+" > ",1),k(c,{activator:"parent",location:"top"},{default:b((()=>[C(M(a.instanceData.appInstallPath),1)])),_:1})])]),a.lmAppData&&a.lmAppData?.modules?.length>0?(A(),T("div",pa,[k(t,{style:{"font-size":"16px"},class:"mt-2"},{default:b((()=>[C(M(a.$t("LMAppDetail.SelectModule")),1)])),_:1}),k(v,{modelValue:x(d),"onUpdate:modelValue":e[0]||(e[0]=a=>R(d)?d.value=a:null),class:"ml-1",style:{"font-size":"14px"},"hide-details":""},{default:b((()=>[(A(!0),T(I,null,j(a.lmAppData?.modules,(a=>(A(),_(f,{key:a.module,value:a.module,color:x(W).PRIMARY_COLOR},{label:b((()=>[C(M(a.label),1)])),_:2},1032,["value","color"])))),128))])),_:1},8,["modelValue"])])):V("",!0),k(D,{class:"mt-6"}),w("a",{href:"#",variant:"flat",class:$(["control-btn",i.instanceData?.installMethod===G.DOCKER?"install-docker":"install-default"]),onClick:e[1]||(e[1]=O((e=>{return t=a.instanceData,void N.openRunningWinV2(t,E.START,d.value);var t}),["prevent"])),onMouseenter:h,onMouseleave:z},M(a.$t("LMAppDetail.RunApp")),35)])),_:1},8,["class"])):V("",!0)}}});export{ra as _};
