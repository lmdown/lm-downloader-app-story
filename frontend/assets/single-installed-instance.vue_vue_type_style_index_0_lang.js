import{z as a,A as e,o as t,l,b as s,D as n,E as i,q as o,G as r,L as p,d as c,n as d,M as m,p as u,F as f}from"./vuetify.js";import{e as v,b as D,l as g,$ as y,a0 as h,u as _,j as x,a1 as A,k as b,S as R,K as w,a2 as C,a3 as k,a5 as M,c as T,F as V,m as L,Y as I,a8 as S}from"./vue.js";import{_ as B}from"./lmd-system.js";import{O,d as $,A as j,a as N}from"./OSUtil.js";import{A as z,I as E}from"./InstallType.js";import{D as F}from"./DateTimeUtil.js";import{r as P,A as U,o as G}from"./index.js";const W={style:{"font-size":"20px","font-weight":"bold",color:"#F2313F"}},H={key:0,style:{"font-size":"16px"},class:"mt-2"},K=B(v({__name:"delete-confirm-dialog-with-loading",props:{modelValue:{type:Boolean},itemName:{},extraTip:{},waitingDeleteResult:{type:Boolean},inProgress:{type:Boolean},remvoeBtnLabel:{}},emits:["update:modelValue","confirm"],setup(r,{emit:p}){const c=r,d=p,m=D(!1);g((()=>m.value),(a=>{d("update:modelValue",a)})),g((()=>c.modelValue),(a=>{m.value=a}));const u=()=>{m.value=!1},f=async()=>{d("confirm"),c.waitingDeleteResult||u()};return(r,p)=>(h(),y(a,{modelValue:_(m),"onUpdate:modelValue":p[0]||(p[0]=a=>x(m)?m.value=a:null),"max-width":"660"},{default:A((()=>[b(e,null,{default:A((()=>[b(t,{class:"headline"},{default:A((()=>[R(w(r.$t("AppRunningWindow.ConfirmDelete")),1)])),_:1}),b(l,{class:"d-flex flex-row px-10",style:{"padding-bottom":"60px","padding-top":"60px"}},{default:A((()=>[C("div",null,[b(s,{src:"./images/my-ai/del-tip.svg",width:"164",height:"120"})]),b(l,{style:{flex:"1"}},{default:A((()=>[b(n,null,{default:A((()=>[C("div",W,w(r.itemName)+" "+w(r.$t("LocalApps.ConfirmDeleteTip")),1),r.extraTip?(h(),k("div",H,w(r.extraTip),1)):M("",!0)])),_:1})])),_:1})])),_:1}),b(i,{class:"justify-center mb-2 pt-3",style:{"border-top":"1px solid #EBEBF7"}},{default:A((()=>[b(o,{variant:"outlined",onClick:u},{default:A((()=>[R(w(r.$t("AppRunningWindow.Cancel")),1)])),_:1}),b(o,{variant:"flat",color:"#F2313F",onClick:f,loading:r.inProgress},{default:A((()=>[R(w(r.remvoeBtnLabel||r.$t("LocalApps.Delete")),1)])),_:1},8,["loading"])])),_:1})])),_:1})])),_:1},8,["modelValue"]))}}),[["__scopeId","data-v-a5960fb1"]]);class q{static SCRIPT="script";static DRAG_TO_TRASH="drag_to_trash"}const Y=B(v({__name:"app-more-controls",props:{instanceData:{}},emits:["deleted"],setup(a,{emit:e}){const{t:t}=r(),n=D(!1),i=a,d=e,m=D(!1),u=()=>{console.log("onMoreClick")},f=()=>{m.value=!0},v=()=>{const a=i.instanceData.appRemoveMethod;let e="";return e=O.isWindows()?a.windows:a.mac,e},g=T((()=>{let a=t("LocalApps.Delete");return v()===q.DRAG_TO_TRASH&&(a=t("LocalApps.RemoveRecord")),a})),x=T((()=>{let a=t("LocalApps.RemoveTip");i.instanceData?.instancesCountOfApp>1&&(a=t("LocalApps.RemoveTipKeepModel"));let e=a;return v()===q.DRAG_TO_TRASH&&(e=t("LocalApps.ManualRemoveTip")+a),e})),S=async()=>{try{n.value=!0,v()===q.DRAG_TO_TRASH?await $(i.instanceData.id):(z.openAppRunningWindow(i.instanceData.id,j.REMOVE,i.instanceData.installName),await N(i.instanceData.id))}catch(a){console.log(a)}finally{n.value=!1,m.value=!1}d("deleted")};return(a,e)=>{const t=K;return h(),k(V,null,[a.instanceData?.id&&a.instanceData.appRemoveMethod?(h(),y(p,{key:0,location:"bottom",transition:"slide-y-transition"},{activator:A((({props:a})=>[C("div",L({onClick:I(u,["stop"])},a,{class:"more-controls-icon"}),[b(c,{icon:"mdi-dots-horizontal"})],16)])),default:A((()=>[b(l,{style:{"border-radius":"8px"},elevation:"2"},{default:A((()=>[b(o,{onClick:f,size:"large",class:"pr-7",transition:""},{default:A((()=>[b(s,{src:"./images/my-ai/del.svg",width:"32",height:"32","max-width":"32","max-height":"32"}),R(" "+w(a.$t("StorageDialog.Delete")),1)])),_:1})])),_:1})])),_:1})):M("",!0),b(t,{"waiting-delete-result":!0,"in-progress":_(n),"model-value":_(m),"onUpdate:modelValue":e[0]||(e[0]=a=>m.value=a),"extra-tip":_(x),"remvoe-btn-label":_(g),itemName:a.instanceData.name,onConfirm:S},null,8,["in-progress","model-value","extra-tip","remvoe-btn-label","itemName"])],64)}}}),[["__scopeId","data-v-eb809fdb"]]),J={style:{flex:"1",overflow:"hidden"}},Q={class:"small-title-for-version"},X={class:"app-info-item align-center"},Z={class:"mx-1"},aa={style:{flex:"1"},class:"text-left mx-1"},ea={class:"app-info-item align-center"},ta={class:"mx-1"},la=v({__name:"single-installed-instance",props:{appNameVisible:{type:Boolean},iconVisible:{type:Boolean},appVersionVisible:{type:Boolean},appIconUrl:{},cardColorStyleClass:{},instanceData:{},showMoreControls:{type:Boolean}},emits:["deleted"],setup(a,{emit:e}){const{t:i}=r(),o=a,p=D(""),c=e,v=()=>{"instance-card-gray"===o.cardColorStyleClass&&(p.value="instance-card-gray-hover")},g=()=>{p.value=""},x=()=>{console.log("gotoDetailPage",o.instanceData.appId);P.currentRoute.value.name!==U.AppDetail&&P.push({name:U.AppDetail,params:{id:o.instanceData.appId}})},B=()=>{c("deleted")},O=()=>{o.instanceData.appInstallPath&&G(o.instanceData.appInstallPath)},$=T((()=>"docker"===o.instanceData.installMethod?i("LMAppDetail.DockerMode"):i("LMAppDetail.DefaultMode"))),N=T((()=>"docker"===o.instanceData.installMethod?"Docker":"")),W=()=>{let a=o.cardColorStyleClass||"instance-card-default";return o.instanceData?.installMethod===E.DOCKER?a+=" install-docker":a+=" install-default",a};return(a,e)=>{const i=Y;return a.instanceData?(h(),y(l,{key:0,class:S(["single-instance-card","rounded-lg",W(),_(p)])},{default:A((()=>[a.showMoreControls?(h(),y(i,{key:0,"instance-data":a.instanceData,onDeleted:B},null,8,["instance-data"])):M("",!0),a.iconVisible&&a.appIconUrl?(h(),y(n,{key:1,style:{display:"flex"}},{default:A((()=>[C("div",null,[b(s,{width:"68",height:"68",cover:"",style:{"border-radius":"8px",cursor:"pointer"},onClick:x,alt:a.instanceData.name,src:a.appIconUrl},null,8,["alt","src"])]),C("div",J,[a.appNameVisible?(h(),y(t,{key:0,onClick:x,style:{"font-size":"1.125rem","font-weight":"bold",color:"rgba(0,0,0,0.75)","padding-right":"0px"}},{default:A((()=>[R(w(a.instanceData.name)+" ",1),b(d,{"open-delay":"900",activator:"parent",location:"bottom",transition:"false"},{default:A((()=>[R(w(a.instanceData.name),1)])),_:1})])),_:1})):M("",!0),b(u,{class:"pr-0",style:{opacity:"0.70"}},{default:A((()=>[R(w(a.$t("LMAppDetail.version"))+" "+w(a.instanceData.version)+" Â  ",1),_(N)?(h(),y(m,{key:0,density:"compact",variant:"flat",size:"small",color:"#086dd7",class:"pa-1"},{default:A((()=>[R(w(_(N)),1)])),_:1})):M("",!0)])),_:1})])])),_:1})):M("",!0),a.appVersionVisible?(h(),k(V,{key:2},[e[1]||(e[1]=C("div",{style:{height:"8px"},class:"mt-1"},null,-1)),C("div",Q,w(_($)),1)],64)):M("",!0),C("div",X,[b(d,{text:a.$t("LMAppDetail.installedAt"),location:"top"},{activator:A((({props:a})=>[C("div",Z,[b(s,L({width:"1.8rem",height:"1.8rem"},a,{src:"./images/app/install-time-gray.svg"}),null,16)])])),_:1},8,["text"]),C("div",aa,w(_(F).format(a.instanceData.createTime)),1)]),C("div",ea,[C("div",ta,[b(s,{width:"1.8rem",height:"1.8rem",src:"./images/app/model-dir-gray.svg"})]),C("a",{href:"#",style:{flex:"1"},class:"text-left mx-1",onClick:I(O,["prevent"])},[R(w(a.$t("LMAppDetail.appDirectory"))+" > ",1),b(d,{activator:"parent",location:"top"},{default:A((()=>[R(w(a.instanceData.appInstallPath),1)])),_:1})])]),b(f,{class:"mt-6"}),C("a",{href:"#",variant:"flat",class:S(["control-btn",o.instanceData?.installMethod===E.DOCKER?"install-docker":"install-default"]),onClick:e[0]||(e[0]=I((e=>{return t=a.instanceData.id,void z.openAppRunningWindow(t,j.START,o.instanceData.installName);var t}),["prevent"])),onMouseenter:v,onMouseleave:g},w(a.$t("LMAppDetail.RunApp")),35)])),_:1},8,["class"])):M("",!0)}}});export{la as _};
