import{c as t,T as a,e,r as s,A as i}from"./index.js";import{b as l,q as n,l as o,m as p,w as r,x as u,r as d}from"./vuetify.js";import{e as m,a4 as c,F as y,k as g,a3 as v,K as h,u as f,a2 as x,S as L,a1 as _,H as T,a0 as k,a6 as A,a5 as w,V as b,b as I,a9 as j,z as C,B as O,q as M,l as V,j as $}from"./vue.js";import{_ as U,F as D}from"./fav-btn-normal.vue_vue_type_style_index_0_lang.js";import{a as R}from"./app-info.js";import{d as F}from"./pinia.js";import{S}from"./single-app-item.js";import{g as z}from"./OSUtil.js";import{_ as E}from"./single-installed-instance.vue_vue_type_style_index_0_lang.js";import{u as N}from"./top-right-controls.vue_vue_type_style_index_0_lang.js";import{u as q}from"./lmd-system.js";import{_ as B}from"./top-app-bar.vue_vue_type_style_index_0_lang.js";import"./xterm.js";import"./debounce.js";import"./vuei18n.js";import"./lmd-locales.js";import"./delete-confirm-dialog-with-loading.js";import"./DateTimeUtil.js";import"./dayjs.js";const H=m({__name:"login-tip",props:{tip:{}},setup(e){const s=t(),i=()=>{s.showLoginView()};return(t,e)=>(_(),c(y,null,[g(l,{class:"mx-auto mb-0",style:{"margin-top":"160px"},width:"auto",height:"148",src:"./images/user/user-not-login.svg"}),v("div",null,h(t.tip),1),g(n,{variant:"outlined",class:"mt-6",onClick:i,color:f(a).PRIMARY_COLOR,style:{"border-radius":"8px",border:"1px solid rgb(var(--v-theme-primary))"}},{default:x((()=>[L(h(t.$t("User.LoginOrReg")),1)])),_:1},8,["color"])],64))}}),J=t(),K=async()=>{if(J.getToken()){return(await e.get("/api/fav/my-online-apps/count")).data.totalItems}return null},P=async()=>{if(J.getToken()){return(await e.get("/api/fav/my-tut-text/count")).data.totalItems}return null},X=F("myAIData",{state:()=>({installedInstanceList:[],onlineAppList:[],tutorialsTextList:[],favOnlineAppsCount:"",tutorialsTextCount:"",appListLoading:!1,tutorialTextListLoading:!1}),actions:{async getFavOnlineApps(){},async updateCountData(){this.favOnlineAppsCount=await K(),this.tutorialsTextCount=await P()},setInstalledLocalApps(t){this.installedInstanceList=t},setOnlineAppList(t){this.onlineAppList=t},setTutorialTextList(t){t.forEach((t=>{if("string"==typeof t.apps)return t.apps=JSON.parse(t.apps),t})),t&&t.length>0?this.tutorialsTextList=t:this.tutorialsTextList=[]},async updateOnlineAppList(){try{this.appListLoading=!0;const t=await(async()=>{if(J.getToken())return(await e.get("/api/fav/my-online-apps/?page=1&limit=20000")).data.data;return null})()||[];this.setOnlineAppList(t),this.favOnlineAppsCount=await K()}catch(t){console.log("getList",t)}finally{this.appListLoading=!1}},async updateTutorialTextList(){try{this.tutorialTextListLoading=!0;const t=await(async()=>{if(J.getToken())return(await e.get("/api/fav/my-tut-text/?page=1&limit=20000")).data.data;return null})()||[];this.setTutorialTextList(t),this.tutorialsTextCount=await P()}catch(t){console.log("getList",t)}finally{this.tutorialTextListLoading=!1}}}}),Y={class:"article-title mb-2"},G=["onClick"],Q={class:"article-summary mb-3"},W={class:"article-summary-text"},Z={class:"article-actions"},tt={style:{"white-space":"nowrap",overflow:"hidden",flex:"1"}},at=["onClick"],et={key:2,class:"fav-no-data",style:{"padding-bottom":"160px","font-size":"14px"}},st=m({__name:"my-fav-tutorial-text",setup(a){const e=X(),n=t();T((()=>{r()}));const r=()=>{e.updateTutorialTextList()},u=t=>{const a=document.createElement("a");a.href=t,a.target="_blank",document.body.appendChild(a),a.click(),document.body.removeChild(a)},d=async t=>{const a=(await R(t.alias)).id;s.push({name:i.AppDetail,params:{id:a}})};return(t,a)=>{const m=U,T=H;return _(),c(y,null,[f(e).tutorialTextListLoading?(_(),k(o,{key:0,class:"my-8 mx-4",style:{width:"100%"}},{default:x((()=>[g(p,{color:"primary",height:"6",indeterminate:"",rounded:""})])),_:1})):A("",!0),f(e).tutorialsTextList&&f(e).tutorialsTextList.length>0?(_(),k(o,{key:1,class:"my-fav-tutorials mb-8"},{default:x((()=>[(_(!0),c(y,null,w(f(e).tutorialsTextList,((a,e)=>(_(),c("div",{class:"article-item",key:a.id},[v("div",Y,[v("a",{href:"#",onClick:b((t=>(t=>{s.push({name:i.TutorialTextDetail,params:{id:t.id}})})(a)),["prevent"])},h(a.title),9,G)]),v("div",Q,[a.coverUrl?(_(),k(l,{key:0,class:"article-cover mr-5",src:a.coverUrl,rounded:"lg",cover:"",width:"160",height:"96","max-width":"160","max-height":"96"},null,8,["src"])):A("",!0),v("div",W,h(a.summary),1)]),v("div",Z,[g(m,{onRemoveFav:r,"res-id":a.id,"res-type":f(D).TUT_TEXT},null,8,["res-id","res-type"]),v("div",tt,[L(h(t.$t("Tutorial.RelatedApps"))+": ",1),(_(!0),c(y,null,w(a.apps,((t,e)=>(_(),c(y,{key:e},[v("a",{href:"#",onClick:b((a=>(t=>{const a=t.url;t.alias?d(t):a&&u(a)})(t)),["prevent"])},h(t.name),9,at),e+1!==a.apps?.length?(_(),c(y,{key:0},[L(" , ")],64)):A("",!0)],64)))),128))])])])))),128))])),_:1})):f(e).appListLoading?A("",!0):(_(),c("div",et,[f(n).isUserLoggedIn?(_(),c(y,{key:0},[g(l,{class:"mx-auto mt-10 mb-3",width:"auto",height:"280",src:"./images/my-ai/fav-no-data.svg"}),L(" "+h(t.$t("MyAI.NoData")),1)],64)):(_(),k(T,{key:1,tip:t.$t("MyAI.LoginToViewTut")},null,8,["tip"]))]))],64)}}}),it={key:2,class:"fav-no-data",style:{"padding-bottom":"160px","font-size":"14px"}},lt=m({__name:"my-fav-online-app",setup(a){const e=X(),s=t();T((()=>{i()}));const i=async()=>{e.updateOnlineAppList()};return(t,a)=>{const n=S,d=H;return _(),c(y,null,[f(e).appListLoading?(_(),k(o,{key:0,class:"my-8 mx-4",style:{width:"100%"}},{default:x((()=>[g(p,{color:"primary",height:"6",indeterminate:"",rounded:""})])),_:1})):A("",!0),f(e).onlineAppList&&f(e).onlineAppList.length>0?(_(),k(r,{key:1,class:"app-list gap-2 mb-2 mt-7",style:{flex:"unset"}},{default:x((()=>[(_(!0),c(y,null,w(f(e).onlineAppList,((t,a)=>(_(),k(u,{key:t.name+a,cols:"12",xs:"12",sm:"6",md:"4",lg:"3",xl:"2"},{default:x((()=>[g(n,{onRemoveFav:i,"app-data":t},null,8,["app-data"])])),_:2},1024)))),128))])),_:1})):f(e).appListLoading?A("",!0):(_(),c("div",it,[f(s).isUserLoggedIn?(_(),c(y,{key:0},[g(l,{class:"mx-auto mb-6",style:{"margin-top":"170px"},width:"211",height:"140",src:"./images/my-ai/fav-no-data.svg"}),L(" "+h(t.$t("MyAI.NoData")),1)],64)):(_(),k(d,{key:1,tip:t.$t("MyAI.LoginToViewApp")},null,8,["tip"]))]))],64)}}}),nt={class:"my-ai-nav-container ga-6 pb-5"},ot=["onClick"],pt={style:{flex:"1","padding-top":"16px","padding-left":"14px"}},rt={class:"item-count"},ut={class:"item-name"},dt={class:"indicator"},mt=m({__name:"my-data-nav",props:{modelValue:{}},emits:["update:modelValue"],setup(a,{emit:e}){const s=t(),i=X(),n=a,o=I([{name:"MyAI.MyLocalApps",value:"local"},{name:"MyAI.MyOnlineApps",value:"online"},{name:"MyAI.MyTutorials",value:"tutorial"}]),p=e;T((()=>{i.updateCountData()}));return(t,a)=>(_(),c("div",nt,[(_(!0),c(y,null,w(f(o),((a,e)=>{return _(),c("div",{key:e,class:j(["nav-item",`nav-item-${e+1}`,(r=e,n.modelValue===r?"active":"")]),onClick:t=>(t=>{p("update:modelValue",t)})(e)},[g(l,{width:"120",height:"88",draggable:"false","max-width":"120","max-height":"88",class:"ml-2",src:`./images/my-ai/${a.value}.svg`},null,8,["src"]),v("div",pt,[v("div",rt,h((o=a.value,"local"===o?i.installedInstanceList.length:"online"===o?s.isUserLoggedIn?i.favOnlineAppsCount:"- -":"tutorial"===o?s.isUserLoggedIn?i.tutorialsTextCount:"- -":void 0)),1),v("div",ut,h(t.$t(a.name)),1)]),g(M,{name:"fade"},{default:x((()=>[C(v("div",dt,null,512),[[O,n.modelValue===e]])])),_:2},1024)],10,ot);var o,r})),128))]))}}),ct={key:2,class:"text-center mx-auto",style:{"font-size":"16px"}},yt=m({__name:"instance-list",setup(t){const a=I(null),e=I(!1),s=X(),i=N();T((()=>{n(),q()}));const n=async()=>{e.value=!0;let t=await z();t=m(t),s.setInstalledLocalApps(t),a.value=t,e.value=!1},m=t=>{const a={};return t.forEach((t=>{a[t.appId]?a[t.appId]++:a[t.appId]=1})),t.map((t=>({...t,instancesCountOfApp:a[t.appId]})))},v=()=>{n()};return V((()=>i.currentLocale),n),(t,s)=>(_(),c(y,null,[f(e)?(_(),k(o,{key:0,class:"my-8 mx-4",style:{width:"100%"}},{default:x((()=>[g(p,{color:"primary",height:"6",indeterminate:"",rounded:""})])),_:1})):A("",!0),f(a)&&f(a).length>0?(_(),k(d,{key:1,class:"mx-0 ga-2 mt-4",style:{width:"100%","max-width":"unset","padding-left":"0","padding-right":"0"}},{default:x((()=>[g(r,null,{default:x((()=>[(_(!0),c(y,null,w(f(a),((t,a)=>(_(),k(u,{key:a,cols:"12",xs:"12",sm:"6",md:"4",lg:"3",xl:"2"},{default:x((()=>[g(E,{"app-icon-url":t.appIcon,"card-color-style-class":"instance-card-gray","app-version-visible":!1,"instance-data":t,onDeleted:v,"show-more-controls":!0,"app-name-visible":!0,"icon-visible":!0},null,8,["app-icon-url","instance-data"])])),_:2},1024)))),128))])),_:1})])),_:1})):A("",!0),f(a)&&0===f(a).length?(_(),c("div",ct,[g(l,{class:"mx-auto mt-8 mb-4",width:"auto",height:"200",src:"./images/app/no-data.svg"}),L(" "+h(t.$t("InstalledApps.NoApp")),1)])):A("",!0)],64))}}),gt=m({__name:"MyAI",setup(t){const a=I(0);return(t,e)=>{const s=mt,i=lt,l=st;return _(),c(y,null,[g(B,{"main-title":t.$t("InstalledApps.MainTitle"),"sub-title":t.$t("InstalledApps.Subtitle")},null,8,["main-title","sub-title"]),g(d,{class:"my-ai-container mt-0 pt-0 px-8 pb-8"},{default:x((()=>[g(s,{modelValue:f(a),"onUpdate:modelValue":e[0]||(e[0]=t=>$(a)?a.value=t:null)},null,8,["modelValue"]),0===f(a)?(_(),k(yt,{key:0})):A("",!0),1===f(a)?(_(),k(i,{key:1})):A("",!0),2===f(a)?(_(),k(l,{key:2})):A("",!0)])),_:1})],64)}}});export{gt as default};
