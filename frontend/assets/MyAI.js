import{c as t,T as a,e,r as s,A as i}from"./index.js";import{b as l,q as n,l as o,m as p,w as r,x as u,r as d}from"./vuetify.js";import{e as m,a3 as c,F as y,k as g,a2 as v,K as h,u as x,a1 as f,S as L,a0 as _,H as T,$ as k,a5 as A,a4 as w,Y as b,b as I,a8 as j,z as C,B as O,q as M,l as $,j as U}from"./vue.js";import{_ as V,F as D,S as R}from"./single-app-item.js";import{g as F}from"./app-info.js";import{d as z}from"./pinia.js";import{g as N}from"./install-instance.js";import{_ as S}from"./single-installed-instance.vue_vue_type_style_index_0_lang.js";import{u as E}from"./top-right-controls.vue_vue_type_style_index_0_lang.js";import{_ as q}from"./top-app-bar.vue_vue_type_style_index_0_lang.js";import"./xterm.js";import"./debounce.js";import"./vuei18n.js";import"./lmd-locales.js";import"./lmd-system.js";import"./DateTimeUtil.js";import"./dayjs.js";import"./AppRunningUtil.js";const Y=m({__name:"login-tip",props:{tip:{}},setup(e){const s=t(),i=()=>{s.showLoginView()};return(t,e)=>(_(),c(y,null,[g(l,{class:"mx-auto mb-0",style:{"margin-top":"160px"},width:"auto",height:"148",src:"./images/user/user-not-login.svg"}),v("div",null,h(t.tip),1),g(n,{variant:"outlined",class:"mt-6",onClick:i,color:x(a).PRIMARY_COLOR,style:{"border-radius":"8px",border:"1px solid rgb(var(--v-theme-primary))"}},{default:f((()=>[L(h(t.$t("User.LoginOrReg")),1)])),_:1},8,["color"])],64))}}),B=t(),H=async()=>{if(B.getToken()){return(await e.get("/api/fav/my-online-apps/count")).data.totalItems}return null},J=async()=>{if(B.getToken()){return(await e.get("/api/fav/my-tut-text/count")).data.totalItems}return null},K=z("myAIData",{state:()=>({installedInstanceList:[],onlineAppList:[],tutorialsTextList:[],favOnlineAppsCount:"",tutorialsTextCount:"",appListLoading:!1,tutorialTextListLoading:!1}),actions:{async getFavOnlineApps(){},async updateCountData(){this.favOnlineAppsCount=await H(),this.tutorialsTextCount=await J()},setInstalledLocalApps(t){this.installedInstanceList=t},setOnlineAppList(t){this.onlineAppList=t},setTutorialTextList(t){t.forEach((t=>{if("string"==typeof t.apps)return t.apps=JSON.parse(t.apps),t})),t&&t.length>0?this.tutorialsTextList=t:this.tutorialsTextList=[]},async updateOnlineAppList(){try{this.appListLoading=!0;const t=await(async()=>{if(B.getToken())return(await e.get("/api/fav/my-online-apps/?page=1&limit=20000")).data.data;return null})()||[];this.setOnlineAppList(t),this.favOnlineAppsCount=await H()}catch(t){console.log("getList",t)}finally{this.appListLoading=!1}},async updateTutorialTextList(){try{this.tutorialTextListLoading=!0;const t=await(async()=>{if(B.getToken())return(await e.get("/api/fav/my-tut-text/?page=1&limit=20000")).data.data;return null})()||[];this.setTutorialTextList(t),this.tutorialsTextCount=await J()}catch(t){console.log("getList",t)}finally{this.tutorialTextListLoading=!1}}}}),P={class:"article-title mb-2"},X=["onClick"],G={class:"article-summary mb-3"},Q={class:"article-summary-text"},W={class:"article-actions"},Z={style:{"white-space":"nowrap",overflow:"hidden",flex:"1"}},tt=["onClick"],at={key:2,class:"fav-no-data",style:{"padding-bottom":"160px","font-size":"14px"}},et=m({__name:"my-fav-tutorial-text",setup(a){const e=K(),n=t();T((()=>{r()}));const r=()=>{e.updateTutorialTextList()},u=t=>{const a=document.createElement("a");a.href=t,a.target="_blank",document.body.appendChild(a),a.click(),document.body.removeChild(a)},d=async t=>{const a=(await F(t.alias)).id;s.push({name:i.AppDetail,params:{id:a}})};return(t,a)=>{const m=V,T=Y;return _(),c(y,null,[x(e).tutorialTextListLoading?(_(),k(o,{key:0,class:"my-8 mx-4",style:{width:"100%"}},{default:f((()=>[g(p,{color:"primary",height:"6",indeterminate:"",rounded:""})])),_:1})):A("",!0),x(e).tutorialsTextList&&x(e).tutorialsTextList.length>0?(_(),k(o,{key:1,class:"my-fav-tutorials mb-8"},{default:f((()=>[(_(!0),c(y,null,w(x(e).tutorialsTextList,((a,e)=>(_(),c("div",{class:"article-item",key:a.id},[v("div",P,[v("a",{href:"#",onClick:b((t=>(t=>{s.push({name:i.TutorialTextDetail,params:{id:t.id}})})(a)),["prevent"])},h(a.title),9,X)]),v("div",G,[a.coverUrl?(_(),k(l,{key:0,class:"article-cover mr-5",src:a.coverUrl,rounded:"lg",cover:"",width:"160",height:"96","max-width":"160","max-height":"96"},null,8,["src"])):A("",!0),v("div",Q,h(a.summary),1)]),v("div",W,[g(m,{onRemoveFav:r,"res-id":a.id,"res-type":x(D).TUT_TEXT},null,8,["res-id","res-type"]),v("div",Z,[L(h(t.$t("Tutorial.RelatedApps"))+": ",1),(_(!0),c(y,null,w(a.apps,((t,e)=>(_(),c(y,{key:e},[v("a",{href:"#",onClick:b((a=>(t=>{const a=t.url;t.alias?d(t):a&&u(a)})(t)),["prevent"])},h(t.name),9,tt),e+1!==a.apps?.length?(_(),c(y,{key:0},[L(" , ")],64)):A("",!0)],64)))),128))])])])))),128))])),_:1})):x(e).appListLoading?A("",!0):(_(),c("div",at,[x(n).isUserLoggedIn?(_(),c(y,{key:0},[g(l,{class:"mx-auto mt-10 mb-3",width:"auto",height:"280",src:"./images/my-ai/fav-no-data.svg"}),L(" "+h(t.$t("MyAI.NoData")),1)],64)):(_(),k(T,{key:1,tip:t.$t("MyAI.LoginToViewTut")},null,8,["tip"]))]))],64)}}}),st={key:2,class:"fav-no-data",style:{"padding-bottom":"160px","font-size":"14px"}},it=m({__name:"my-fav-online-app",setup(a){const e=K(),s=t();T((()=>{i()}));const i=async()=>{e.updateOnlineAppList()};return(t,a)=>{const n=R,d=Y;return _(),c(y,null,[x(e).appListLoading?(_(),k(o,{key:0,class:"my-8 mx-4",style:{width:"100%"}},{default:f((()=>[g(p,{color:"primary",height:"6",indeterminate:"",rounded:""})])),_:1})):A("",!0),x(e).onlineAppList&&x(e).onlineAppList.length>0?(_(),k(r,{key:1,class:"app-list gap-2 mb-2 mt-7",style:{flex:"unset"}},{default:f((()=>[(_(!0),c(y,null,w(x(e).onlineAppList,((t,a)=>(_(),k(u,{key:t.name+a,cols:"12",xs:"12",sm:"6",md:"4",lg:"3",xl:"2"},{default:f((()=>[g(n,{onRemoveFav:i,"app-data":t},null,8,["app-data"])])),_:2},1024)))),128))])),_:1})):x(e).appListLoading?A("",!0):(_(),c("div",st,[x(s).isUserLoggedIn?(_(),c(y,{key:0},[g(l,{class:"mx-auto mb-6",style:{"margin-top":"170px"},width:"211",height:"140",src:"./images/my-ai/fav-no-data.svg"}),L(" "+h(t.$t("MyAI.NoData")),1)],64)):(_(),k(d,{key:1,tip:t.$t("MyAI.LoginToViewApp")},null,8,["tip"]))]))],64)}}}),lt={class:"my-ai-nav-container ga-6 pb-5"},nt=["onClick"],ot={style:{flex:"1","padding-top":"16px","padding-left":"14px"}},pt={class:"item-count"},rt={class:"item-name"},ut={class:"indicator"},dt=m({__name:"my-data-nav",props:{modelValue:{}},emits:["update:modelValue"],setup(a,{emit:e}){const s=t(),i=K(),n=a,o=I([{name:"MyAI.MyLocalApps",value:"local"},{name:"MyAI.MyOnlineApps",value:"online"},{name:"MyAI.MyTutorials",value:"tutorial"}]),p=e;T((()=>{i.updateCountData()}));return(t,a)=>(_(),c("div",lt,[(_(!0),c(y,null,w(x(o),((a,e)=>{return _(),c("div",{key:e,class:j(["nav-item",`nav-item-${e+1}`,(r=e,n.modelValue===r?"active":"")]),onClick:t=>(t=>{p("update:modelValue",t)})(e)},[g(l,{width:"120",height:"88",draggable:"false","max-width":"120","max-height":"88",class:"ml-2",src:`./images/my-ai/${a.value}.svg`},null,8,["src"]),v("div",ot,[v("div",pt,h((o=a.value,"local"===o?i.installedInstanceList.length:"online"===o?s.isUserLoggedIn?i.favOnlineAppsCount:"- -":"tutorial"===o?s.isUserLoggedIn?i.tutorialsTextCount:"- -":void 0)),1),v("div",rt,h(t.$t(a.name)),1)]),g(M,{name:"fade"},{default:f((()=>[C(v("div",ut,null,512),[[O,n.modelValue===e]])])),_:2},1024)],10,nt);var o,r})),128))]))}}),mt={key:2,class:"text-center mx-auto",style:{"font-size":"16px"}},ct=m({__name:"instance-list",setup(t){const a=I(null),e=I(!1),s=K(),i=E();T((()=>{n()}));const n=async()=>{e.value=!0;const t=await N();s.setInstalledLocalApps(t),a.value=t,e.value=!1},m=()=>{n()};return $((()=>i.currentLocale),n),(t,s)=>(_(),c(y,null,[x(e)?(_(),k(o,{key:0,class:"my-8 mx-4",style:{width:"100%"}},{default:f((()=>[g(p,{color:"primary",height:"6",indeterminate:"",rounded:""})])),_:1})):A("",!0),x(a)&&x(a).length>0?(_(),k(d,{key:1,class:"mx-0 ga-2 mt-4",style:{width:"100%","max-width":"unset","padding-left":"0","padding-right":"0"}},{default:f((()=>[g(r,null,{default:f((()=>[(_(!0),c(y,null,w(x(a),((t,a)=>(_(),k(u,{key:a,cols:"12",xs:"12",sm:"6",md:"4",lg:"3",xl:"2"},{default:f((()=>[g(S,{"app-icon-url":t.appIcon,"card-color-style-class":"instance-card-gray","app-version-visible":!1,"instance-data":t,onDeleted:m,"app-name-visible":!0,"icon-visible":!0},null,8,["app-icon-url","instance-data"])])),_:2},1024)))),128))])),_:1})])),_:1})):A("",!0),x(a)&&0===x(a).length?(_(),c("div",mt,[g(l,{class:"mx-auto mt-8 mb-4",width:"auto",height:"200",src:"./images/app/no-data.svg"}),L(" "+h(t.$t("InstalledApps.NoApp")),1)])):A("",!0)],64))}}),yt=m({__name:"MyAI",setup(t){const a=I(0);return(t,e)=>{const s=dt,i=it,l=et;return _(),c(y,null,[g(q,{"main-title":t.$t("InstalledApps.MainTitle"),"sub-title":t.$t("InstalledApps.Subtitle")},null,8,["main-title","sub-title"]),g(d,{class:"my-ai-container mt-0 pt-0 px-8 pb-8"},{default:f((()=>[g(s,{modelValue:x(a),"onUpdate:modelValue":e[0]||(e[0]=t=>U(a)?a.value=t:null)},null,8,["modelValue"]),0===x(a)?(_(),k(ct,{key:0})):A("",!0),1===x(a)?(_(),k(i,{key:1})):A("",!0),2===x(a)?(_(),k(l,{key:2})):A("",!0)])),_:1})],64)}}});export{yt as default};
