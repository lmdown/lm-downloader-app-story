import{e,b as a,H as l,$ as t,Y as s,u as i,j as o,a1 as n,a2 as r,k as d,S as c,K as u,a0 as m,l as g,a3 as p,F as h,a5 as v,ad as w,ae as f,m as y,c as _}from"./vue.js";import{L as V,b as U,c as C,T as b,m as D,s as x,g as k,f as $,n as P,p as H}from"./index.js";import{D as L,X as F,e as T,F as M,q as O,z as R,A,b as E,d as z,l as S,J as I,o as N,n as B,y as Z}from"./vuetify.js";import{_ as j,g as G,I as q,e as Y,D as X,r as J}from"./lmd-system.js";import{u as K}from"./vuei18n.js";import{d as Q}from"./pinia.js";const W=Q("localeInfo",{state:()=>({currentLocale:V.getCurrentLocale()}),actions:{async changeLocale(e){this.currentLocale=e}}}),ee={class:"pt-4 pb-3 change-name-form"},ae=e({__name:"change-nickname-form",emits:["changeSuccess","hideDialog"],setup(e,{emit:g}){const{t:p}=L(),{addToast:h}=U(),v=a(!1),w=a(!1),f=a({}),y=C(),_=g,V=[e=>!!e||p("Common.fieldRequired"),e=>e&&e.length>=2||p("User.NicknameVMsgMoreThan2Chars"),e=>e&&e.length<=30||p("User.NicknameVMsgLessThan30Chars")];l((()=>{f.value={name:y.currentUserData.name}}));const b=async()=>{if(w.value){v.value=!0;try{await y.changeNickname(f.value),h(p("User.UpdateSuccess")),D(),y.updateCurrentUserData()}catch(e){console.error(e);const a=e?.message;a&&h(a,"error")}finally{v.value=!1}}},D=()=>{_("hideDialog")};return(e,a)=>(m(),t(F,{modelValue:i(w),"onUpdate:modelValue":a[1]||(a[1]=e=>o(w)?w.value=e:null),onSubmit:s(b,["prevent"])},{default:n((()=>[r("div",ee,[d(T,{class:"form-input",rules:V,density:"compact",modelValue:i(f).name,"onUpdate:modelValue":a[0]||(a[0]=e=>i(f).name=e),readonly:i(v),variant:"outlined",rounded:"lg"},null,8,["modelValue","readonly"])]),d(M,{style:{"border-top":"1px solid #EBEBF7"},class:"py-6 text-center justify-center"},{default:n((()=>[d(O,{variant:"outlined",onClick:D},{default:n((()=>[c(u(e.$t("User.Cancel")),1)])),_:1}),d(O,{variant:"flat",color:"primary",type:"submit",loading:i(v)},{default:n((()=>[c(u(e.$t("User.Submit")),1)])),_:1},8,["loading"])])),_:1})])),_:1},8,["modelValue"]))}}),le=e({__name:"change-nickname-dialog",setup(e){const l=a(!1),s=C(),r=()=>{l.value=!1};return g((()=>s.changeNicknameViewVisible),(e=>{e&&(l.value=!0)})),(e,a)=>{const s=ae;return m(),t(R,{modelValue:i(l),"onUpdate:modelValue":a[0]||(a[0]=e=>o(l)?l.value=e:null),"min-width":"400","max-width":"480"},{default:n((()=>[d(A,{title:e.$t("User.ChangeName")},{append:n((()=>[d(O,{icon:"mdi-close",class:"ms-auto",size:"compact",elevation:"0",onClick:r})])),default:n((()=>[d(s,{onHideDialog:r,onChangeSuccess:r})])),_:1},8,["title"])])),_:1},8,["modelValue"])}}}),te={class:"pt-4 pb-3 change-pwd-form"},se=e({__name:"change-pwd-form",emits:["changeSuccess","hideDialog"],setup(e,{emit:l}){const{t:g}=L(),{addToast:p}=U(),h=a(!1),v=a(!1),w=a({}),f=C(),y=l,_=e=>!!e||g("Common.fieldRequired"),V=[_,e=>e&&e.length>=8||g("User.PwdVMsgMoreThan8Chars"),e=>e&&e.length<=30||g("User.PwdVMsgLessThan30Chars"),e=>/[0-9]/.test(e)||g("User.PwdVMsgHasNum"),e=>/[A-Z]/.test(e)||g("User.PwdVMsgHasUppercase"),e=>/[a-z]/.test(e)||g("User.PwdVMsgHasLowercase")],b=async()=>{if(console.log("onSubmit changePwd",w.value),v.value){h.value=!0;try{await f.changePwd(w.value),p(g("User.UpdateSuccess")),D()}catch(e){console.error(e);const a=e?.message;a&&p(a,"error")}finally{h.value=!1}}},D=()=>{y("hideDialog")};return(e,a)=>(m(),t(F,{modelValue:i(v),"onUpdate:modelValue":a[3]||(a[3]=e=>o(v)?v.value=e:null),onSubmit:s(b,["prevent"])},{default:n((()=>[r("div",te,[d(T,{class:"form-input",rules:[_],density:"compact",modelValue:i(w).oldPassword,"onUpdate:modelValue":a[0]||(a[0]=e=>i(w).oldPassword=e),type:"password",readonly:i(h),variant:"outlined",rounded:"lg",placeholder:e.$t("User.OldPwd")},{"prepend-inner":n((()=>[d(E,{src:"./images/user/pwd.svg",width:"27",height:"27","max-width":"27","max-height":"27"})])),_:1},8,["rules","modelValue","readonly","placeholder"]),d(T,{class:"form-input",rules:V,density:"compact",modelValue:i(w).password,"onUpdate:modelValue":a[1]||(a[1]=e=>i(w).password=e),type:"password",readonly:i(h),variant:"outlined",rounded:"lg",placeholder:e.$t("User.NewPwd")},{"prepend-inner":n((()=>[d(E,{src:"./images/user/pwd.svg",width:"27",height:"27","max-width":"27","max-height":"27"})])),_:1},8,["modelValue","readonly","placeholder"]),d(T,{class:"form-input",rules:V,density:"compact",modelValue:i(w).repeatPassword,"onUpdate:modelValue":a[2]||(a[2]=e=>i(w).repeatPassword=e),type:"password",readonly:i(h),variant:"outlined",rounded:"lg",placeholder:e.$t("User.ConfirmPwd")},{"prepend-inner":n((()=>[d(E,{src:"./images/user/pwd-confirm.svg",width:"27",height:"27","max-width":"27","max-height":"27"})])),_:1},8,["modelValue","readonly","placeholder"])]),d(M,{style:{"border-top":"1px solid #EBEBF7"},class:"py-6 text-center justify-center"},{default:n((()=>[d(O,{variant:"outlined",onClick:D},{default:n((()=>[c(u(e.$t("User.Cancel")),1)])),_:1}),d(O,{variant:"flat",color:"primary",type:"submit",loading:i(h)},{default:n((()=>[c(u(e.$t("User.Submit")),1)])),_:1},8,["loading"])])),_:1})])),_:1},8,["modelValue"]))}}),ie=e({__name:"change-pwd-dialog",setup(e){const l=a(!1),s=C(),r=()=>{l.value=!1};return g((()=>s.changePwdViewVisible),(e=>{e&&(l.value=!0)})),(e,a)=>{const s=se;return m(),t(R,{modelValue:i(l),"onUpdate:modelValue":a[0]||(a[0]=e=>o(l)?l.value=e:null),"min-width":"400","max-width":"480"},{default:n((()=>[d(A,{title:e.$t("User.ChangePwd")},{append:n((()=>[d(O,{icon:"mdi-close",class:"ms-auto",size:"compact",elevation:"0",onClick:r})])),default:n((()=>[d(s,{onHideDialog:r,onChangeSuccess:r})])),_:1},8,["title"])])),_:1},8,["modelValue"])}}}),oe={class:"reset-form-view"},ne={class:"d-flex flex-row",style:{"align-items":"center"}},re={style:{"font-size":"16px","font-weight":"bold"}},de={class:"reset-tip"},ce=e({__name:"reset-pwd-form",emits:["back","resetPwdSuccess"],setup(e,{emit:l}){const t=a(!1),g=a(!1),h=a({}),{addToast:v}=U(),w=C(),{t:f}=L(),y=l,_=()=>{y("back")},V=e=>!!e||f("Common.fieldRequired"),D=[V,e=>e&&e.length>=8||f("User.PwdVMsgMoreThan8Chars"),e=>e&&e.length<=30||f("User.PwdVMsgLessThan30Chars"),e=>/[0-9]/.test(e)||f("User.PwdVMsgHasNum"),e=>/[A-Z]/.test(e)||f("User.PwdVMsgHasUppercase"),e=>/[a-z]/.test(e)||f("User.PwdVMsgHasLowercase")],x=[V,e=>/^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$/.test(e)||f("User.EmailNotValid")],k=async()=>{console.log("sendCode"),await w.forgotPwd({email:h.value.email}),v(f("User.CodeSent"))},$=async()=>{if(g.value){t.value=!0;try{await w.resetPwd(h.value),v(f("User.PwdResetSuccess")),y("resetPwdSuccess")}catch(e){console.error(e)}finally{t.value=!1}}};return(e,a)=>(m(),p("div",oe,[r("div",ne,[d(O,{onClick:_,variant:"plain",style:{"margin-left":"-1rem"}},{default:n((()=>[d(z,{class:"lmd-back-icon mr-3",style:{"font-size":"1.4rem"},size:"24",icon:"mdi-chevron-left",color:"#FB6C00"})])),_:1}),r("div",re,u(e.$t("User.ResetPwd")),1)]),d(F,{class:"pt-4 pb-3 login-form",modelValue:i(g),"onUpdate:modelValue":a[4]||(a[4]=e=>o(g)?g.value=e:null),style:{margin:"auto","max-width":"350px"},onSubmit:s($,["prevent"])},{default:n((()=>[d(T,{class:"login-input",rules:x,density:"compact",modelValue:i(h).email,"onUpdate:modelValue":a[0]||(a[0]=e=>i(h).email=e),readonly:i(t),variant:"outlined",rounded:"lg",placeholder:e.$t("User.FormEmail")},{"prepend-inner":n((()=>[d(E,{src:"./images/user/email.svg",width:"27",height:"27","max-width":"27","max-height":"27"})])),"append-inner":n((()=>[d(O,{onClick:k,variant:"text",size:"small",color:i(b).PRIMARY_COLOR},{default:n((()=>[c(u(e.$t("User.SendCode")),1)])),_:1},8,["color"])])),_:1},8,["modelValue","readonly","placeholder"]),d(T,{class:"login-input",rules:[V],density:"compact",modelValue:i(h).resetToken,"onUpdate:modelValue":a[1]||(a[1]=e=>i(h).resetToken=e),readonly:i(t),variant:"outlined",rounded:"lg",placeholder:e.$t("User.VerifyCode")},{"prepend-inner":n((()=>[d(E,{src:"./images/user/pwd.svg",width:"27",height:"27","max-width":"27","max-height":"27"})])),_:1},8,["rules","modelValue","readonly","placeholder"]),d(T,{class:"login-input",rules:D,density:"compact",modelValue:i(h).password,"onUpdate:modelValue":a[2]||(a[2]=e=>i(h).password=e),readonly:i(t),variant:"outlined",rounded:"lg",type:"password",placeholder:e.$t("User.FormPwd")},{"prepend-inner":n((()=>[d(E,{src:"./images/user/pwd.svg",width:"27",height:"27","max-width":"27","max-height":"27"})])),_:1},8,["modelValue","readonly","placeholder"]),d(T,{class:"login-input",rules:D,density:"compact",modelValue:i(h).repeatPassword,"onUpdate:modelValue":a[3]||(a[3]=e=>i(h).repeatPassword=e),readonly:i(t),variant:"outlined",rounded:"lg",type:"password",placeholder:e.$t("User.ConfirmPwd")},{"prepend-inner":n((()=>[d(E,{src:"./images/user/pwd-confirm.svg",width:"27",height:"27","max-width":"27","max-height":"27"})])),_:1},8,["modelValue","readonly","placeholder"]),d(O,{class:"submit-btn mt-3",height:"40",variant:"flat",type:"submit",loading:i(t)},{default:n((()=>[c(u(e.$t("User.Submit")),1)])),_:1},8,["loading"])])),_:1},8,["modelValue"]),r("div",de,[d(z,{size:"18",color:i(b).PRIMARY_COLOR,icon:"mdi-information-outline"},null,8,["color"]),c(" "+u(e.$t("User.SendCodeTip")),1)])]))}}),ue={class:"reg-form-view"},me={class:"d-flex flex-row",style:{"align-items":"center"}},ge={style:{"font-size":"16px","font-weight":"bold"}},pe=e({__name:"reg-form",emits:["back","registerSuccess"],setup(e,{emit:l}){const t=a(!1),g=a(!1),h=a({}),{addToast:v}=U(),w=C(),{t:f}=L(),y=l,_=()=>{y("back")},V=e=>!!e||f("Common.fieldRequired"),b=[V,e=>e&&e.length>=8||f("User.PwdVMsgMoreThan8Chars"),e=>e&&e.length<=30||f("User.PwdVMsgLessThan30Chars"),e=>/[0-9]/.test(e)||f("User.PwdVMsgHasNum"),e=>/[A-Z]/.test(e)||f("User.PwdVMsgHasUppercase"),e=>/[a-z]/.test(e)||f("User.PwdVMsgHasLowercase")],D=[V,e=>/^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$/.test(e)||f("User.EmailNotValid")],x=async()=>{if(g.value){t.value=!0;try{await w.userRegister(h.value),y("registerSuccess")}catch(e){console.error(e)}finally{t.value=!1}}};return(e,a)=>(m(),p("div",ue,[r("div",me,[d(O,{onClick:_,variant:"plain",style:{"margin-left":"-1rem"}},{default:n((()=>[d(z,{class:"lmd-back-icon mr-3",style:{"font-size":"1.4rem"},size:"24",icon:"mdi-chevron-left",color:"#FB6C00"})])),_:1}),r("div",ge,u(e.$t("User.UserRegister")),1)]),d(F,{class:"pt-4 pb-3 px-0 login-form",modelValue:i(g),"onUpdate:modelValue":a[3]||(a[3]=e=>o(g)?g.value=e:null),onSubmit:s(x,["prevent"])},{default:n((()=>[d(T,{class:"login-input",rules:D,density:"compact",modelValue:i(h).email,"onUpdate:modelValue":a[0]||(a[0]=e=>i(h).email=e),readonly:i(t),variant:"outlined",rounded:"lg",placeholder:e.$t("User.FormEmail")},{"prepend-inner":n((()=>[d(E,{src:"./images/user/email.svg",width:"27",height:"27","max-width":"27","max-height":"27"})])),_:1},8,["modelValue","readonly","placeholder"]),d(T,{class:"login-input",rules:b,density:"compact",modelValue:i(h).password,"onUpdate:modelValue":a[1]||(a[1]=e=>i(h).password=e),readonly:i(t),variant:"outlined",rounded:"lg",type:"password",placeholder:e.$t("User.FormPwd")},{"prepend-inner":n((()=>[d(E,{src:"./images/user/pwd.svg",width:"27",height:"27","max-width":"27","max-height":"27"})])),_:1},8,["modelValue","readonly","placeholder"]),d(T,{class:"login-input",rules:b,density:"compact",modelValue:i(h).repeatPassword,"onUpdate:modelValue":a[2]||(a[2]=e=>i(h).repeatPassword=e),readonly:i(t),variant:"outlined",rounded:"lg",type:"password",placeholder:e.$t("User.ConfirmPwd")},{"prepend-inner":n((()=>[d(E,{src:"./images/user/pwd.svg",width:"27",height:"27","max-width":"27","max-height":"27"})])),_:1},8,["modelValue","readonly","placeholder"]),d(O,{class:"submit-btn mt-7",height:"40",variant:"flat",type:"submit",loading:i(t)},{default:n((()=>[c(u(e.$t("User.Login")),1)])),_:1},8,["loading"])])),_:1},8,["modelValue"])]))}}),he={class:"login-title"},ve={style:{"text-align":"center"},class:"mt-10"},we={style:{"text-align":"center","font-size":"12px","margin-top":"80px",color:"rgba(0,0,0,0.45)"}},fe=["href"],ye=["href"],_e=e({__name:"login-form",emits:["loginSuccess","toResetPwdView","toRegisterView"],setup(e,{emit:l}){const{addToast:t}=U(),{t:g}=L(),v=a(!1),w=a(!1),f=a({}),y=C(),_=e=>!!e||g("Common.fieldRequired"),V=[_,e=>/^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$/.test(e)||g("User.EmailNotValid")],b=[_],D=l,x=async()=>{if(w.value){v.value=!0;try{await y.userLogin(f.value),D("loginSuccess")}catch(e){console.error(e)}finally{v.value=!1}}},k=async()=>{D("toResetPwdView")},$=async()=>{D("toRegisterView")};return(e,a)=>(m(),p(h,null,[r("div",null,[r("div",he,u(e.$t("User.EmailLogin")),1)]),d(F,{class:"pt-4 pb-3 px-0 login-form",modelValue:i(w),"onUpdate:modelValue":a[2]||(a[2]=e=>o(w)?w.value=e:null),onSubmit:s(x,["prevent"])},{default:n((()=>[d(T,{class:"login-input",rules:V,density:"compact",modelValue:i(f).email,"onUpdate:modelValue":a[0]||(a[0]=e=>i(f).email=e),readonly:i(v),variant:"outlined",rounded:"lg",placeholder:e.$t("User.FormEmail")},{"prepend-inner":n((()=>[d(E,{src:"./images/user/email.svg",width:"27",height:"27","max-width":"27","max-height":"27"})])),_:1},8,["modelValue","readonly","placeholder"]),d(T,{class:"login-input",rules:b,density:"compact",modelValue:i(f).password,"onUpdate:modelValue":a[1]||(a[1]=e=>i(f).password=e),readonly:i(v),variant:"outlined",rounded:"lg",type:"password",placeholder:e.$t("User.FormPwd")},{"prepend-inner":n((()=>[d(E,{src:"./images/user/pwd.svg",width:"27",height:"27","max-width":"27","max-height":"27"})])),_:1},8,["modelValue","readonly","placeholder"]),d(O,{class:"submit-btn mt-7",height:"40",variant:"flat",type:"submit",loading:i(v)},{default:n((()=>[c(u(e.$t("User.Login")),1)])),_:1},8,["loading"]),r("div",ve,[r("a",{href:"#",onClick:s(k,["prevent"])},u(e.$t("User.ResetPwd")),1),a[3]||(a[3]=r("span",{class:"mx-3",style:{color:"#D2D8E6"}},"|",-1)),r("a",{href:"#",onClick:s($,["prevent"])},u(e.$t("User.UserRegister")),1)]),r("div",we,[c(u(e.$t("User.LoginPrivacyTip"))+" ",1),r("a",{href:e.$t("User.UserAggrementUrl"),target:"_blank"},u(e.$t("User.UserAggrement")),9,fe),c(" "+u(e.$t("User.And"))+" ",1),r("a",{href:e.$t("User.PrivacyPolicyUrl"),target:"_blank"},u(e.$t("User.PrivacyPolicy")),9,ye)])])),_:1},8,["modelValue"])],64))}}),Ve={class:"left-side"},Ue={class:"headline"},Ce={class:"login-tip"},be={class:"login-tip-list"},De={class:"login-tip-item"},xe={class:"check-icon"},ke={class:"tip-str"},$e={class:"login-tip-item"},Pe={class:"check-icon"},He={class:"tip-str"},Le={class:"login-tip-item"},Fe={class:"check-icon"},Te={class:"tip-str"};const Me=j({},[["render",function(e,a){return m(),p("div",Ve,[r("div",Ue,u(e.$t("App.AppName")),1),r("div",Ce,u(e.$t("User.LoginTip")),1),r("div",be,[r("div",De,[r("div",xe,[d(z,{color:"#FFF",icon:"mdi-check",size:"12"})]),r("div",ke,u(e.$t("User.LoginTip1")),1)]),r("div",$e,[r("div",Pe,[d(z,{color:"#FFF",icon:"mdi-check",size:"12"})]),r("div",He,u(e.$t("User.LoginTip2")),1)]),r("div",Le,[r("div",Fe,[d(z,{color:"#FFF",icon:"mdi-check",size:"12"})]),r("div",Te,u(e.$t("User.LoginTip3")),1)])])])}],["__scopeId","data-v-0467a237"]]),Oe={class:"d-flex flex-row"},Re={class:"right-side"},Ae={style:{"text-align":"right"}},Ee={key:0,style:{margin:"0 24px"}},ze={key:1,style:{margin:"0 24px"}},Se={key:2,style:{margin:"0 8px"}},Ie=e({__name:"login-and-reg-dialog",setup(e){const s=a(!1),c=C(),u=a("login");l((()=>{f()})),g((()=>c.loginViewVisible),(e=>{e&&h()}));const h=()=>{s.value=!0,f()},w=()=>{s.value=!1},f=()=>{u.value="login"},y=()=>{u.value="reg"},_=()=>{u.value="resetpwd"};return(e,a)=>{const l=Me,c=_e,g=pe,h=ce;return m(),t(R,{modelValue:i(s),"onUpdate:modelValue":a[0]||(a[0]=e=>o(s)?s.value=e:null),"max-width":"700",class:"login-dialog"},{default:n((()=>[d(S,{style:{"border-radius":"19px"},class:"mx-auto px-0 py-0 window-no-drag",width:"100%"},{default:n((()=>[r("div",Oe,["login"===i(u)||"reg"===i(u)?(m(),t(l,{key:0})):v("",!0),r("div",Re,[r("div",Ae,[d(O,{icon:"mdi-close",class:"ms-auto",size:"compact",text:"Ok",elevation:"0",onClick:w})]),"login"===i(u)?(m(),p("div",Ee,[d(c,{onLoginSuccess:w,onToRegisterView:y,onToResetPwdView:_})])):"reg"===i(u)?(m(),p("div",ze,[d(g,{onRegisterSuccess:w,onBack:f})])):"resetpwd"===i(u)?(m(),p("div",Se,[d(h,{onResetPwdSuccess:f,onBack:f})])):v("",!0)])])])),_:1})])),_:1},8,["modelValue"])}}}),Ne={class:"login-action-list"},Be={class:"title"},Ze={class:"title"},je={class:"login-action-list"},Ge={class:"title"},qe={class:"title"},Ye={class:"px-6 pb-6"},Xe=e({__name:"login-action-list",setup(e){const t=C(),s=a("");l((async()=>{const e=await D.getAppInfo();e&&(s.value=e.version)}));const o=()=>{t.showChangePwdView()},g=()=>{t.showChangeNicknameView()},v=async()=>{D.info()},w=async()=>{t.logout()},f=()=>{const e=document.createElement("a");e.href="https://daiyl.com",e.target="_blank",document.body.appendChild(e),e.click(),document.body.removeChild(e)};return(e,a)=>(m(),p(h,null,[r("div",Ne,[r("div",{class:"item",onClick:o},[r("div",Be,u(e.$t("User.ChangePwd")),1),d(z,{size:"16",icon:"mdi-chevron-right"})]),r("div",{class:"item",onClick:g},[r("div",Ze,u(e.$t("User.ChangeName")),1),d(z,{size:"16",icon:"mdi-chevron-right"})])]),r("div",je,[r("div",{class:"item",onClick:f},[r("div",Ge,u(e.$t("Common.officialSite")),1),d(z,{size:"16",icon:"mdi-chevron-right"})]),r("div",{class:"item",onClick:v},[r("div",qe,u(e.$t("Common.version"))+" "+u(i(s)),1),d(z,{size:"16",icon:"mdi-chevron-right"})])]),r("div",Ye,[d(O,{variant:"outlined",onClick:w,style:{"background-color":"#FFF2F2",border:"none"},color:"#F2313F",width:"100%"},{default:n((()=>[c(u(e.$t("User.Logout")),1)])),_:1})])],64))}}),Je={class:"login-action-list"},Ke={class:"title"},Qe={class:"title"},We=e({__name:"not-login-action-list",setup(e){const t=a("");l((async()=>{const e=await D.getAppInfo();e&&(t.value=e.version)}));const s=async()=>{D.info()},o=()=>{const e=document.createElement("a");e.href="https://daiyl.com",e.target="_blank",document.body.appendChild(e),e.click(),document.body.removeChild(e)};return(e,a)=>(m(),p("div",Je,[r("div",{class:"item",onClick:o},[r("div",Ke,u(e.$t("Common.officialSite")),1),d(z,{size:"16",icon:"mdi-chevron-right"})]),r("div",{class:"item",onClick:s},[r("div",Qe,u(e.$t("Common.version"))+" "+u(i(t)),1),d(z,{size:"16",icon:"mdi-chevron-right"})])]))}}),ea={key:0,class:"d-flex flex-row"},aa={style:{flex:"1","font-size":"14px","line-height":"22px","margin-top":"18px"}},la={key:1,class:"d-flex flex-row"},ta={style:{flex:"1","margin-top":"14px",width:"164px"}},sa={style:{"font-size":"16px","font-weight":"bold","text-overflow":"ellipsis","white-space":"nowrap",overflow:"hidden"}},ia={style:{"font-size":"14px","text-overflow":"ellipsis","white-space":"nowrap",overflow:"hidden"}},oa=e({__name:"user-avatar-with-status",setup(e){const a=C(),l=()=>{a.showLoginView()};return(e,t)=>i(a).isUserLoggedIn?(m(),p("div",la,[d(E,{src:"./images/user/avatar-large.svg",transition:!1,"max-width":"68","max-height":"68",width:"68",height:"68",class:"mr-4"}),r("div",ta,[r("div",sa,u(i(a).currentUserData?.name),1),r("div",ia,u(i(a).currentUserData?.email),1)])])):(m(),p("div",ea,[d(E,{src:"./images/user/avatar-not-login-large.svg",transition:!1,"max-width":"68","max-height":"68",width:"68",height:"68",class:"mr-4"}),r("div",aa,[r("div",null,u(e.$t("User.NotLoggin")),1),r("div",null,[c(u(e.$t("User.ClickTo"))+" ",1),r("a",{href:"#",onClick:s(l,["prevent"])},u(e.$t("User.Login"))+"/"+u(e.$t("User.Register")),1)])])]))}}),na=e({__name:"user-avatar-simple",setup(e){const a=C(),l=()=>{};return(e,t)=>i(a).userInfoLoading?v("",!0):(m(),p("a",{key:0,href:"#",class:"d-flex",target:"_blank",onClick:s(l,["prevent"]),style:{"align-items":"center"}},[d(E,{src:i(a).isUserLoggedIn?"./images/user/avatar.svg":"./images/user/avatar-not-login.svg",transition:!1,width:"36",height:"36",class:"github-icon mr-4"},null,8,["src"]),c(" "+u(i(a).isUserLoggedIn?i(a).currentUserData?.name:e.$t("User.NotLoggin")),1)]))}}),ra={key:0,class:"not-login login-overlay mt-2"},da={class:"login-top-part pa-6"},ca={key:1,class:"login-success login-overlay mt-2"},ua={class:"login-top-part pa-6"},ma=e({__name:"user-info-btn",setup(e){const a=C();return l((async()=>{a.updateCurrentUserData()})),(e,l)=>{const t=na,s=oa,o=We,c=Xe,u=Ie,g=ie,v=le;return m(),p(h,null,[d(I,{location:"bottom",transition:"slide-y-transition"},{activator:n((({props:e})=>[d(t,w(f(e)),null,16)])),default:n((()=>[i(a).isUserLoggedIn?(m(),p("div",ca,[r("div",ua,[d(s)]),d(c)])):(m(),p("div",ra,[r("div",da,[d(s)]),d(o)]))])),_:1}),d(u),d(g),d(v)],64)}}});class ga{static async getDefaultHFHomeDir(){return await G()+"/.cache/huggingface"}static async getHFHomeDirDisplay(e){if(e.HF_HOME)return e.HF_HOME;return await this.getDefaultHFHomeDir()}static async saveGlobalEnvVars(e){const a=await this.getDefaultHFHomeDir(),l=Object.assign({},e);return l.HF_HOME===a&&(l.HF_HOME=""),await x(l)}}const pa=Q("configDialog",{state:()=>({showDialog:!1}),actions:{showDialogTrigger(){this.showDialog=!0,setTimeout((()=>{this.showDialog=!1}),100)}}}),ha=e({__name:"global-config-btn",setup(e){const w=pa(),{addToast:f}=U(),{t:_}=L(),V=a(!1),C=a({}),b=a({}),D=a(!1),x=a(!1),S=a(!1),I=a(!0),Z=a("");l((()=>{window.ipcRenderer?.on(q.OPEN_GLOBAL_CONFIG_DIALOG,((e,...a)=>{K()}))}));const j=async()=>{if(x.value&&C){D.value=!0;try{await H(C.value),await ga.saveGlobalEnvVars(b.value);const e=_("Common.saveSuccess");f(e,"success"),G(),S.value&&setTimeout((()=>{J()}),2e3)}catch(e){console.error(e),f(String(e),"error")}finally{D.value=!1}}},G=async()=>{V.value=!1},K=async()=>{if(V.value=!0,await se(),window.ipcRenderer){C.value=await k();const e=await $();e.HF_HOME=await ga.getHFHomeDirDisplay(e),b.value=e}},Q=async()=>{const e=await Y(C.value.LMD_DATA_ROOT,!0);e&&e.path&&(C.value.LMD_DATA_ROOT=e.path,W(e))},W=e=>{const a=X.checkModelsDirValid(e,["logs"]),l=X.checkModelsDirValid(e,["scripts"]);I.value=a||l},ee=async()=>{const e=await P();e?.rootDir?C.value.LMD_DATA_ROOT=e?.rootDir:f(_("ConfigDialog.NoDefraultDirError"),"warning")},ae=[e=>!!e||_("Common.fieldRequired"),()=>I.value||_("ConfigDialog.DirNotValid")],le=async()=>{const e=await Y(b.value.HF_HOME,!1);e&&e.path&&(b.value.HF_HOME=e.path)},te=async()=>{const e=await ga.getDefaultHFHomeDir();e?b.value.HF_HOME=e:f(_("ConfigDialog.NoDefraultDirError"),"warning")},se=async()=>{Z.value=await ga.getDefaultHFHomeDir()};return g((()=>w.showDialog),(e=>{e&&K()})),g((()=>C.value.LMD_DATA_ROOT),((e,a)=>{void 0!==a&&e!==a&&(S.value=!0)})),(e,a)=>(m(),p(h,null,[d(O,{class:"hover-border",width:"38",height:"38",icon:"",onClick:K,style:{"border-radius":"50%"}},{default:n((()=>[d(E,{width:"36",height:"36",src:"./images/icons/icon-config.png",transition:!1})])),_:1}),d(R,{modelValue:i(V),"onUpdate:modelValue":a[7]||(a[7]=e=>o(V)?V.value=e:null),"min-width":"400","max-width":"800"},{default:n((()=>[d(A,{class:"mx-auto px-0 py-0 window-no-drag",width:"100%",title:e.$t("ConfigDialog.globalConfigTitle")},{append:n((()=>[d(O,{icon:"mdi-close",class:"ms-auto",size:"compact",text:"Ok",elevation:"0",onClick:a[0]||(a[0]=e=>V.value=!1)})])),default:n((()=>[i(C)?(m(),t(F,{key:0,class:"pt-0 pb-3 px-6",modelValue:i(x),"onUpdate:modelValue":a[6]||(a[6]=e=>o(x)?x.value=e:null),onSubmit:s(j,["prevent"])},{default:n((()=>[d(N,null,{default:n((()=>[c(u(e.$t("ConfigDialog.DefaultStorageTitle")),1)])),_:1}),d(T,{modelValue:i(C).LMD_DATA_ROOT,"onUpdate:modelValue":a[1]||(a[1]=e=>i(C).LMD_DATA_ROOT=e),readonly:i(D),rules:ae,label:e.$t("ConfigDialog.DefaultStoragePathLabel")},{append:n((()=>[d(B,{location:"bottom"},{activator:n((({props:e})=>[d(z,y(e,{icon:"mdi-information-slab-circle-outline"}),null,16)])),default:n((()=>[r("pre",null,u(e.$t("ConfigDialog.DefaultStorageSubtitle")),1)])),_:1}),d(O,{class:"ml-1",onClick:Q,variant:"outlined"},{default:n((()=>[c(u(e.$t("ConfigDialog.DefaultStoragePathBrowse")),1)])),_:1}),d(O,{class:"ml-1",onClick:ee,variant:"outlined"},{default:n((()=>[c(u(e.$t("ConfigDialog.UseDefaultValue")),1)])),_:1})])),_:1},8,["modelValue","readonly","label"]),d(N,null,{default:n((()=>[c(u(e.$t("ConfigDialog.GlobalVariablesTitle")),1)])),_:1}),d(T,{class:"mb-4",readonly:i(D),rules:[],modelValue:i(b).HF_MIRROR,"onUpdate:modelValue":a[2]||(a[2]=e=>i(b).HF_MIRROR=e),hint:e.$t("ConfigDialog.HF_ENDPOINT_TIP"),"persistent-hint":"",label:e.$t("ConfigDialog.HF_ENDPOINT_LABEL")},null,8,["readonly","modelValue","hint","label"]),d(T,{readonly:i(D),rules:[],modelValue:i(b).HF_HOME,"onUpdate:modelValue":a[3]||(a[3]=e=>i(b).HF_HOME=e),label:e.$t("ConfigDialog.HF_HOME_LABEL")},{append:n((()=>[d(B,{location:"bottom"},{activator:n((({props:e})=>[d(z,y(e,{icon:"mdi-information-slab-circle-outline"}),null,16)])),default:n((()=>[r("pre",null,u(e.$t("ConfigDialog.HF_HOME_TIP")),1)])),_:1}),d(O,{class:"ml-1",onClick:le,variant:"outlined"},{default:n((()=>[c(u(e.$t("ConfigDialog.HFHOMEPathBrowse")),1)])),_:1}),d(O,{class:"ml-1",onClick:te,variant:"outlined"},{default:n((()=>[c(u(e.$t("ConfigDialog.UseDefaultValue")),1)])),_:1})])),_:1},8,["readonly","modelValue","label"]),d(T,{readonly:i(D),rules:[],modelValue:i(b).GITHUB_PROXY,"onUpdate:modelValue":a[4]||(a[4]=e=>i(b).GITHUB_PROXY=e),hint:e.$t("ConfigDialog.GITHUB_PROXY_TIP"),"persistent-hint":"",label:e.$t("ConfigDialog.GITHUB_PROXY_LABEL")},null,8,["readonly","modelValue","hint","label"]),d(M,{class:"text-center justify-center"},{default:n((()=>[d(O,{variant:"outlined",onClick:a[5]||(a[5]=e=>V.value=!1)},{default:n((()=>[c(u(e.$t("ConfigDialog.close")),1)])),_:1}),d(O,{color:"primary",variant:"flat",type:"submit",loading:i(D)},{default:n((()=>[c(u(e.$t("ConfigDialog.saveConfig")),1)])),_:1},8,["loading"])])),_:1})])),_:1},8,["modelValue"])):v("",!0)])),_:1},8,["title"])])),_:1},8,["modelValue"])],64))}}),va={class:"lmd-top-right-controls ga-6 mr-12 window-no-drag"},wa=e({__name:"top-right-controls",setup(e){const{locale:a}=K(),t=W();l((async()=>{let e;try{e=(await k()).LMD_LOCALE}catch(a){e=V.getDefaultLocale()}s(e)}));const s=async e=>{a.value=e;const l=await k();l.LMD_LOCALE=a.value,await H(l),t.changeLocale(a.value)},o=_((()=>V.getLocaleIcon(a.value)));return(e,l)=>{const t=ma;return m(),p("div",va,[d(ha),d(O,{class:"hover-border",style:{"margin-left":"-6px","border-radius":"50%"},width:"38",height:"38",icon:"",onClick:l[0]||(l[0]=e=>{"zhHans"===a.value?s("en"):s("zhHans")})},{default:n((()=>[d(E,{style:{"margin-left":"16px"},width:"56",height:"36",transition:!1,src:i(o)},null,8,["src"])])),_:1}),d(Z,{vertical:"",style:{opacity:"1"},color:"#EBEBF7"}),d(t)])}}});export{wa as _,pa as a,W as u};
