import{D as e,I as t,E as a,L as n,d as l,G as i,x as s,g as o,r,o as c,i as p,b as d,w as u,c as m,e as g,t as v,a as D,u as f,v as y,F as I,H as h,p as k,J as _,K as S,k as A,l as b,A as x}from"./index-DzLgBRVc.js";import{d as w}from"./install-instance-8kHFYglL.js";class M{static openAppRunningWindow(n,l){let i=a.AppRunning.replace(":id",n);i=e(i,{script:l}),window.ipcRenderer?.invoke(t.OPEN_RUNNING_WINDOW,n,i)}}class ${static getLocaleStr(){return{en:"en-US",zhHans:"zh-CN"}[n.getCurrentLocale()]||"en-US"}static format(e){if(void 0===e)return"";let t;return t="string"==typeof e?new Date(e):e,t.toLocaleString("en-US")}}const C=l({__name:"storage-simple-btn",props:{installedInstance:{}},emits:["deleted"],setup(e,{emit:t}){const a=i("showToastMessage"),{t:n}=s(),l=e,k=t,_=o(!1),S=async()=>{try{await w(l.installedInstance.id),a&&a(n("StorageDialog.DeleteFinished"),"success"),k("deleted"),_.value=!1}catch(e){const t=e;let l="Error";l=t.response?.data?.error,a&&l&&a(n(`Api.${l}`),"error")}},A=()=>{l.installedInstance.appInstallPath?h(l.installedInstance.appInstallPath):_.value=!0};return(e,t)=>{const a=r("v-icon"),n=r("v-btn"),i=r("v-card-text"),s=r("v-spacer"),o=r("v-card"),h=r("v-dialog");return c(),p(I,null,[d(n,{variant:"flat",color:"amber-lighten-5",onClick:A},{prepend:u((()=>[l.installedInstance.appInstallPath?(c(),m(a,{key:1,icon:"mdi-folder-outline"})):(c(),m(a,{key:0,color:"error",icon:"mdi-folder-alert-outline"}))])),default:u((()=>[g(" "+v(e.$t("StorageDialog.installDir")),1)])),_:1}),d(h,{modelValue:f(_),"onUpdate:modelValue":t[1]||(t[1]=e=>y(_)?_.value=e:null),"max-width":"400"},{default:u((()=>[d(o,{"prepend-icon":"mdi-folder-alert-outline",title:e.$t("StorageDialog.MissingFiles")},{actions:u((()=>[d(s),d(n,{onClick:t[0]||(t[0]=e=>_.value=!1)},{default:u((()=>[D("p",null,v(e.$t("StorageDialog.Cancel")),1)])),_:1}),d(n,{color:"error",onClick:S},{default:u((()=>[D("p",null,v(e.$t("StorageDialog.Delete")),1)])),_:1})])),default:u((()=>[d(i,null,{default:u((()=>[D("p",null,v(e.$t("StorageDialog.FilesErrorTip")),1),D("p",null,v(e.$t("StorageDialog.FilesDeleteTip")),1)])),_:1})])),_:1},8,["title"])])),_:1},8,["modelValue"])],64)}}}),L=l({__name:"installed-instance-item",props:{appNameVisible:{type:Boolean},iconVisible:{type:Boolean},appIconUrl:{},instanceData:{}},emits:["deleted"],setup(e,{emit:t}){const{t:a}=s(),n=e,l=t,i=k((()=>{const e={};if(!n.instanceData)return null;return"import"===n.instanceData.installMethod?(e.type="icon",e.value="mdi-application-import",e.installMethodStr=a("InstalledApps.Imported")):(e.type="img",e.value="./images/icons/lmd-logo.png",e.installMethodStr=a("InstalledApps.InstalledByLMD")),e})),o=()=>{console.log(' @click="gotoDetailPage"',n.instanceData.appId),b.push({name:x.AppDetail,params:{id:n.instanceData.appId}})},p=()=>{l("deleted")};return(e,t)=>{const a=r("v-img"),n=r("v-icon"),l=r("v-tooltip"),s=r("v-card-title"),D=r("v-card-subtitle"),y=r("v-spacer"),I=r("v-btn"),h=r("v-card");return e.instanceData?(c(),m(h,{key:0,rounded:"lg",class:"common-instance-card rounded-lg mx-auto"},_({title:u((()=>[e.appNameVisible?(c(),m(s,{key:0,onClick:o},{default:u((()=>[g(v(e.instanceData.name),1)])),_:1})):A("",!0),d(D,null,{default:u((()=>[g(v(e.$t("LMAppDetail.version"))+" "+v(e.instanceData.version)+" Â  ",1),d(l,{text:e.$t("LMAppDetail.installedAt"),location:"top"},{activator:u((({props:e})=>[d(n,S({color:"secondary"},e,{icon:"mdi-clock-time-ten-outline"}),null,16)])),_:1},8,["text"]),g(" "+v(f($).format(e.instanceData.createTime)),1)])),_:1})])),actions:u((()=>[d(y),d(C,{onDeleted:p,"installed-instance":e.instanceData},null,8,["installed-instance"]),e.instanceData.appInstallPath?(c(),m(I,{key:0,variant:"flat",color:"light-green-lighten-5","prepend-icon":"mdi-application-brackets-outline",onClick:t[0]||(t[0]=t=>{return a=e.instanceData.id,void M.openAppRunningWindow(a,"start");var a})},{default:u((()=>[g(v(e.$t("LMAppDetail.startApp")),1)])),_:1})):A("",!0)])),_:2},[e.iconVisible&&e.appIconUrl?{name:"prepend",fn:u((()=>[d(a,{width:"68",style:{"border-radius":"8px",cursor:"pointer"},onClick:o,alt:e.instanceData.name,src:e.appIconUrl},null,8,["alt","src"])])),key:"0"}:void 0,f(i)?{name:"append",fn:u((()=>[d(l,{text:f(i).installMethodStr,location:"top"},{activator:u((({props:t})=>["icon"===f(i).type?(c(),m(n,{key:0,size:"30",color:"primary",icon:f(i).value},null,8,["icon"])):(c(),m(a,S({key:1,width:"30"},t,{style:{"border-radius":"8px"},alt:e.instanceData.name,src:f(i)?.value}),null,16,["alt","src"]))])),_:1},8,["text"])])),key:"1"}:void 0]),1024)):A("",!0)}}});export{M as A,L as _};
