import{U as a,W as e,X as t,Y as n,d as l,Z as i,L as s,r as o,o as r,n as p,b as c,w as d,c as u,Q as m,g,t as D,m as f,i as h,M as v,a as y,G as I,z as _,I as k,J as A,F as S,$ as w,E as M,a0 as $,V as b,T as x,a1 as C,f as U,s as L,h as N,v as V,A as R}from"./index-KBtEWh10.js";import{d as P}from"./install-instance-C82mf0G-.js";class F{static openAppRunningWindow(n,l){let i=t.AppRunning.replace(":id",n);i=a(i,{script:l}),window.ipcRenderer?.invoke(e.OPEN_RUNNING_WINDOW,n,i)}}class T{static getLocaleStr(){return{en:"en-US",zhHans:"zh-CN"}[n.getCurrentLocale()]||"en-US"}static format(a){if(void 0===a)return"";let e;return e="string"==typeof a?new Date(a):a,e.toLocaleString("en-US")}}const W=l({__name:"storage-simple-btn",props:{installedInstance:{}},emits:["deleted"],setup(a,{emit:e}){const t=i("showToastMessage"),{t:n}=s(),l=a,M=e,$=o(!1),b=async()=>{try{await P(l.installedInstance.id),t&&t(n("StorageDialog.DeleteFinished"),"success"),M("deleted"),$.value=!1}catch(a){const e=a;let l="Error";l=e.response?.data?.error,t&&l&&t(n(`Api.${l}`),"error")}},x=()=>{l.installedInstance.appInstallPath?w(l.installedInstance.appInstallPath):$.value=!0};return(a,e)=>(r(),p(S,null,[c(f,{variant:"flat",color:"amber-lighten-5",onClick:x},{prepend:d((()=>[l.installedInstance.appInstallPath?(r(),u(m,{key:1,icon:"mdi-folder-outline"})):(r(),u(m,{key:0,color:"error",icon:"mdi-folder-alert-outline"}))])),default:d((()=>[g(" "+D(a.$t("StorageDialog.installDir")),1)])),_:1}),c(A,{modelValue:_($),"onUpdate:modelValue":e[1]||(e[1]=a=>k($)?$.value=a:null),"max-width":"400"},{default:d((()=>[c(h,{"prepend-icon":"mdi-folder-alert-outline",title:a.$t("StorageDialog.MissingFiles")},{actions:d((()=>[c(v),c(f,{onClick:e[0]||(e[0]=a=>$.value=!1)},{default:d((()=>[y("p",null,D(a.$t("StorageDialog.Cancel")),1)])),_:1}),c(f,{color:"error",onClick:b},{default:d((()=>[y("p",null,D(a.$t("StorageDialog.Delete")),1)])),_:1})])),default:d((()=>[c(I,null,{default:d((()=>[y("p",null,D(a.$t("StorageDialog.FilesErrorTip")),1),y("p",null,D(a.$t("StorageDialog.FilesDeleteTip")),1)])),_:1})])),_:1},8,["title"])])),_:1},8,["modelValue"])],64))}}),z=l({__name:"installed-instance-item",props:{appNameVisible:{type:Boolean},iconVisible:{type:Boolean},appIconUrl:{},instanceData:{}},emits:["deleted"],setup(a,{emit:e}){const{t:t}=s(),n=a,l=e,i=M((()=>{const a={};if(!n.instanceData)return null;return"import"===n.instanceData.installMethod?(a.type="icon",a.value="mdi-application-import",a.installMethodStr=t("InstalledApps.Imported")):(a.type="img",a.value="./images/icons/lmd-logo.png",a.installMethodStr=t("InstalledApps.InstalledByLMD")),a})),o=()=>{console.log("gotoDetailPage",n.instanceData.appId);V.currentRoute.value.name!==R.AppDetail&&V.push({name:R.AppDetail,params:{id:n.instanceData.appId}})},p=()=>{l("deleted")};return(a,e)=>a.instanceData?(r(),u(h,{key:0,rounded:"lg",class:"common-instance-card rounded-lg mx-auto"},$({title:d((()=>[a.appNameVisible?(r(),u(U,{key:0,onClick:o},{default:d((()=>[g(D(a.instanceData.name),1)])),_:1})):L("",!0),c(N,null,{default:d((()=>[g(D(a.$t("LMAppDetail.version"))+" "+D(a.instanceData.version)+" Â  ",1),c(x,{text:a.$t("LMAppDetail.installedAt"),location:"top"},{activator:d((({props:a})=>[c(m,C({color:"secondary"},a,{icon:"mdi-clock-time-ten-outline"}),null,16)])),_:1},8,["text"]),g(" "+D(_(T).format(a.instanceData.createTime)),1)])),_:1})])),actions:d((()=>[c(v),c(W,{onDeleted:p,"installed-instance":a.instanceData},null,8,["installed-instance"]),a.instanceData.appInstallPath?(r(),u(f,{key:0,variant:"flat",color:"light-green-lighten-5","prepend-icon":"mdi-application-brackets-outline",onClick:e[0]||(e[0]=e=>{return t=a.instanceData.id,void F.openAppRunningWindow(t,"start");var t})},{default:d((()=>[g(D(a.$t("LMAppDetail.RunApp")),1)])),_:1})):L("",!0)])),_:2},[a.iconVisible&&a.appIconUrl?{name:"prepend",fn:d((()=>[c(b,{width:"68",height:"68",cover:"",style:{"border-radius":"8px",cursor:"pointer"},onClick:o,alt:a.instanceData.name,src:a.appIconUrl},null,8,["alt","src"])])),key:"0"}:void 0,_(i)?{name:"append",fn:d((()=>[c(x,{text:_(i).installMethodStr,location:"top"},{activator:d((({props:e})=>["icon"===_(i).type?(r(),u(m,{key:0,size:"30",color:"primary",icon:_(i).value},null,8,["icon"])):(r(),u(b,C({key:1,width:"30"},e,{style:{"border-radius":"8px"},alt:a.instanceData.name,src:_(i)?.value}),null,16,["alt","src"]))])),_:1},8,["text"])])),key:"1"}:void 0]),1024)):L("",!0)}});export{F as A,z as _};
